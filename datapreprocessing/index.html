<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Data Wrangling (Data Preprocessing) - Boyang Yan's Tech Blog</title><meta name=description content="This is Boyang Yan's Tech Blog"><meta property="og:title" content="Data Wrangling (Data Preprocessing)">
<meta property="og:description" content="Module 1 - Data Preprocessing: From Raw Data to Ready to Analyse Summary Module 1 will set the background for the entire course. Data preprocessing will be defined and the importance of data preprocessing inside the data analysis workflow will be explored. The module will define 5 major tasks for data preprocessing and will provide a quick overview of these tasks. Then, in the following modules of this course, we will unwrap each data preprocessing task by providing details of operations related to that task.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://yanboyang.com/datapreprocessing/"><meta property="og:image" content="https://yanboyang.com/logo.png"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-03-05T06:11:32+10:00">
<meta property="article:modified_time" content="2022-01-15T10:52:36+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://yanboyang.com/logo.png">
<meta name=twitter:title content="Data Wrangling (Data Preprocessing)">
<meta name=twitter:description content="Module 1 - Data Preprocessing: From Raw Data to Ready to Analyse Summary Module 1 will set the background for the entire course. Data preprocessing will be defined and the importance of data preprocessing inside the data analysis workflow will be explored. The module will define 5 major tasks for data preprocessing and will provide a quick overview of these tasks. Then, in the following modules of this course, we will unwrap each data preprocessing task by providing details of operations related to that task.">
<meta name=application-name content="LoveIt">
<meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://yanboyang.com/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=https://yanboyang.com/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://yanboyang.com/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://yanboyang.com/apple-touch-icon.png><link rel=mask-icon href=https://yanboyang.com/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://yanboyang.com/site.webmanifest><link rel=canonical href=https://yanboyang.com/datapreprocessing/><link rel=prev href=https://yanboyang.com/rlanguage/><link rel=next href=https://yanboyang.com/writingmathematicfomular/><link rel=stylesheet href=https://yanboyang.com/lib/normalize/normalize.min.css><link rel=stylesheet href=https://yanboyang.com/css/style.min.css><link rel=stylesheet href=https://yanboyang.com/lib/fontawesome-free/all.min.css><link rel=stylesheet href=https://yanboyang.com/lib/animate/animate.min.css><meta name=baidu-site-verification content="wsCeKMuJ31RLblHf"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Data Wrangling (Data Preprocessing)","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yanboyang.com\/datapreprocessing\/"},"genre":"posts","wordcount":35946,"url":"https:\/\/yanboyang.com\/datapreprocessing\/","datePublished":"2021-03-05T06:11:32+10:00","dateModified":"2022-01-15T10:52:36+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Boyang Yan"},"description":""}</script></head>
<body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-101949995-1','auto'),ga('send','pageview'))</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-101949995-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<div class=header-wrapper>
<div class=header-title>
<a href=https://yanboyang.com/ title="Boyang Yan's Tech Blog"></a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=https://yanboyang.com/> Home </a><a class=menu-item href=https://yanboyang.com/posts/> Posts </a><a class=menu-item href=https://yanboyang.com/tags/> Tags </a><a class=menu-item href=https://yanboyang.com/categories/> Categories </a><a class=menu-item href=https://yanboyang.com/about/> About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-101949995-1','auto'),ga('send','pageview'))</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-101949995-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=https://yanboyang.com/ title="Boyang Yan's Tech Blog"></a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=https://yanboyang.com/ title>Home</a><a class=menu-item href=https://yanboyang.com/posts/ title>Posts</a><a class=menu-item href=https://yanboyang.com/tags/ title>Tags</a><a class=menu-item href=https://yanboyang.com/categories/ title>Categories</a><a class=menu-item href=https://yanboyang.com/about/ title>About Me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Data Wrangling (Data Preprocessing)</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=https://yanboyang.com/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Boyang Yan</a></span>&nbsp;<span class=post-category>included in <a href=https://yanboyang.com/categories/math2349/><i class="far fa-folder fa-fw"></i>MATH2349</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-03-05>2021-03-05</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;35946 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;169 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept=true>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#module-1---data-preprocessing-from-raw-data-to-ready-to-analyse>Module 1 - Data Preprocessing: From Raw Data to Ready to Analyse</a>
<ul>
<li><a href=#summary>Summary</a></li>
<li><a href=#learning-objectives>Learning Objectives</a></li>
<li><a href=#data>Data</a></li>
<li><a href=#the-rise-of-the-data-analyst>The rise of the Data Analyst</a></li>
<li><a href=#data-analysis-steps>Data Analysis Steps</a></li>
<li><a href=#what-is-data-preprocessing>What is Data Preprocessing?</a></li>
<li><a href=#why-data-preprocessing-is-important>Why Data Preprocessing is important</a></li>
<li><a href=#why-do-you-learn-data-preprocessing>Why do you learn Data Preprocessing?</a></li>
<li><a href=#major-tasks-in-data-preprocessing>Major Tasks in Data Preprocessing</a>
<ul>
<li><a href=#tidy-data>Tidy Data</a>
<ul>
<li><a href=#each-variable-forms-a-column>Each variable forms a column</a></li>
<li><a href=#each-observation-forms-a-row>Each observation forms a row</a></li>
<li><a href=#each-type-of-observational-unit-forms-a-table>Each type of observational unit forms a table</a></li>
</ul>
</li>
<li><a href=#messy-data>Messy data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#module-2---get-importing-scraping-and-exporting-data-with-r>Module 2 - Get: importing, Scraping and Exporting Data with R</a>
<ul>
<li><a href=#summary-1>Summary</a></li>
<li><a href=#learning-objectives-1>Learning objectives</a></li>
<li><a href=#purpose>Purpose</a></li>
<li><a href=#readingimporting-data>Reading/Importing Data</a>
<ul>
<li><a href=#reading-data-from-text-files>Reading Data from Text Files</a>
<ul>
<li><a href=#base-r-functions>Base R functions</a></li>
<li><a href=#readr-package-functions>readr package functions</a></li>
</ul>
</li>
<li><a href=#reading-data-from-excel-files>Reading Data from Excel files</a>
<ul>
<li><a href=#the-xlsx-package>The xlsx Package</a></li>
<li><a href=#the-openxlsx-package>The openxlsx Package</a></li>
<li><a href=#the-readxl-package>The readxl Package</a></li>
</ul>
</li>
<li><a href=#importing-data-from-statistical-software>Importing Data from statistical software</a></li>
<li><a href=#reading-from-databases>Reading from Databases</a></li>
<li><a href=#scraping-data-from-web>Scraping Data from Web</a>
<ul>
<li><a href=#importing-tabular-and-excel-files-stored-online>Importing Tabular and Excel files Stored Online</a></li>
<li><a href=#scraping-html-table-data>Scraping HTML Table Data</a></li>
</ul>
</li>
<li><a href=#exporting-data>Exporting Data</a>
<ul>
<li><a href=#exporting-data-to-text-files>Exporting Data to text files</a>
<ul>
<li><a href=#base-r-functions-1>Base R functions</a></li>
<li><a href=#the-readr-package>The readr Package</a></li>
</ul>
</li>
<li><a href=#exporting-data-to-excel-files>Exporting Data to Excel files</a></li>
</ul>
</li>
<li><a href=#saving-data-as-an-r-object-file>Saving Data as an R object File</a></li>
</ul>
</li>
<li><a href=#additional-resources-and-further-reading>Additional Resources and Further Reading</a></li>
<li><a href=#references>References</a></li>
</ul>
</li>
<li><a href=#model-3---understand-understanding-data-and-data-structures>Model 3 - Understand: Understanding Data and Data Structures</a>
<ul>
<li><a href=#summary-2>Summary</a></li>
<li><a href=#learning-objectives-2>Learning objectives</a></li>
<li><a href=#purpose-1>Purpose</a></li>
<li><a href=#types-of-variables>Types of variables</a></li>
<li><a href=#data-structures-in-r>Data Structures in R</a></li>
<li><a href=#vectors>Vectors</a></li>
<li><a href=#lists>Lists</a></li>
<li><a href=#check-the-structure-of-the-list1-object>check the structure of the list1 object</a></li>
<li><a href=#matrices>Matrices</a></li>
<li><a href=#data-frames>Data Frames</a></li>
<li><a href=#converting-data-typesstructures>Converting Data Types/Structures</a></li>
<li><a href=#long-vs-wide-format-data>Long vs. wide format data</a></li>
<li><a href=#additional-resources-and-further-reading-1>Additional Resources and Further Reading</a></li>
<li><a href=#references-1>References</a></li>
</ul>
</li>
<li><a href=#module-4---tidy-and-manipulate-tidy-data-principles-and-manipulating-data>Module 4 - Tidy and Manipulate: Tidy Data Principles and Manipulating Data</a>
<ul>
<li><a href=#overview>Overview</a>
<ul>
<li><a href=#summary-3>Summary</a></li>
<li><a href=#learning-objectives-3>learning objectives</a></li>
</ul>
</li>
<li><a href=#tidy-data-principles>Tidy Data Principles</a></li>
<li><a href=#common-problems-with-messy-data-sets>Common problems with messy data sets</a></li>
<li><a href=#the-tidyr-package>The tidyr package</a>
<ul>
<li><a href=#pivot_longer-function>pivot_longer() function</a></li>
<li><a href=#pivot_wider-function>pivot_wider() function</a></li>
<li><a href=#separate-function>separate() function</a></li>
<li><a href=#unite-function>unite() function</a></li>
</ul>
</li>
<li><a href=#the-dplyr-package>The dplyr package</a>
<ul>
<li><a href=#select-function>select() function</a></li>
<li><a href=#filter-function>filter() function</a></li>
<li><a href=#arrange-function>arrange() function</a></li>
<li><a href=#mutate-function>mutate() function</a></li>
<li><a href=#summarise-or-summarize--function>summarise() (or summarize() ) function</a></li>
<li><a href=#group_by--summarise-function>group_by() + summarise() function</a></li>
<li><a href=#joining-data-sets>Joining data sets</a>
<ul>
<li><a href=#mutating-joins>Mutating joins</a></li>
<li><a href=#controlling-how-the-data-sets-are-matched>Controlling how the data sets are matched</a></li>
<li><a href=#filtering-joins>Filtering Joins</a></li>
<li><a href=#when-to-use-mutating-or-filtering-joins>When to use mutating or filtering joins</a></li>
<li><a href=#set-operations>Set operations</a></li>
<li><a href=#merging-data-sets>Merging data sets</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#additional-resources-and-further-reading-2>Additional Resources and Further Reading</a></li>
<li><a href=#references-2>References</a></li>
</ul>
</li>
<li><a href=#module-5---scan-missing-values>Module 5 - Scan: Missing Values</a>
<ul>
<li><a href=#introduction>Introduction</a></li>
<li><a href=#learning-objectives-4>learning objectives</a></li>
<li><a href=#missing-data>Missing Data</a></li>
<li><a href=#identifying-missing-data>Identifying Missing Data</a></li>
<li><a href=#recode-missing-data>Recode Missing Data</a></li>
<li><a href=#excluding-missing-data>Excluding Missing Data</a></li>
<li><a href=#basic-missing-value-imputation-techniques>Basic Missing Value Imputation Techniques</a>
<ul>
<li><a href=#replace-the-missing-values-with-some-constant-specified-by-the-analyst>Replace the missing value(s) with some constant, specified by the analyst</a></li>
<li><a href=#replace-the-missing-values-with-the-mean-median-or-mode>Replace the missing value(s) with the mean, median or mode</a></li>
<li><a href=#more-complex-approaches-to-missing-value-imputation>More Complex Approaches to Missing Value Imputation</a></li>
</ul>
</li>
<li><a href=#special-values>Special values</a></li>
<li><a href=#identifying-special-values>Identifying Special Values</a>
<ul>
<li><a href=#remark-useful-apply-family-functions>Remark: Useful apply family functions</a></li>
</ul>
</li>
<li><a href=#optional-reading-checking-for-obvious-inconsistencies-or-errors>Optional Reading: Checking for Obvious Inconsistencies or Errors</a></li>
<li><a href=#optional-reading-correction-of-obvious-inconsistencies-or-errors>Optional Reading: Correction of Obvious Inconsistencies or Errors</a></li>
<li><a href=#additional-resources-and-further-reading-3>Additional Resources and Further Reading</a></li>
<li><a href=#references-3>References</a></li>
</ul>
</li>
<li><a href=#module-6---scan-outliers>Module 6 - Scan: Outliers</a>
<ul>
<li><a href=#overview-1>Overview</a>
<ul>
<li><a href=#summary-4>Summary</a></li>
<li><a href=#learning-objectives-5>Learning Objectives</a></li>
</ul>
</li>
<li><a href=#outliers>Outliers</a>
<ul>
<li><a href=#types-of-outliers>Types of Outliers</a></li>
<li><a href=#most-common-causes-of-outliers>Most Common Causes of Outliers</a></li>
</ul>
</li>
<li><a href=#detecting-outliers>Detecting Outliers</a>
<ul>
<li><a href=#univariate-outlier-detection-methods>Univariate Outlier Detection Methods</a></li>
<li><a href=#multivariate-outlier-detection-methods>Multivariate Outlier Detection Methods</a></li>
</ul>
</li>
<li><a href=#approaches-to-handling-outliers>Approaches to Handling Outliers</a>
<ul>
<li><a href=#excluding-or-deleting-outliers>Excluding or Deleting Outliers</a></li>
</ul>
</li>
<li><a href=#imputing>Imputing</a></li>
<li><a href=#capping-aka-winsorising>Capping (a.k.a Winsorising)</a>
<ul>
<li><a href=#transforming-and-binning-values>Transforming and binning values</a></li>
<li><a href=#outliers-can-also-be-valuable>Outliers can also be valuable!</a></li>
</ul>
</li>
<li><a href=#additional-resources-and-further-reading-4>Additional Resources and Further Reading</a></li>
</ul>
</li>
<li><a href=#cheatsheet>Cheatsheet</a>
<ul>
<li><a href=#modele-2>Modele 2</a>
<ul>
<li><a href=#readingimporting-data-1>Reading/Importing Data</a>
<ul>
<li><a href=#from-csv-files>from CSV files</a>
<ul>
<li><a href=#base-r>Base R</a></li>
</ul>
</li>
<li><a href=#from-excel-files>from Excel files</a></li>
<li><a href=#from-statistical-software>from statistical software</a></li>
<li><a href=#scraping-html-table-data-1>Scraping HTML Table Data</a></li>
</ul>
</li>
<li><a href=#write-data>Write data</a>
<ul>
<li><a href=#to-text-files>to text files</a></li>
<li><a href=#to-excel-files>to Excel files</a></li>
</ul>
</li>
<li><a href=#r-object-file>R object File</a></li>
</ul>
</li>
<li><a href=#module-3>Module 3</a>
<ul>
<li><a href=#data-types-and-levels>Data Types and levels</a></li>
<li><a href=#factor>Factor</a></li>
<li><a href=#vectors-1>Vectors</a></li>
<li><a href=#lists-allows-combination-of-different-data-types-and-lengths>Lists allows combination of different data types and lengths</a></li>
<li><a href=#matrices-1>Matrices</a></li>
<li><a href=#data-frames-1>Data Frames</a></li>
<li><a href=#convert-data-types-structures>Convert Data Types/ Structures</a></li>
</ul>
</li>
<li><a href=#module-4>Module 4</a>
<ul>
<li><a href=#tidy-data-principles-1>Tidy Data Principles</a></li>
<li><a href=#common-problems-with-messy-data-sets-1>Common problems with messy data sets</a></li>
<li><a href=#dplyr-package>dplyr package</a>
<ul>
<li><a href=#example>Example</a></li>
</ul>
</li>
<li><a href=#mutating-joins-1>Mutating joins</a>
<ul>
<li><a href=#example-1>Example</a></li>
</ul>
</li>
<li><a href=#filtering-joins-1>Filtering Joins</a>
<ul>
<li><a href=#example-2>Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#module-5>Module 5</a>
<ul>
<li><a href=#missing-data-1>Missing Data</a></li>
<li><a href=#identifying-missing-data-1>Identifying Missing Data</a></li>
<li><a href=#recode-missing-data-1>Recode Missing Data</a></li>
<li><a href=#basic-missing-value-imputation-techniques-1>Basic Missing Value Imputation Techniques</a></li>
<li><a href=#id-special-values>ID Special Values</a></li>
<li><a href=#apply-functions---df-list-and-matrices-also-vectors>apply() Functions - df list and matrices also vectors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><h2 id=module-1---data-preprocessing-from-raw-data-to-ready-to-analyse>Module 1 - Data Preprocessing: From Raw Data to Ready to Analyse</h2>
<h3 id=summary>Summary</h3>
<p>Module 1 will set the background for the entire course. Data preprocessing will be defined and the importance of data preprocessing inside the data analysis workflow will be explored. The module will define 5 major tasks for data preprocessing and will provide a quick overview of these tasks. Then, in the following modules of this course, we will unwrap each data preprocessing task by providing details of operations related to that task.</p>
<h3 id=learning-objectives>Learning Objectives</h3>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Define data preprocessing.</li>
<li>Identify steps for data analysis, understand the place of data preprocessing inside the data analysis workflow.</li>
<li>Understand the reasons why data preprocessing is important.</li>
<li>Identify major tasks in data preprocessing.</li>
<li>Understand main benefits of using R statistical programming language in data preprocessing.</li>
</ul>
<h3 id=data>Data</h3>
<p>“Data! Data! Data! I can’t make bricks without clay!” - Sir Arthur Conan Doyle.</p>
<p>Data. Our world has turned out to be increasingly dependent upon this resource. Sir Conan Doyle’s famous detective, Sherlock Holmes, wouldn’t shape any theories or draw any conclusions unless he had adequate data. Data is the fundamental building piece of all that we do in analytics such as the analyses we perform, the reports we build, and the decisions we made.</p>
<p><strong>“In God we trust. All others must bring data.”</strong> – W. Edwards Deming.</p>
<p>This quote by [W. Edwards Deming] (<a href=https://en.wikipedia.org/wiki/W._Edwards_Deming target=_blank rel="noopener noreferrer">https://en.wikipedia.org/wiki/W._Edwards_Deming</a>) (statistician, professor, author, lecturer, and consultant), emphasizes the significance of data-driven decisions. Obviously, everyone has better bring (also understand and interpret) data to back up their claims.</p>
<h3 id=the-rise-of-the-data-analyst>The rise of the Data Analyst</h3>
<p>Today’s organizations have access to more data than ever before, but more data isn’t better data unless you know what to do with it. Organizations are struggling to find people who can turn their data into insights and value, which in turn has created a high demand across the world for data analysts. During an interview in 2009, Google’s Chief Economist Dr. Hal R. Varian stated, “The ability to take data - to be able to understand it, to process it, to extract value from it, to visualize it, to communicate it - that’s going to be a hugely important skill in the next decades.” <a href="https://www.forbes.com/sites/brentdykes/2016/03/31/data-storytelling-the-essential-data-science-skill-everyone-needs/?sh=626e8a3352ad" target=_blank rel="noopener noreferrer">Read the full article here</a></p>
<h3 id=data-analysis-steps>Data Analysis Steps</h3>
<p>The statistical approach to data analysis is much broader than just analysing data. Data analysis process starts with defining problem statement, continues with planning and collecting data, preprocessing data, exploring data using descriptive statistics and data visualizations, analysing/modelling data, and finalizes with interpreting and reporting findings. This process is depicted in the following illustration.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615142917/MATH2349/DataAnalysisSteps_yihxuj.png></p>
<ul>
<li>
<p><strong>Defining Problem Statement</strong>: This is the first step of data analysis. In this step, the problem statement is identified by the organizations/researchers. The data analyst should thoroughly understand the problem and the domain of the problem.</p>
</li>
<li>
<p><strong>Planning and Collecting Data</strong>: In this step, the appropriate tools for data collection related to the problem statement will be identified. This step may include designing a survey for data collection, scraping data from web or accessing an Excel/a database file.</p>
</li>
<li>
<p><strong>Data Preprocessing</strong>: The objective of this step is to make the data ready for the further statistical analysis. This step is one of the important phases in data analysis. The accuracy of the statistical analysis depends on the quality of the data gained in this step. Several operations such as importing data, reshaping data from long to wide format, filtering data, cleaning data, identifying outliers, and transforming variables can be applied to the data to make ready for the statistical analysis.</p>
</li>
<li>
<p><strong>Exploring Data via Descriptive Statistics/Visualizations</strong>: The objective of this step is to understand the main characteristics of the data. Exploratory analyses are generally done using descriptive statistics (i.e. mean, median, standard deviation, frequencies, percentages etc.) and visualization tools (i.e. scatter plots, box plots, histograms, interactive data visualizations etc.). Exploratory analysis will show you the things that you didn’t expect or raise new questions about the data.</p>
</li>
<li>
<p><strong>Analysing/Modelling Data</strong>: The statistical analysis/modelling step can include a broad range of techniques like statistical hypothesis testing, statistical modelling, and machine learning algorithms. Generally, the type of the variables in the data set and the purpose of the investigation will determine the appropriate analysis technique.</p>
</li>
<li>
<p><strong>Interpretation and Reporting</strong>: The last step of the data analysis is the reporting and the interpretation of the results. This step is also critical as if you cannot understand and communicate your results to others, it doesn’t matter how well you conducted your analysis.</p>
</li>
</ul>
<h3 id=what-is-data-preprocessing>What is Data Preprocessing?</h3>
<p>Most statistical theory concentrates on data modelling, prediction, and statistical inference while it is usually assumed that data are in the correct state for the data analysis. However, in practice, a data analyst spends most of his/her time (usually 50%-80% of an analyst time) on making ready the data before doing any statistical operation (Dasu and Johnson (2003)). Despite the amount of time it takes, there has been surprisingly very little emphasis on how to preprocess data well (Wickham and others (2014)). Real-world data are commonly incomplete, noisy, inconsistent, and don’t have all the correct labels and codes that are required for the analysis. Data Preprocessing, which is also commonly referred to as data wrangling, data manipulation, data cleaning, etc., is a process and the collection of operations needed to prepare all forms of untidy data (incomplete, noisy and inconsistent data) for statistical analysis.</p>
<h3 id=why-data-preprocessing-is-important>Why Data Preprocessing is important</h3>
<p>Data preprocessing may significantly influence the statistical conclusions based on the data. “Garbage in, garbage out (GIGO)” is a famous saying that is used to emphasis “the quality of the statistical analyses (output) always depends on the quality of the data (input)”. By preprocessing data, we can minimise the garbage that gets into our analysis so that we can minimise the amount of garbage that our analyses/models result.</p>
<h3 id=why-do-you-learn-data-preprocessing>Why do you learn Data Preprocessing?</h3>
<p>The road to becoming an expert in data analysis can be challenging and in fact, obtaining expertise in the broad range of data analysis is a career-long process. In this course, you will take a step closer to fluency in the early stages; namely in the data preprocessing step, as you need to be able to import, manage, manipulate and transform your data before performing any kind of data analysis.</p>
<h3 id=major-tasks-in-data-preprocessing>Major Tasks in Data Preprocessing</h3>
<p>We will define 5 major tasks for data preprocessing framework, namely: <strong>Get</strong>, <strong>Understand</strong>, <strong>Tidy</strong> & <strong>Manipulate</strong>, <strong>Scan</strong> and <strong>Transform</strong>.</p>
<p>A typical data preprocessing process usually (but not necessarily) follows the following order of tasks given below:</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615144175/MATH2349/DataPreprocessing_whuabu.png></p>
<ol>
<li>
<p><strong>Get</strong>: A data set can be stored in a computer or can be online in different file formats. We need to get the data set into R by importing it from other data sources (i.e., .txt, .xls, .csv files and databases) or scraping from web. R provides many useful commands to import (and export) data sets in different file formats.</p>
</li>
<li>
<p><strong>Understand</strong>: We cannot perform any type of data preprocessing without understanding what we have in hand. In this step, we will check the data volume (i.e., the dimensions of the data) and structure, understand the variables/attributes in the data set, and understand the meaning of each level/value for the variables.</p>
</li>
<li>
<p><strong>Tidy & Manipulate</strong>: In this step, we will apply several important tasks to tidy up messy data sets. We will follow Hadley Wickham’s “Tidy Data” principles:</p>
</li>
</ol>
<ul>
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ul>
<p>We may also need to manipulate, i.e. filter, arrange, select, subset/split data, or generate new variables from the data set.</p>
<ol start=4>
<li>
<p><strong>Scan</strong>: This step will include checking for plausibility of values, cleaning data for obvious errors, identifying and handling outliers, and dealing with missing values.</p>
</li>
<li>
<p><strong>Transform</strong>: Some statistical analysis methods are sensitive to the scale of the variables and it may be necessary to apply transformations before using them. In this step we will introduce well-known data transformations, data scaling, centering, standardising and normalising methods.</p>
</li>
</ol>
<p>There are also other steps related with preprocessing special types of data including dates, time and characters/strings. The last module of this course will introduce the special operations used for date, time and text preprocessing.</p>
<h4 id=tidy-data>Tidy Data</h4>
<p>Datasets can be created from a diverse ranges of sources including manually created spreadsheets, datasets scraped from the internet, previously collected or historical data, or complex databases and data warehouses. The Bicycle dataset above is an example of a previously collected dataset downloaded from an Open Access data repository. Regardless of a dataset’s origin, all must abide by the Tidy Data rules (Wickham 2014). As Wickham explains, tidy data allows easy manipulation, analysis and visualisation for data analysis purposes.</p>
<p>The basic structure of a dataset includes rows and columns. The three tidy dataset rules are as follows:</p>
<ol>
<li>Each variable forms a column</li>
<li>Each observation forms a row</li>
<li>Each type of observational unit forms a table</li>
</ol>
<p>We will use a sample dataset, expain this three rules at the below. The sample dataset you can download from <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/Bicycle.csv target=_blank rel="noopener noreferrer">here</a></p>
<h5 id=each-variable-forms-a-column>Each variable forms a column</h5>
<p>The <strong>Bicycle</strong> data contains 23 columns. With the exception of <strong>Unique_ID</strong>, the other columns refer to variables. For example, the <strong>NB_YEAR</strong> column is a time variable that tells us the year an observation was recorded. If we select only the <strong>CT_VOLUME</strong>&mldr; variables, we can how the Bicycle dataset abides by Rule #1.</p>
<h5 id=each-observation-forms-a-row>Each observation forms a row</h5>
<p>The first row of the dataset, or the header row, includes the name of each column/variable. These names cannot contain as special characters or spaces, and their length should be as short as possible. This will reduce the amount of typing when you code!</p>
<p>An observation refers to the <strong>units of sampling</strong>. For example, this might be a person, a date, or a machine that comprise a “population”. The sampling unit for the bicyle data refers to daily bike traffic volume at different locations. Location is one unit of sampling, day is the second unit of sampling. This is an example of a nested dataset, where daily traffic volumes can be nested within different locations.</p>
<p>As you can see, the 55,967th observation relates to data recorded from Scotchman’s Creek Trail on the 27/12/2009. This confirms that each row with the dataset refers to an observation.</p>
<h5 id=each-type-of-observational-unit-forms-a-table>Each type of observational unit forms a table</h5>
<p>There are two observational units in this dataset - survey location and day. You can see this in the repetition of the survey location identifiers. However, this dataset is still tidy because the table contains only information relating to daily bicycle traffic volume.</p>
<p>Had the dataset also contained details of a survey location’s variables repeated each time to the daily observations, the dataset would have violated rule 3.</p>
<p>Rule three is any interesting one, because in statistics it is often violated because many standard statistical functions require it to be broken. The two main issues related to violating rule three is increased file size (not good for computation) and increased risk of inconsistencies creeping into the dataset.</p>
<h4 id=messy-data>Messy data</h4>
<p>Any datasets that do not abide by these rules is defined as messy. Wickham lists five common reasons:</p>
<ul>
<li>Column headers are values, not variable names.</li>
<li>Multiple variables are stored in one column.</li>
<li>Variables are stored in both rows and columns.</li>
<li>Multiple types of observational units are stored in the same table.</li>
<li>A single observational unit is stored in multiple tables.
You can read all about them <a href=http://vita.had.co.nz/papers/tidy-data.pdf target=_blank rel="noopener noreferrer">here</a>.</li>
</ul>
<h2 id=module-2---get-importing-scraping-and-exporting-data-with-r>Module 2 - Get: importing, Scraping and Exporting Data with R</h2>
<h3 id=summary-1>Summary</h3>
<p>All statistical work begins with data, and most data are stuck inside files and databases. Data are arriving from multiple sources at an alarming rate and analysts and organizations are seeking ways to leverage these new sources of information. Consequently, analysts need to understand how to get data from these sources.</p>
<p>Module 2 will cover the process of importing data, scraping data from the web, and exporting data. First we will cover the basics of importing tabular and spreadsheet data (i.e., .txt, .xls, .csv files). Then, we will cover how to acquire data sets from other statistical software (i.e., Stata, SPSS, or SAS) and databases. As the modern data analysis techniques often include scraping data files stored online, we will also cover the fundamentals of web scraping using R. Lastly, the equally important process of getting data out of R, in other words, exporting data will be covered.</p>
<h3 id=learning-objectives-1>Learning objectives</h3>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Understand how to get data from tabular and spreadsheet files.</li>
<li>Understand how to get data from statistical software and databases.</li>
<li>Learn how to scrape data files stored online.</li>
<li>Learn how to export to tabular and spreadsheet files.</li>
<li>Learn how to save R objects.</li>
</ul>
<h3 id=purpose>Purpose</h3>
<p>By completing the essential module reading, skill builders, and reviewing the recorded lecture, you will be able to work on worksheet questions and your assessments.</p>
<h3 id=readingimporting-data>Reading/Importing Data</h3>
<p>The first step in any data preprocessing task is to “GET” the data. Data can come from many resources but two of the most common formats of the data sources include text and Excel files. In addition to text and Excel files, there are other ways that data can be stored and exchanged. Commercial statistical software such as SPSS, SAS, Stata, and Minitab often have the option to store data in a specific format for that software. In addition, analysts commonly use databases to store large quantities of data. R has good support to work with these additional options. In this section, we will cover how to import data into R by reading data from text files, Excel spreadsheets, commercial statistical software data files and databases. Moreover, we will cover how to load data from saved R object files for holding or transferring data that has been processed in R. In addition to the commonly used base R functions to perform data importing, we will also cover functions from the popular readr, readxl and foreign packages.</p>
<h4 id=reading-data-from-text-files>Reading Data from Text Files</h4>
<p>Text files are a popular way to hold and exchange tabular data as almost any data application supports exporting data to the CSV (or other text file) formats. Text file formats use delimiters to separate the different elements in a line, and each line of data is in its own line in the text file. Therefore, importing different kinds of text files can follow a consistent process once you have identified the delimiter.</p>
<p>There are two main groups of functions that we can use to read in text files:</p>
<ul>
<li>
<p><strong>Base R functions</strong>: The Base R functions are the built-in functions that are already available when you download R and RStudio. Therefore, in order to use Base R functions, you do not need to install or load any packages before using them.</p>
</li>
<li>
<p><strong>readr package functions</strong>: Compared to the equivalent base functions, readr functions are around 10× faster. In order to use readr package functions, you need to install and load the readr package using the following commands:</p>
</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;readr&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>readr</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=base-r-functions>Base R functions</h5>
<p>read.table() is a multi-purpose function in base R for importing data. The functions read.csv() and read.delim() are special cases of read.table() in which the defaults have been adjusted for efficiency. To illustrate these functions let’s work with a CSV (.csv comma separated values) file called iris.csv which you can download from <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/iris.csv target=_blank rel="noopener noreferrer">here</a>. Before running any command note that we need to save this data set into our working directory, or we need to explicitly define the location of this data set.
In the first example, let’s assume that we have already downloaded iris.csv data and saved it in our working directory. Then, the following command will read iris.csv data and store it in the iris1 object in R as a data frame:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## The following command assumes that the iris.csv file is in the working directory</span>

<span class=n>iris1</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that the iris1 object has appeared in your Environment pane (probably located on the top-right of your RStudio window). If you click the arrow next to it, it will expand to show you the variables it contains, and clicking on it will open it to view, the same as using the View() function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>View</span><span class=p>(</span><span class=n>iris1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Now you can also observe the initial few rows of the iris1 object using head() function as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>head</span><span class=p>(</span><span class=n>iris1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   X Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class=gp>#</span><span class=c1>## 1 1          5.1         3.5          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 2 2          4.9         3.0          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 3 3          4.7         3.2          1.3         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 4 4          4.6         3.1          1.5         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 5 5          5.0         3.6          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 6 6          5.4         3.9          1.7         0.4  setosa</span>
</code></pre></td></tr></table>
</div>
</div><p>If you wish to observe more rows, you can use the n argument within the head() function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>head</span><span class=p>(</span><span class=n>iris1</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=m>15</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##     X Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class=gp>#</span><span class=c1>## 1   1          5.1         3.5          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 2   2          4.9         3.0          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 3   3          4.7         3.2          1.3         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 4   4          4.6         3.1          1.5         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 5   5          5.0         3.6          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 6   6          5.4         3.9          1.7         0.4  setosa</span>
<span class=gp>#</span><span class=c1>## 7   7          4.6         3.4          1.4         0.3  setosa</span>
<span class=gp>#</span><span class=c1>## 8   8          5.0         3.4          1.5         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 9   9          4.4         2.9          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 10 10          4.9         3.1          1.5         0.1  setosa</span>
<span class=gp>#</span><span class=c1>## 11 11          5.4         3.7          1.5         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 12 12          4.8         3.4          1.6         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 13 13          4.8         3.0          1.4         0.1  setosa</span>
<span class=gp>#</span><span class=c1>## 14 14          4.3         3.0          1.1         0.1  setosa</span>
<span class=gp>#</span><span class=c1>## 15 15          5.8         4.0          1.2         0.2  setosa</span>
</code></pre></td></tr></table>
</div>
</div><p>You can also observe the final few rows by using the tail() function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>tail</span><span class=p>(</span><span class=n>iris1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       X Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span>
<span class=gp>#</span><span class=c1>## 145 145          6.7         3.3          5.7         2.5 virginica</span>
<span class=gp>#</span><span class=c1>## 146 146          6.7         3.0          5.2         2.3 virginica</span>
<span class=gp>#</span><span class=c1>## 147 147          6.3         2.5          5.0         1.9 virginica</span>
<span class=gp>#</span><span class=c1>## 148 148          6.5         3.0          5.2         2.0 virginica</span>
<span class=gp>#</span><span class=c1>## 149 149          6.2         3.4          5.4         2.3 virginica</span>
<span class=gp>#</span><span class=c1>## 150 150          5.9         3.0          5.1         1.8 virginica</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that when we used the View() function, it opened a new tab in RStudio, whereas the head() and tail() functions printed the output beneath the syntax. Using View() will not print the output in a report and will therefore not be available for readers of your report. Bear this in mind when providing outputs in your assignments.</p>
<p>In the second example, let’s assume that the iris.csv data is located in another file path (i.e. on desktop under data folder) “~/Desktop/data/iris.csv” (“./Desktop/data/iris.csv” for Windows users). Now we need to provide a direct path to our .csv file depending on where it is located:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## The following command assumes that the iris.csv file is in the &#34;~/Desktop/data/iris.csv&#34; path</span>

<span class=n>iris2</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=n>file</span><span class=o>=</span><span class=s>&#34;~/Desktop/data/iris.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Another suggested option is to set the working directory where the data is located. To illustrate, assume that the iris.csv is located on your desktop under data folder and you want to set this directory as the working directory. The setwd() function will set the working directory to the folder “data”:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Set the working directory to &#34;~/Desktop/data&#34;</span>

<span class=nf>setwd</span><span class=p>(</span><span class=s>&#34;~/Desktop/data&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Remember that you must use the forward slash / or double backslash \ in R while specifying the file path. The Windows format of single backslash will not work.</p>
<p>After that you can read the iris.csv data using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris3</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Let’s check the header of the iris3 object:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>head</span><span class=p>(</span><span class=n>iris3</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   X Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class=gp>#</span><span class=c1>## 1 1          5.1         3.5          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 2 2          4.9         3.0          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 3 3          4.7         3.2          1.3         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 4 4          4.6         3.1          1.5         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 5 5          5.0         3.6          1.4         0.2  setosa</span>
<span class=gp>#</span><span class=c1>## 6 6          5.4         3.9          1.7         0.4  setosa</span>
</code></pre></td></tr></table>
</div>
</div><p>You can also compactly display the structure of an R object using str() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>str</span><span class=p>(</span><span class=n>iris3</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    150 obs. of  6 variables:</span>
<span class=gp>#</span><span class=c1>##  $ X           : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class=gp>#</span><span class=c1>##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...</span>
<span class=gp>#</span><span class=c1>##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...</span>
<span class=gp>#</span><span class=c1>##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Species     : chr  &#34;setosa&#34; &#34;setosa&#34; &#34;setosa&#34; &#34;setosa&#34; ...</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that when we assess the structure of the iris data set that we read in, Species is a character variable.
However, we may want to read in Species as a factor variable rather than a character. We can take care of this by changing the stringsAsFactors argument. The default is stringsAsFactors = False; however, setting it equal to TRUE will read in the variable as a factor variable.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris4</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=nf>str</span><span class=p>(</span><span class=n>iris4</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    150 obs. of  6 variables:</span>
<span class=gp>#</span><span class=c1>##  $ X           : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class=gp>#</span><span class=c1>##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...</span>
<span class=gp>#</span><span class=c1>##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...</span>
<span class=gp>#</span><span class=c1>##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Species     : Factor w/ 3 levels &#34;setosa&#34;,&#34;versicolor&#34;,..: 1 1 1 1 1 1 1 1 1 1 ...</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, you can see that the variable Species is a factor variable with three levels.</p>
<p>As previously stated read.csv is just a wrapper for read.table but with adjusted default arguments. Therefore, we can use read.table to read in this same data. The two arguments we need to be aware of are the field separator (sep) and the argument indicating whether the file contains the names of the variables as its first line (header). In read.table the defaults are sep = "" and header = FALSE whereas in read.csv the defaults are sep = &ldquo;,&rdquo; and header = TRUE.</p>
<p>Therefore, we can also use the read.table function to read the iris.csv data. The extra thing we need to specify is the separator and the header arguments. As the data is comma separated and the first line contains the names of the variables, we will use sep = &ldquo;,&rdquo; and header = TRUE options:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## provides same results as read.csv above</span>

<span class=n>iris5</span> <span class=o>&lt;-</span> <span class=nf>read.table</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s>&#34;,&#34;</span><span class=p>,</span> <span class=n>header</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Sometimes, it could happen that the file extension is .csv, but the data is not comma separated; rather, a semicolon (;) or any other symbol is used as a separator. In that case, we can still use the read.csv() function, but in this case we have to specify the separator.</p>
<p>Let’s look at the example with a semicolon-separated file named iris_semicolon.csv which is located under <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/iris_semicolon.csv target=_blank rel="noopener noreferrer">here</a>. After downloading and saving this data file in our working directory we can use:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris6</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris_semicolon.csv&#34;</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s>&#34;;&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Similarly, if the values are tab separated (.txt file), which can download from <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/iris_tab.txt target=_blank rel="noopener noreferrer">here</a>, we can use read.csv() with sep= &ldquo;\t&rdquo;. Alternatively, we can use read.table(). The following is an example:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris7</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris_tab.txt&#34;</span><span class=p>,</span><span class=n>sep</span><span class=o>=</span><span class=s>&#34;\t&#34;</span><span class=p>)</span>

<span class=c1>## provides same results as read.csv above</span>

<span class=n>iris8</span> <span class=o>&lt;-</span> <span class=nf>read.table</span><span class=p>(</span><span class=s>&#34;iris_tab.txt&#34;</span><span class=p>,</span><span class=n>header</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Notice that here when we used read.table(), we had to specify whether the variable name is present or not, using the argument header=TRUE.</p>
<h5 id=readr-package-functions>readr package functions</h5>
<p>Compared to the equivalent base functions, readr functions are around 10× faster. This will make a remarkable difference in reading time if you have a very large data set. They bring consistency to importing functions, they produce data frames in a data.table format which are easier to view for large data sets. The default settings for readr function removes the hassles of stringsAsFactors, and they are more flexible in column specification.</p>
<p>read_csv() function is equivalent to base R ’s read.csv() function (note the distinction between these two function names!). The main difference between read_csv() and base R ’s read.csv() functions is:</p>
<p>read_csv() maintains the full variable name whereas, read.csv eliminates any spaces in variable names and fills it with ‘.’</p>
<p>Prior to R 4.0.0, read.csv() set stringsAsFactors = TRUE by default, whereas read_csv() sets stringsAsFactors = FALSE by default. Since R 4.0.0, both functions now set stringsAsFactors = FALSE by default so there is no longer any difference in this regard, however if you are working with an older version of R, read.csv() will automatically convert character strings to factors when reading csv files.</p>
<p>Let’s read the iris.csv file using read_csv function. Note that the readr package needs to be installed and loaded before using this function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;readr&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>readr</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris9</span> <span class=o>&lt;-</span> <span class=nf>read_csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## -- Column specification --------------------------------------------------------</span>
<span class=gp>#</span><span class=c1>## cols(</span>
<span class=gp>#</span><span class=c1>##   X1 = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Sepal.Length = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Sepal.Width = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Petal.Length = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Petal.Width = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Species = col_character()</span>
<span class=gp>#</span><span class=c1>## )</span>
</code></pre></td></tr></table>
</div>
</div><p>When we use read_csv function, “Parsed with column specification” information will be reported. Note that this is not a warning, and nothing is wrong with your code. You can use this information to check the variable types in your data set. If you want to adjust in the variable types, you can use additional arguments inside this function. For more information on read_csv function and its arguments type help(read_csv).</p>
<p>The good news is RStudio has the built in “Import Dataset” dialog box on the upper-right “Environment” pane. You can also use this dialog box to import a wide range of file types including csv, Excel, SPSS, SAS and Stata data files. The process of importing a csv data set into RStudio is explained briefly in R Bootcamp notes (taken from Dr. James Baglin’s).</p>
<p>More information on readr package can be found here: <a href=https://cran.r-project.org/web/packages/readr/readr.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/readr/readr.pdf</a></p>
<h4 id=reading-data-from-excel-files>Reading Data from Excel files</h4>
<p>Excel is the most commonly used spreadsheet software. Therefore, it’s important to be able to efficiently import and export data from Excel. Often, users prefer to export the Excel data file as a .csv file and then import into R using read.csv or read_csv. However, this is not an efficient way to import Excel files. In this section, you will learn how to import data directly from Excel using different packages, the xlsx, openxlsx and readxl packages.</p>
<h5 id=the-xlsx-package>The xlsx Package</h5>
<p>If the dataset is stored in the .xls or .xlsx format, we have to use certain R packages to import those files; one of the packages is xlsxwhich has the function read.xlsx() to be used. However, Java and macOS (Version ≥ 10.12) do not play well due to some legacy issues. It has an adverse impact on the rJava package where a lot of R packages, including the xlsx package depends on. Unfortunately, for macOS users, installing xlsx package can be problematic as it requires rJava package and the rJava package installation may fail. In order to avoid this issue, we can use alternative packages.</p>
<h5 id=the-openxlsx-package>The openxlsx Package</h5>
<p>The openxlsx package, developed by Philipp Schauberger, Alexander Walker and Luca Braglia, can be used to import data from an Excel file into a data.frame. This package does not rely on Java (Java errors can occasionally be a problem for some users wishing to use some other packages). It is capable of reading dates and times, characters as characters (rather than factors), and can drop blank rows. It also provides the option for formatting outputs, allowing R data frames to be exported to attractive Excel workbooks for stakeholders such as management and clients, who may not be comfortable using R.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;openxlsx&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>openxlsx</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## read in xlsx worksheet via openxlsx package using sheet name</span>

<span class=n>iris10</span><span class=o>&lt;-</span> <span class=nf>read.xlsx</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## read in xlsx worksheet starting from the third row</span>

<span class=n>iris11</span><span class=o>&lt;-</span> <span class=nf>read.xlsx</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span> <span class=n>startRow</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=the-readxl-package>The readxl Package</h5>
<p>readxl was developed by Hadley Wickham and the RStudio team who also developed the readr package. This package works with both .xls and .xlsx formats. Unlike xlsx package, the readxl package has no external dependencies (like Java or Perl), so you can use it to read Excel data on any platform. Moreover, readxl has the ability to load dates and times, it automatically drops blank columns, reads in character variables as characters, and returns outputs as data.table format which is more convenient for viewing large data sets.</p>
<p>To read in Excel data with readxl you can use the read_excel() function. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;readxl&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>readxl</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## read in xlsx worksheet using a sheet index or name</span>

<span class=n>iris13</span><span class=o>&lt;-</span> <span class=nf>read_excel</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## New names:</span>
<span class=gp>#</span><span class=c1>## * `` -&gt; ...1</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## read in xlsx worksheet and change variable names by skipping the first row</span>
<span class=c1>## and using col_names to set the new names</span>

<span class=n>iris14</span><span class=o>&lt;-</span> <span class=nf>read_excel</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span> <span class=n>skip</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>col_names</span> <span class=o>=</span> <span class=nf>paste </span><span class=p>(</span><span class=s>&#34;Var&#34;</span><span class=p>,</span> <span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>More information on read_excel function and readxl package can be found here: <a href=https://cran.r-project.org/web/packages/readxl/readxl.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/readxl/readxl.pdf</a>.</p>
<h4 id=importing-data-from-statistical-software>Importing Data from statistical software</h4>
<p>The foreign package provides functions that help you read data files from other statistical software such as SPSS, SAS, Stata, and others into R. To import an SPSS data file (.sav) into R, we need to call the foreign library and then use the read.spss() function. Similarly, if we want to import a STATA data file, the corresponding function will be read.dta(). Here is an example of importing an SPSS data file:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;foreign&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>foreign</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## read in spss data file and store it as data frame </span>

<span class=n>iris_spss</span> <span class=o>&lt;-</span> <span class=nf>read.spss</span><span class=p>(</span><span class=s>&#34;iris.sav&#34;</span><span class=p>,</span> <span class=n>to.data.frame</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## re-encoding from UTF-8</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that we set the to.data.frame = TRUE option in order to have a data frame format, otherwise, the defaults (to.data.frame = FALSE) will read in the data as a list.</p>
<p>More information on foreign package can be found here: <a href=https://cran.r-project.org/web/packages/foreign/foreign.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/foreign/foreign.pdf</a></p>
<p>Remember that you can also use the “Import Dataset” dialog box on the upper-right “Environment” pane to import SPSS, SAS and Stata data files instead of using the foreign package.</p>
<h4 id=reading-from-databases>Reading from Databases</h4>
<p>A data set can be stored in any format whereas large-scale data sets are generally stored in database software. Commonly, large organizations and companies keep their data in relational databases. Therefore, we may need to import and process large-scale data sets in R.</p>
<p>One of the best approaches for working with data from a database is to export the data to a text file and then import the text file into R. According to Adler (2010), importing data into R at a much faster rate from text files than you can from database connections, especially when dealing with very large data sets (1 GB or more). This approach is considered to be the best approach if you plan to import a large amount of data once and then analyse. However, if you need to produce regular reports or to repeat an analysis many times, then it might be better to import data into R directly through a database connection.A</p>
<p>There are some packages in order to connect directly to a database from R. The packages you need to install would depend on the database(s) to which you want to connect and the connection method you want to use. There are two sets of database interfaces available in R:</p>
<ul>
<li>
<p>RODBC: The RODBC package allows R to fetch data from Open DataBase Connectivity (ODBC) connections. ODBC provides a standard interface for different programs to connect to databases. Before using RODBC, you need to</p>
<ul>
<li>i) install the RODBC package in R,</li>
<li>ii) install the ODBC drivers for your platform,</li>
<li>iii) configure an ODBC connection to your database. Adler (2010) provides a comprehensive list of where to find ODBC drivers for different databases and operating systems.</li>
</ul>
</li>
<li>
<p>DBI: The DBI package allows R to connect to databases using native database drivers or JDBC drivers. This package provides a common database abstraction for R software. You must install additional packages to use the native drivers for each database(s).</p>
</li>
</ul>
<p>The process of creating a connection is huge and beyond the scope of this course. Here, I will provide a list of additional resources to learn about data importing from these specific databases:</p>
<ul>
<li>MySQL: <a href=https://cran.r-project.org/web/packages/RMySQL/index.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/RMySQL/index.html</a></li>
<li>Oracle: <a href=https://cran.r-project.org/web/packages/ROracle/index.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/ROracle/index.html</a></li>
<li>PostgreSQL: <a href=https://cran.r-project.org/web/packages/RPostgreSQL/index.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/RPostgreSQL/index.html</a></li>
<li>SQLite: <a href=https://cran.r-project.org/web/packages/RSQLite/index.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/RSQLite/index.html</a></li>
<li>Open Database Connectivity databases: <a href=https://cran.rstudio.com/web/packages/RODBC target=_blank rel="noopener noreferrer">https://cran.rstudio.com/web/packages/RODBC</a></li>
</ul>
<p>Also, R data import/export manual <a href=https://cran.r-project.org/doc/manuals/R-data.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/doc/manuals/R-data.html</a> is a comprehensive source for configuring database connections and importing data from databases.</p>
<h4 id=scraping-data-from-web>Scraping Data from Web</h4>
<p>As a result of rapid growth of the World Wide Web, vast amount of information is now being stored online, both in structured and unstructured forms. Collecting data from the web is not an easy process as there are many technologies used to distribute web content (i.e., HTML, XML, JSON). Therefore, dealing with more advanced web scraping requires familiarity in accessing data stored in these technologies via R.
In this section, I will provide an introduction to some of the fundamental tools required to perform basic web scraping. This includes importing spreadsheet data files stored online and scraping HTML table data. In order to advance your knowledge in web scraping, I highly recommend getting copies of “XML and Web Technologies for Data Sciences with R” (by Deborah and Ducan (2014)) and “Automated Data Collection with R” (by Munzert et al. (2014)).</p>
<h5 id=importing-tabular-and-excel-files-stored-online>Importing Tabular and Excel files Stored Online</h5>
<p>The most basic form of getting data from online is to import tabular (i.e. .txt , .csv) or Excel files that are being hosted online. Importing tabular data is especially common for the many types of government data available online.</p>
<p>To illustrate we will use “Domestic Airlines - On Time Performance” data which is available online at <a href=https://data.gov.au/dataset/29128ebd-dbaa-4ff5-8b86-d9f30de56452/resource/cf663ed1-0c5e-497f-aea9-e74bfda9cf44/download/otptimeseriesweb.csv target=_blank rel="noopener noreferrer">https://data.gov.au/dataset/29128ebd-dbaa-4ff5-8b86-d9f30de56452/resource/cf663ed1-0c5e-497f-aea9-e74bfda9cf44/download/otptimeseriesweb.csv</a>. This .csv file covers monthly punctuality and reliability data of major domestic and regional airlines operating between Australian airports.
We can use read.csv or read.table functions to read online data depending upon the format of the data file. In fact, reading online .csv or .txt file is just like reading tabular data. The only difference is, we need to provide the URL of the data instead of the file name as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## the url for the online csv file</span>

<span class=n>url</span> <span class=o>&lt;-</span> <span class=s>&#34;https://data.gov.au/dataset/29128ebd-dbaa-4ff5-8b86-d9f30de56452/resource/cf663ed1-0c5e-497f-aea9-e74bfda9cf44/download/otptimeseriesweb.csv&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, as the online data is a .csv file, we can read this data file using read.csv function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## use read.csv to import</span>

<span class=n>ontime_data</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>

<span class=c1>## display first six rows and four variables in the data</span>

<span class=n>ontime_data[1</span><span class=o>:</span><span class=m>6</span><span class=p>,</span><span class=m>1</span><span class=o>:</span><span class=m>4</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##                 Route Departing_Port Arriving_Port      Airline</span>
<span class=gp>#</span><span class=c1>## 1   Adelaide-Brisbane       Adelaide      Brisbane All Airlines</span>
<span class=gp>#</span><span class=c1>## 2   Adelaide-Canberra       Adelaide      Canberra All Airlines</span>
<span class=gp>#</span><span class=c1>## 3 Adelaide-Gold Coast       Adelaide    Gold Coast All Airlines</span>
<span class=gp>#</span><span class=c1>## 4  Adelaide-Melbourne       Adelaide     Melbourne All Airlines</span>
<span class=gp>#</span><span class=c1>## 5      Adelaide-Perth       Adelaide         Perth All Airlines</span>
<span class=gp>#</span><span class=c1>## 6     Adelaide-Sydney       Adelaide        Sydney All Airlines</span>
</code></pre></td></tr></table>
</div>
</div><p>Importing Excel spreadsheets hosted online can be performed just as easily. Recall that there is no base R function for importing Excel data; however, several packages exist to import .xls and .xlsx files. One package that works smoothly with pulling Excel data from URLs is gdata. With gdata we can use read.xls() to import Excel files hosted online.</p>
<p>To illustrate, we will use the “General Aviation, 2013” dataset available at <a href=http://www.ntsb.gov/investigations/data/Documents/datafiles/AnnualReview_2013_Public_4_GA_20150218.xls target=_blank rel="noopener noreferrer">http://www.ntsb.gov/investigations/data/Documents/datafiles/AnnualReview_2013_Public_4_GA_20150218.xls</a>.</p>
<p>First, we need to install and load the gdata package, then we can read the online Excel file using read.xls function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## first install and load the gdata package</span>

<span class=c1>##install.packages(&#34;gdata&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>gdata</span><span class=p>)</span>
<span class=c1>## the url for the online Excel file</span>

<span class=n>aviation.url</span> <span class=o>&lt;-</span> <span class=s>&#34;http://www.ntsb.gov/investigations/data/Documents/datafiles/AnnualReview_2013_Public_4_GA_20150218.xls&#34;</span>

<span class=c1>## use read.xls to import</span>

<span class=n>aviation</span> <span class=o>&lt;-</span> <span class=nf>read.xls</span><span class=p>(</span><span class=n>aviation.url</span><span class=p>)</span>

<span class=c1>## display the first six rows in the data</span>

<span class=nf>head</span><span class=p>(</span><span class=n>aviation</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   This.spreadsheet.contains.the.following.workbooks.</span>
<span class=gp>#</span><span class=c1>## 1                                            Data_GA</span>
<span class=gp>#</span><span class=c1>## 2                                     GA_FlightHours</span>
<span class=gp>#</span><span class=c1>## 3                                       GA_Accidents</span>
<span class=gp>#</span><span class=c1>## 4                        GA_AircraftCategory_FlightP</span>
<span class=gp>#</span><span class=c1>## 5                                         GA_AccRate</span>
<span class=gp>#</span><span class=c1>## 6                            GA_Personal_FlightHours</span>
<span class=gp>#</span><span class=c1>##</span>
<span class=go>X
</span><span class=go></span><span class=gp>#</span><span class=c1>## 1 This workbook contains NTSB accident data (one row per accident aircraft) for all United States civil aviation accidents in calendar year 2013 involving aircraft not operating under 14 CFR Parts 121, 135, or 129. The data dictionary for this workbook is shown below.</span>
<span class=gp>#</span><span class=c1>## 2</span>
<span class=go>This workbook summarizes general aviation flight hours from 2004 through 2013, using FAA activity data.
</span><span class=go></span><span class=gp>#</span><span class=c1>## 3</span>
<span class=go>This workbook summarizes total and fatal general aviation accidents from 2004 through 2013, using NTSB accident data.
</span><span class=go></span><span class=gp>#</span><span class=c1>## 4</span>
<span class=go>This workbook summarizes general aviation accidents in 2013 by aircraft category and purpose of flight, using NTSB accident data.
</span><span class=go></span><span class=gp>#</span><span class=c1>## 5</span>
<span class=go>This workbook summarizes total and fatal general aviation accident rates from 2004 through 2013, using NTSB accident data and FAA activity data.
</span><span class=go></span><span class=gp>#</span><span class=c1>## 6</span>
<span class=go>This workbook summarizes general aviation personal flying hours from 2004 through 2013, using FAA activity data.
</span></code></pre></td></tr></table>
</div>
</div><p>By default, the read.xls() will read the data from first sheet (first workbook) and first line in the xls file. As you have seen in the head(aviation) output given above, the first sheet includes the dataset information, not the actual data. Therefore, it is important to check the original xls file (download and open it using Excel) and note the location (i.e. Sheet name and the line number where the data starts) of the data that you want to import.</p>
<p>For this example, the actual dataset is in the second sheet (i.e. Data_GA) and starts from the second line (the first line is for the title of the data). We can easily specify the sheet name and skip the first line by using sheet and skip arguments as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## this time use sheet and skip arguments to locate the data properly</span>
<span class=c1>## Use sheet = 2 and skip= 1 as the data is in second sheet and starts from second line (skip first line)</span>

<span class=n>aviation</span> <span class=o>&lt;-</span> <span class=nf>read.xls</span><span class=p>(</span><span class=n>aviation.url</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=m>2</span><span class=p>,</span> <span class=n>skip</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span>

<span class=c1>## display the first six rows in the data</span>

<span class=nf>head</span><span class=p>(</span><span class=n>aviation</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      ntsb_no aircraft_key    ev_date latitude longitude         ev_city</span>
<span class=gp>#</span><span class=c1>## 1 WPR13CA079            1 2013-01-01  423428N  1215226W       Chiloquin</span>
<span class=gp>#</span><span class=c1>## 2 WPR13LA082            1 2013-01-02  361238N  1151140W North Las Vegas</span>
<span class=gp>#</span><span class=c1>## 3 WPR13FA083            1 2013-01-02  350358N  1203706W          Oceano</span>
<span class=gp>#</span><span class=c1>## 4 WPR13FA080            1 2013-01-02  354337N  1190945W          Delano</span>
<span class=gp>#</span><span class=c1>## 5 CEN13FA122            1 2013-01-02  430834N  0932858W      Clear Lake</span>
<span class=gp>#</span><span class=c1>## 6 ERA13FA101            1 2013-01-01  335310N  0871900W          Jasper</span>
<span class=gp>#</span><span class=c1>##   ev_state ev_country inj_tot_f inj_tot_s ev_highest_injury damage far_part</span>
<span class=gp>#</span><span class=c1>## 1       OR        USA        NA        NA              NONE   SUBS     091 </span>
<span class=gp>#</span><span class=c1>## 2       NV        USA        NA        NA              NONE   SUBS     091 </span>
<span class=gp>#</span><span class=c1>## 3       CA        USA         1        NA              FATL   SUBS     091 </span>
<span class=gp>#</span><span class=c1>## 4       CA        USA         1        NA              FATL   DEST     091 </span>
<span class=gp>#</span><span class=c1>## 5       IA        USA         3        NA              FATL   DEST     091 </span>
<span class=gp>#</span><span class=c1>## 6       AL        USA         3        NA              FATL   DEST     091 </span>
<span class=gp>#</span><span class=c1>##   oper_pax_cargo oper_dom_int oper_sched acft_category type_fly CICTTEvent</span>
<span class=gp>#</span><span class=c1>## 1                                                 AIR      INST      LOC-G</span>
<span class=gp>#</span><span class=c1>## 2                                                 AIR      INST      LOC-G</span>
<span class=gp>#</span><span class=c1>## 3                                                 AIR      PERS      LOC-I</span>
<span class=gp>#</span><span class=c1>## 4                                                 HELI     OWRK       UIMC</span>
<span class=gp>#</span><span class=c1>## 5                                                 HELI     POSI      LOC-I</span>
<span class=gp>#</span><span class=c1>## 6                                                 AIR      PERS       OTHR</span>
<span class=gp>#</span><span class=c1>##   CICTTPhase Synopsis</span>
<span class=gp>#</span><span class=c1>## 1        LDG Synopsis</span>
<span class=gp>#</span><span class=c1>## 2        LDG Synopsis</span>
<span class=gp>#</span><span class=c1>## 3        MNV Synopsis</span>
<span class=gp>#</span><span class=c1>## 4        MNV Synopsis</span>
<span class=gp>#</span><span class=c1>## 5        ENR Synopsis</span>
<span class=gp>#</span><span class=c1>## 6        UND Synopsis</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that, you will get an error when you try to read from an URL starting with https as the read.xls function does not support https. If you simply replace the https with http in the url, read.xls function will be able to import the file.</p>
<h5 id=scraping-html-table-data>Scraping HTML Table Data</h5>
<p>Sometimes, web pages contain several HTML tables and we may want to read the data from that HTML table. The simplest approach to scraping HTML table data directly into R is by using the rvest package. Recall that. HTML tables are contained within &lt;table> tags; therefore, to extract the tables, we need to use the html_nodes() function to select the &lt;table> nodes.</p>
<p>To illustrate, I will use the example from the help page for rvest, which loads all tables from the U.S. Social Security webpage: <a href=https://www.ssa.gov/oact/babynames/numberUSbirths.html target=_blank rel="noopener noreferrer">https://www.ssa.gov/oact/babynames/numberUSbirths.html</a></p>
<p>First, we will install and load the rvest package:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## first install and load the rvest package</span>

<span class=c1>##install.packages(&#34;rvest&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>rvest</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>We will use <strong>read_html</strong> to locate the URL of the HTML table. When we use <strong>read_html</strong>, all table nodes that exist on the webpage will be captured.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>births</span> <span class=o>&lt;-</span> <span class=nf>read_html</span><span class=p>(</span><span class=s>&#34;https://www.ssa.gov/oact/babynames/numberUSbirths.html&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>In this example, using the length function we can see that the html_nodes captures 1 HTML table.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>length</span><span class=p>(</span><span class=nf>html_nodes</span><span class=p>(</span><span class=n>births</span><span class=p>,</span> <span class=s>&#34;table&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1</span>
</code></pre></td></tr></table>
</div>
</div><p>In this example the webpage included only one table and this first table on the webpage is the place where our data is located, thus, we will select the first element of the html_nodes.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## select the second element of the html_nodes</span>

<span class=n>births_data</span><span class=o>&lt;-</span> <span class=nf>html_table</span><span class=p>(</span><span class=nf>html_nodes</span><span class=p>(</span><span class=n>births</span><span class=p>,</span> <span class=s>&#34;table&#34;</span><span class=p>)</span><span class=n>[[1]]</span><span class=p>)</span>

<span class=c1>## view the header of the births_data</span>

<span class=nf>head</span><span class=p>(</span><span class=n>births_data</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   Year of birth    Male  Female   Total</span>
<span class=gp>#</span><span class=c1>## 1          1880 118,399  97,606 216,005</span>
<span class=gp>#</span><span class=c1>## 2          1881 108,282  98,855 207,137</span>
<span class=gp>#</span><span class=c1>## 3          1882 122,031 115,695 237,726</span>
<span class=gp>#</span><span class=c1>## 4          1883 112,475 120,059 232,534</span>
<span class=gp>#</span><span class=c1>## 5          1884 122,738 137,585 260,323</span>
<span class=gp>#</span><span class=c1>## 6          1885 115,945 141,948 257,893</span>
</code></pre></td></tr></table>
</div>
</div><p>However, in some cases the webpage can include data from a few additional tables used to format other parts of the page (i.e. table of contents, table of figures, advertisements, etc.). If this is the case, one needs to scan the html source of the webpage and select the table(s) that the data are located.</p>
<p>I recommend using <a href=https://chrome.google.com/webstore/detail/element-locator/pldlfgnilfdheajekfphjkjeooignhkc target=_blank rel="noopener noreferrer">Element Locator</a>, this extension allows you to locate and save HTML elements for each page(url), And shows XPath and CSS-Selector for each saved element.</p>
<h4 id=exporting-data>Exporting Data</h4>
<p>Exporting data out of R is equally important as importing data into R. In this section, we will cover how to export data to text files, Excel files and save to R data objects. In addition to the commonly used base R functions to export data, we will also cover functions from the popular readr and xlsx packages.</p>
<h5 id=exporting-data-to-text-files>Exporting Data to text files</h5>
<p>Similar to the previous examples provided in the importing text files section, in this section I will introduce the base R and readr package functions to export data to text files.</p>
<h6 id=base-r-functions-1>Base R functions</h6>
<p>write.table() is the multi-purpose function in base R for exporting data. The function write.csv() is a special case of write.table() in which the defaults have been adjusted for efficiency. To illustrate, let’s create a data frame and export it to a CSV file in our working directory.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a data frame and assign it to an object named df</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame </span><span class=p>(</span><span class=n>cost</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>25</span><span class=p>,</span> <span class=m>40</span><span class=p>),</span>
                  <span class=n>color</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;blue&#34;</span><span class=p>,</span> <span class=s>&#34;red&#34;</span><span class=p>,</span> <span class=s>&#34;green&#34;</span><span class=p>),</span>
                  <span class=n>suv</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>),</span>
                  <span class=n>row.names</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;car1&#34;</span><span class=p>,</span> <span class=s>&#34;car2&#34;</span><span class=p>,</span> <span class=s>&#34;car3&#34;</span><span class=p>))</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      cost color   suv</span>
<span class=gp>#</span><span class=c1>## car1   10  blue  TRUE</span>
<span class=gp>#</span><span class=c1>## car2   25   red  TRUE</span>
<span class=gp>#</span><span class=c1>## car3   40 green FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>To export df to a CSV file we will use write.csv().</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a csv file in our working directory</span>

<span class=nf>write.csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>If you want to save the data frame in a different directory, we will use:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a csv and save in a different directory (i.e., ~/Desktop)</span>

<span class=nf>write.csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;~/Desktop/cars_csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>This function has additional arguments which will allow you to exclude row/column names, specify what to use for missing values, add or remove quotations around character strings, etc.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a csv file without row names</span>

<span class=nf>write.csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_csv&#34;</span><span class=p>,</span> <span class=n>row.names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>In addition to CSV files, we can also write to other text formats using write.table() by specifying the sep argument.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a tab delimited text file</span>

<span class=nf>write.table</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_txt&#34;</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s>&#34;\t&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h6 id=the-readr-package>The readr Package</h6>
<p>The readr package functions, write_csv and write_delim are twice as fast as base R functions and they are very similar in usage.</p>
<p>Let’s use the same example to illustrate the usage of write_csv and write_delim</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## load the library</span>

<span class=nf>library</span><span class=p>(</span><span class=n>readr</span><span class=p>)</span>

<span class=c1>## write to a csv file in the working directory</span>

<span class=nf>write_csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_csv2&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a csv and save in a different directory (i.e., ~/Desktop)</span>

<span class=nf>write_csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span>  <span class=s>&#34;~/Desktop/export_csv2&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a csv file without column names</span>

<span class=nf>write_csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span>  <span class=s>&#34;export_csv2&#34;</span><span class=p>,</span> <span class=n>col_names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## write to a txt file in the working directory</span>

<span class=nf>write_delim</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span>  <span class=s>&#34;export_txt2&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=exporting-data-to-excel-files>Exporting Data to Excel files</h5>
<p>The xlsx and openxlsx packages can be used for exporting data to Excel. However, the readxl package which I demonstrated in the importing data section does not have a function to export to Excel, therefore I will skip it here.</p>
<p>We will use the write.xlsx() function in the openxlsx package to export the data to a xlsx file.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## load the library</span>

<span class=nf>library</span><span class=p>(</span><span class=n>openxlsx</span><span class=p>)</span>

<span class=c1>## write to a .xlsx file in the working directory</span>

<span class=nf>write.xlsx</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars.xlsx&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>For the full functionality of the openxlsx package please refer to the <a href=https://cran.r-project.org/web/packages/openxlsx/openxlsx.pdf target=_blank rel="noopener noreferrer">package documentation</a>.</p>
<h4 id=saving-data-as-an-r-object-file>Saving Data as an R object File</h4>
<p>Sometimes we may need to save data or other R objects outside of the workspace or may want to store, share, or transfer between computers.</p>
<p>Basically, we can use .rda or .RData file types when we want to save <strong>several, or all, objects and functions</strong> that exist in the global environment</p>
<p>On the other hand, if we only want to save a <strong>single R object such as a data frame, function, or statistical model result</strong>, it is best to use the .rds file type.</p>
<p>Still, we can use .rda or .RData to save a single object but the benefit of .rds is it only saves a <strong>representation of the object and not the name</strong> whereas .rda and .RData save <strong>both the object and its name</strong>. As a result, with .rds the saved object can be loaded into a named object within R that is different from the name it had when originally saved.</p>
<p>To illustrate let’s create two objects named x and y and save them to a .RData file using save() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## generate random numbers from uniform and normal distribution and assign them to objects named x and y, respectively.</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>runif</span><span class=p>(</span><span class=m>10</span><span class=p>)</span>
<span class=n>y</span> <span class=o>&lt;-</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>10</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>)</span>

<span class=c1>## Save both objects in .RData format in the working directory</span>

<span class=nf>save</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;xy.RData&#34;</span><span class=p>)</span>
<span class=n>Also</span><span class=p>,</span> <span class=n>the</span> <span class=nf>save.image</span><span class=p>()</span> <span class=n>function</span> <span class=n>will</span> <span class=n>save</span> <span class=n>your</span> <span class=n>all</span> <span class=n>current</span> <span class=n>workspace</span> <span class=n>as</span> <span class=n>.RData.</span>

<span class=c1>## save all objects in the global environment</span>

<span class=nf>save.image</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>The</span> <span class=n>following</span> <span class=n>examples</span> <span class=n>will</span> <span class=n>illustrate</span> <span class=n>how</span> <span class=n>a</span> <span class=n>single</span> <span class=n>object</span> <span class=n>will</span> <span class=n>be</span> <span class=n>saved</span> <span class=n>using</span> <span class=nf>saveRDS</span><span class=p>()</span>

<span class=c1>## save a single object to file</span>

<span class=nf>saveRDS</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=s>&#34;x.rds&#34;</span><span class=p>)</span>

<span class=c1>## restore it under a different name</span>

<span class=n>x2</span> <span class=o>&lt;-</span> <span class=nf>readRDS</span><span class=p>(</span><span class=s>&#34;x.rds&#34;</span><span class=p>)</span>

<span class=c1>## check if x and x2 are identical</span>

<span class=nf>identical</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>x2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>For further details on differences between rds and RData formats please read the article (thanks to Shane Smith for finding this) in <a href=http://www.sthda.com/english/wiki/saving-data-into-r-data-format-rds-and-rdata target=_blank rel="noopener noreferrer">http://www.sthda.com/english/wiki/saving-data-into-r-data-format-rds-and-rdata</a>.</p>
<h3 id=additional-resources-and-further-reading>Additional Resources and Further Reading</h3>
<p>R data import/export manual <a href=https://cran.r-project.org/doc/manuals/R-data.html target=_blank rel="noopener noreferrer">https://cran.r-project.org/doc/manuals/R-data.html</a> (R Team (2000)) is a comprehensive source for all types of data importing and exporting tasks in R. Also, RStudio’s “Data Import Cheatsheet” is a compact resource for all importing functions available in the readr package.</p>
<h3 id=references>References</h3>
<p>Adler, Joseph. 2010. R in a Nutshell: A Desktop Quick Reference. " O’Reilly Media, Inc.".</p>
<p>Deborah, Nolan, and TL Ducan. 2014. “XML and Web Technologies for Data Sciences with R.” N. Deborah, & TL Ducan, XML and Web Technologies for Data Sciences with R, 581–618.</p>
<p>Munzert, Simon, Christian Rubba, Peter Meißner, and Dominic Nyhuis. 2014. Automated Data Collection with R: A Practical Guide to Web Scraping and Text Mining. John Wiley & Sons.</p>
<p>Team, R Core. 2000. “R Data Import/Export.”</p>
<h2 id=model-3---understand-understanding-data-and-data-structures>Model 3 - Understand: Understanding Data and Data Structures</h2>
<h3 id=summary-2>Summary</h3>
<p>Importing data successfully doesn’t mean that we have all the information about our data. Understanding data structures and variable types in the data set are also crucial for conducting data preprocessing. We shouldn’t be performing any type of data preprocessing without understanding what we have in hand. In this module, I will provide the basics of variable types and data structures. You will learn to check the types of the variables, dimensions and structure of the data, and levels/values for the variables. We will also cover how to manipulate the format of the data (i.e., data type conversions). Finally, the difference between wide and long formatted data will be explained.</p>
<h3 id=learning-objectives-2>Learning objectives</h3>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Understand R’s basic data types (i.e., character, numeric, integer, factor, and logical).</li>
<li>Understand R’s basic data structures (i.e., vector, list, matrix, and data frame) and main differences between them.</li>
<li>Learn to check attributes (i.e., name, dimension, class, levels etc.) of R objects.</li>
<li>Learn how to convert between data types/structures.</li>
<li>Understand the difference between wide vs. long formatted data.</li>
</ul>
<h3 id=purpose-1>Purpose</h3>
<p>By completing the essential module reading, skill builders and reviewing the recorded lecture, you will be able to finalise your Assignment 1.</p>
<h3 id=types-of-variables>Types of variables</h3>
<p>A data set is a collection of measurements or records which are often called as variables and there are two major types of variables that can be stored in a data set: qualitative and quantitative. The qualitative variable is often called as categorical and they have a non-numeric structure such as gender, hair colour, type of a disease, etc. The qualitative variable can be nominal or ordinal.</p>
<ul>
<li>
<p><strong>Nominal variable</strong>: They have a scale in which the numbers or letters assigned to objects serve as labels for identification or classification. Examples of this variable include binary variables (e.g., yes/no, male/female) and multinomial variables (e.g. religious affiliation, eye colour, ethnicity, suburb).</p>
</li>
<li>
<p><strong>Ordinal variable</strong>: They have a scale that arranges objects or alternatives according to their ranking. Examples include the exam grades (i.e., HD, DI, Credit, Pass, Fail etc.) and the disease severity (i.e., severe, moderate, mild).</p>
</li>
</ul>
<p>The second type of variable is called the quantitative variable. These variables are the numerical data that we can either measure or count. The quantitative variables can be either discrete or continuous.</p>
<ul>
<li>
<p><strong>Continuous quantitative variable</strong>: They arise from a measurement process. Continuous variables are measured on a continuum or scale. They can have almost any numeric value and can be meaningfully subdivided into finer and finer increments, depending upon the precision of the measurement system. For example: time, temperature, wind speed may be considered as continuous quantitative variables.</p>
</li>
<li>
<p><strong>Discrete quantitative variable</strong>: They arise from a counting process. Examples include the number of text messages you sent this past week and the number of faults in a manufacturing process.</p>
</li>
</ul>
<p>The following short video by Nicola Petty provides a great overview on the variable types. Note that, in some statistical sources, the “type of the data” and the “type of the variables” are used synonymously. In the following video, the term “types of data” are used to refer the “types of variables”.</p>
<p>{% youtube hZxnzfnt5v8 %}</p>
<h3 id=data-structures-in-r>Data Structures in R</h3>
<p>In the previous section, we defined the types of variables in a general sense. However, as R is a programming language it has own definitions of data types and structures. Technically, R classifies all the different types of data into four classes:</p>
<ul>
<li><strong>Logical</strong>: This class consists of TRUE or FALSE (binary) values. A logical value is often created via comparison between variables.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>x</span> <span class=o>&lt;-</span> <span class=m>10</span>
<span class=n>y</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;</span> <span class=m>0</span><span class=p>)</span>
<span class=n>y</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>We can use class() function to check the class of an object.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check the class of y</span>

<span class=nf>class</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;logical&#34;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>Numeric</strong> (integer or double): Quantitative values are called as numeric in R. It is the default computational data type. Numeric class can be integer or double. Integer types can be seen as discrete values (e.g., 2) whereas, double class will have floating point numbers (e.g., 2.16).</li>
</ul>
<p>Here is an example of a double numeric variable:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a double-precision numeric variable</span>

<span class=n>dbl_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>4</span><span class=p>,</span> <span class=m>7.5</span><span class=p>,</span> <span class=m>14.5</span><span class=p>)</span>

<span class=c1>## check the class of dbl_var</span>

<span class=nf>class</span><span class=p>(</span><span class=n>dbl_var</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;numeric&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>To check whether a numeric object is integer or double, you can also use typeof().</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check the type of dbl_var object</span>

<span class=nf>typeof</span><span class=p>(</span><span class=n>dbl_var</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;double&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>In order to create an integer variable, we must place an L directly after each number. Here is an example:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># create an integer (numeric) variable</span>
<span class=err>
</span><span class=err></span><span class=go>int_var &lt;- c(4L, 7L, 14L)
</span><span class=go></span><span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># check the class of int_var</span>
<span class=err>
</span><span class=err></span><span class=go>class(int_var)
</span></code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;integer&#34;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>Character</strong>: A character class is used to represent string values in R. The most basic way to generate a character object is to use quotation marks " " and assign a string/text to an object.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a character variable using &#34; &#34; and check its class</span>

<span class=n>char_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>)</span>

<span class=nf>class</span><span class=p>(</span><span class=n>char_var</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;character&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Factor: Factor class is used to represent qualitative data in R. Factors can be ordered or unordered. Factors store the nominal values as a vector of integers in the range [1…k] (where k is the number of unique values in the nominal variable), and an internal vector of character strings (the original values) mapped to these integers.
Factor objects can be created with the factor() function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a factor variable using factor()</span>

<span class=n>fac_var1</span> <span class=o>&lt;-</span> <span class=nf>factor</span><span class=p>(</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;Male&#34;</span><span class=p>,</span> <span class=s>&#34;Female&#34;</span><span class=p>,</span> <span class=s>&#34;Male&#34;</span><span class=p>,</span> <span class=s>&#34;Male&#34;</span><span class=p>)</span> <span class=p>)</span>
<span class=n>fac_var1</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] Male   Female Male   Male  </span>
<span class=gp>#</span><span class=c1>## Levels: Female Male</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check its class </span>

<span class=nf>class</span><span class=p>(</span><span class=n>fac_var1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;factor&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>To see the levels of a factor object levels() function will be used:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check the factor levels</span>

<span class=nf>levels</span><span class=p>(</span><span class=n>fac_var1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;Female&#34; &#34;Male&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>By default, the levels of the factors will be ordered alphabetically. Using the levels() argument, we can control the ordering of the levels while creating a factor:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a factor variable using factor() and order the levels using levels() argument</span>

<span class=n>fac_var2</span> <span class=o>&lt;-</span> <span class=nf>factor</span><span class=p>(</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;Male&#34;</span><span class=p>,</span> <span class=s>&#34;Female&#34;</span><span class=p>,</span> <span class=s>&#34;Male&#34;</span><span class=p>,</span> <span class=s>&#34;Male&#34;</span><span class=p>),</span> 
                    <span class=n>levels</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;Male&#34;</span><span class=p>,</span> <span class=s>&#34;Female&#34;</span><span class=p>)</span> <span class=p>)</span>
<span class=n>fac_var2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] Male   Female Male   Male  </span>
<span class=gp>#</span><span class=c1>## Levels: Male Female</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check its levels </span>

<span class=nf>levels</span><span class=p>(</span><span class=n>fac_var2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;Male&#34;   &#34;Female&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>We can also create ordinal factors in a specific order using the ordered = TRUE argument:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a ordered factor variable using factor() and order the levels using levels() argument</span>

<span class=n>ordered_fac</span> <span class=o>&lt;-</span><span class=nf>factor</span><span class=p>(</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;DI&#34;</span><span class=p>,</span> <span class=s>&#34;HD&#34;</span><span class=p>,</span> <span class=s>&#34;PA&#34;</span><span class=p>,</span> <span class=s>&#34;NN&#34;</span><span class=p>,</span> <span class=s>&#34;CR&#34;</span><span class=p>,</span> <span class=s>&#34;DI&#34;</span><span class=p>,</span> <span class=s>&#34;HD&#34;</span><span class=p>,</span> <span class=s>&#34;PA&#34;</span><span class=p>),</span> 
                      <span class=n>levels</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;NN&#34;</span><span class=p>,</span> <span class=s>&#34;PA&#34;</span><span class=p>,</span> <span class=s>&#34;CR&#34;</span><span class=p>,</span> <span class=s>&#34;DI&#34;</span><span class=p>,</span> <span class=s>&#34;HD&#34;</span><span class=p>),</span> <span class=n>ordered</span><span class=o>=</span><span class=kc>TRUE</span> <span class=p>)</span>

<span class=n>ordered_fac</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] DI HD PA NN CR DI HD PA</span>
<span class=gp>#</span><span class=c1>## Levels: NN &lt; PA &lt; CR &lt; DI &lt; HD</span>
</code></pre></td></tr></table>
</div>
</div><p>The ordering will be reflected as NN &lt; PA &lt; CR &lt; DI &lt; HD in the output.</p>
<p>Factors are also created during the data import. Many import functions like read.csv(), read_cvs(), read.table() etc. have stringsAsFactors option that determines how the character data is read in R. For BaseR read.csv() function, the default setting is stringsAsFactors = False. However, if we set it to TRUE, then all columns that are detected to be character/strings are converted to factor variables.</p>
<p>Let’s read the <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/VIC_pet.csv target=_blank rel="noopener noreferrer">VIC_pet.csv</a> dataset available under data repository using read.csv():</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>pets</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;data/VIC_pet.csv&#34;</span><span class=p>,</span><span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>pets</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##        id    State      Region                              Animal_Type</span>
<span class=gp>#</span><span class=c1>## 1  17819v Victoria Colac Otway Dog                                     </span>
<span class=gp>#</span><span class=c1>## 2 142785v Victoria     Wyndham                               Cat       </span>
<span class=gp>#</span><span class=c1>## 3  97268v Victoria    Ballarat                                      Cat</span>
<span class=gp>#</span><span class=c1>## 4  46906v Victoria     Geelong                                      Dog</span>
<span class=gp>#</span><span class=c1>## 5  35939v Victoria     Geelong                                      Dog</span>
<span class=gp>#</span><span class=c1>## 6 114898v Victoria    Ballarat                                      Dog</span>
<span class=gp>#</span><span class=c1>##                                Animal_Name</span>
<span class=gp>#</span><span class=c1>## 1 CHUBBY                                  </span>
<span class=gp>#</span><span class=c1>## 2                                         </span>
<span class=gp>#</span><span class=c1>## 3                                   Bailey</span>
<span class=gp>#</span><span class=c1>## 4                                    Shuko</span>
<span class=gp>#</span><span class=c1>## 5                                   Violet</span>
<span class=gp>#</span><span class=c1>## 6                                    Ralph</span>
<span class=gp>#</span><span class=c1>##                          Breed_Description Colour Animal_Desexed</span>
<span class=gp>#</span><span class=c1>## 1 Labrador                                   NULL               </span>
<span class=gp>#</span><span class=c1>## 2                                 Domestic                      </span>
<span class=gp>#</span><span class=c1>## 3                                  Burmese                      </span>
<span class=gp>#</span><span class=c1>## 4                          German Shepherd                      </span>
<span class=gp>#</span><span class=c1>## 5                   Labrador/Staffordshire                      </span>
<span class=gp>#</span><span class=c1>## 6                 German Wire Hair Pointer</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>str</span><span class=p>(</span><span class=n>pets</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    40 obs. of  8 variables:</span>
<span class=gp>#</span><span class=c1>##  $ id               : Factor w/ 40 levels &#34;10396v&#34;,&#34;104515v&#34;,..: 15 9 39 21 18 4 30 6 14 25 ...</span>
<span class=gp>#</span><span class=c1>##  $ State            : Factor w/ 1 level &#34;Victoria&#34;: 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Region           : Factor w/ 7 levels &#34;Ballarat&#34;,&#34;Colac Otway&#34;,..: 2 7 1 3 3 1 3 5 7 3 ...</span>
<span class=gp>#</span><span class=c1>##  $ Animal_Type      : Factor w/ 7 levels &#34;Cat&#34;,&#34;Cat       &#34;,..: 7 2 1 4 4 4 4 5 6 1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Animal_Name      : Factor w/ 28 levels &#34;&#34;,&#34;Bailey&#34;,&#34;Blacky&#34;,..: 9 1 2 24 28 20 14 1 1 10 ...</span>
<span class=gp>#</span><span class=c1>##  $ Breed_Description: Factor w/ 34 levels &#34;&#34;,&#34;American Staffordshire Terrier&#34;,..: 23 11 6 14 24 16 28 28 2 11 ...</span>
<span class=gp>#</span><span class=c1>##  $ Colour           : Factor w/ 3 levels &#34;&#34;,&#34;NULL&#34;,&#34;WHI &#34;: 2 1 1 1 1 1 1 1 1 1 ...</span>
<span class=gp>#</span><span class=c1>##  $ Animal_Desexed   : Factor w/ 4 levels &#34;&#34;,&#34;N&#34;,&#34;y&#34;,&#34;Y&#34;: 1 1 1 1 1 1 1 4 1 1 ...</span>
</code></pre></td></tr></table>
</div>
</div><p>As seen from the str() output, all of the columns in pets data are read as factors due to containing strings and the data was imported using read.csv() with the default option. Now, let’s focus on Animal_Type variable and check its levels using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>levels</span><span class=p>(</span><span class=n>pets</span><span class=o>$</span><span class=n>Animal_Type</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;Cat&#34;                                     </span>
<span class=gp>#</span><span class=c1>## [2] &#34;Cat       &#34;                              </span>
<span class=gp>#</span><span class=c1>## [3] &#34;dog&#34;                                     </span>
<span class=gp>#</span><span class=c1>## [4] &#34;Dog&#34;                                     </span>
<span class=gp>#</span><span class=c1>## [5] &#34;DOG &#34;                                    </span>
<span class=gp>#</span><span class=c1>## [6] &#34;Dog       &#34;                              </span>
<span class=gp>#</span><span class=c1>## [7] &#34;Dog                                     &#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that there are in fact two unique levels for the Animal_Type i.e. dog and cat. However, due to the automatic conversion of different strings to factors we observe seven different levels in Animal_Type, namely “Cat”, “Cat[whitespace]”, “dog”, “Dog”,“DOG[whitespace]”, “Dog[whitespace]”, “Dog[whitespace][whitespace]”. Again, it is a good practice to read such strings as characters and then apply string manipulations (which will be covered in Module 8) to standardize all strings to “dog” and “cat”.</p>
<p>Now let’s look at the levels of id variable which contains the unique identification number of the pets:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>levels</span><span class=p>(</span><span class=n>pets</span><span class=o>$</span><span class=n>id</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##  [1] &#34;10396v&#34;  &#34;104515v&#34; &#34;110188v&#34; &#34;114898v&#34; &#34;129666v&#34; &#34;13234v&#34;  &#34;137135v&#34;</span>
<span class=gp>#</span><span class=c1>##  [8] &#34;141587v&#34; &#34;142785v&#34; &#34;143032v&#34; &#34;151452v&#34; &#34;151569v&#34; &#34;151921v&#34; &#34;154462v&#34;</span>
<span class=gp>#</span><span class=c1>## [15] &#34;17819v&#34;  &#34;1828v&#34;   &#34;18714v&#34;  &#34;35939v&#34;  &#34;3654v&#34;   &#34;39333v&#34;  &#34;46906v&#34; </span>
<span class=gp>#</span><span class=c1>## [22] &#34;49872v&#34;  &#34;51127v&#34;  &#34;54848v&#34;  &#34;55483v&#34;  &#34;5754v&#34;   &#34;61112v&#34;  &#34;64560v&#34; </span>
<span class=gp>#</span><span class=c1>## [29] &#34;66701v&#34;  &#34;70244v&#34;  &#34;70794v&#34;  &#34;7089v&#34;   &#34;77361v&#34;  &#34;81001v&#34;  &#34;84561v&#34; </span>
<span class=gp>#</span><span class=c1>## [36] &#34;88946v&#34;  &#34;92359v&#34;  &#34;93485v&#34;  &#34;97268v&#34;  &#34;97957v&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>As seen in the above output, there is no need to factorize id variable as there are 40 observations and 40 different levels for the id level. Therefore, any factorization of id variable would be inefficient. For such cases, it is better to leave this column as character (stringsAsFactors = FALSE) during the data import.</p>
<p>As mentioned previously, a data set is a collection of measurements or records which can be in any class (i.e., logical, character, numeric, factor, etc.). Typically, data sets contain many variables of different length and type of values. In R, we can store data sets using vectors, lists, matrices and data frames. In R, vectors, lists, matrices, arrays and data frames are called “Data Structures”.</p>
<p>According to Wickham (2014), R’s base data structures can be organised by their dimensionality (i.e., one-dimension, two-dimension, or n-dimension) and whether they’re homogeneous (i.e., all contents/variables must be of the same type) or heterogeneous (i.e., the contents/variables can be of different types). Therefore, there are five data structures given in the following table (adapted from Advanced R, Wickham (2014).)</p>
<table>
<thead>
<tr>
<th>Dimension</th>
<th>Homogeneous</th>
<th>Heterogeneous</th>
</tr>
</thead>
<tbody>
<tr>
<td>one-dimension</td>
<td>Atomic vector</td>
<td>List</td>
</tr>
<tr>
<td>two-dimension</td>
<td>Matrix</td>
<td>Data frame</td>
</tr>
<tr>
<td>n-dimension</td>
<td>Array</td>
<td>–</td>
</tr>
</tbody>
</table>
<p>In this section, we won’t cover the multi-dimensional arrays, but we will go into the details of vectors, lists, matrices, and data frames.</p>
<h3 id=vectors>Vectors</h3>
<p>A vector is the basic structure in R, which consists of one-dimensional sequence of data elements of the same basic type (i.e., integer, double, logical, or character). Vectors are created by combining multiple elements into one dimensional array using the c() function. The one-dimensional examples illustrated previously are considered vectors.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## a double numeric vector</span>

<span class=n>dbl_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>4</span><span class=p>,</span> <span class=m>7.5</span><span class=p>,</span> <span class=m>14.5</span><span class=p>)</span>

<span class=c1>## an integer vector</span>

<span class=n>int_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>4L</span><span class=p>,</span> <span class=m>7L</span><span class=p>,</span> <span class=m>14L</span><span class=p>)</span>

<span class=c1>## a logical vector</span>

<span class=n>log_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=bp>T</span><span class=p>,</span> <span class=bp>F</span><span class=p>,</span> <span class=bp>T</span><span class=p>,</span> <span class=bp>T</span><span class=p>)</span>

<span class=c1>## a character vector</span>

<span class=n>char_var</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>All elements of a vector must be the same type, if you attempt to combine different types of elements, they will be coerced to the most flexible type possible. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## vector of characters and numerics will be coerced to a character vector</span>

<span class=n>ex1</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=s>&#34;b&#34;</span><span class=p>,</span> <span class=s>&#34;c&#34;</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>)</span>

<span class=c1>## check the class of ex1</span>

<span class=nf>class</span><span class=p>(</span><span class=n>ex1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;character&#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## vector of numerics and logical will be coerced to a numeric vector</span>

<span class=n>ex2</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>)</span>

<span class=c1>## check the class of ex2</span>

<span class=nf>class</span><span class=p>(</span><span class=n>ex2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;numeric&#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## vector of logical and characters will be coerced to a character vector</span>

<span class=n>ex3</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=s>&#34;b&#34;</span><span class=p>,</span> <span class=s>&#34;c&#34;</span><span class=p>)</span>

<span class=c1>## check the class of ex3</span>

<span class=nf>class</span><span class=p>(</span><span class=n>ex3</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;character&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>In order to add additional elements to a vector we can use c() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## add two elements (4 and 6) to the ex2 vector</span>

<span class=n>ex4</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=n>ex2</span><span class=p>,</span> <span class=m>4</span><span class=p>,</span> <span class=m>6</span><span class=p>)</span>

<span class=n>ex4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1 2 3 1 0 4 6</span>
</code></pre></td></tr></table>
</div>
</div><p>To subset a vector, we can use square brackets [ ] with positive/negative integers, logical values or names. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the third element in ex4 vector</span>

<span class=n>ex4[3]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 3</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the first three elements in ex4 vector</span>

<span class=n>ex4[1</span><span class=o>:</span><span class=m>3</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1 2 3</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the first, third, and fifth element</span>

<span class=n>ex4</span><span class=nf>[c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>3</span><span class=p>,</span><span class=m>5</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1 3 0</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take all elements except first</span>

<span class=n>ex4[</span><span class=m>-1</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 2 3 1 0 4 6</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take all elements less than 3</span>

<span class=n>ex4[</span> <span class=n>ex4</span> <span class=o>&lt;</span> <span class=m>3</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1 2 1 0</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=lists>Lists</h3>
<p>A list is an R structure that allows you to combine elements of different types and lengths. In order to create a list we can use the list() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a list using list() function</span>

<span class=n>list1</span> <span class=o>&lt;-</span> <span class=nf>list</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span> <span class=nf>c</span><span class=p>(</span><span class=m>2.5</span><span class=p>,</span> <span class=m>4.2</span><span class=p>))</span>

<span class=c1>## check the class of list1</span>

<span class=nf>class</span><span class=p>(</span><span class=n>list1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;list&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>To see the detailed structure within an object we can use the structure function str(), which provides a compact display of the internal structure of an R object.</p>
<h3 id=check-the-structure-of-the-list1-object>check the structure of the list1 object</h3>
<p>str(list1)</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>
```console
### List of 4
###  $ : int [1:3] 1 2 3
###  $ : chr &#34;a&#34;
###  $ : logi [1:3] TRUE FALSE TRUE
###  $ : num [1:2] 2.5 4.2
</code></pre></td></tr></table>
</div>
</div><p>Note how each of the four list items above are of different classes (integer, character, logical, and numeric) and different lengths.</p>
<p>In order to add on to lists we can use the append() function. Let’s add a fifth element to the list1 and store it as list2:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## add another list c(&#34;credit&#34;, &#34;debit&#34;, &#34;Paypal&#34;) on list1</span>

<span class=n>list2</span> <span class=o>&lt;-</span> <span class=nf>append</span><span class=p>(</span><span class=n>list1</span><span class=p>,</span> <span class=nf>list</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>)))</span>

<span class=c1>## check the structure of the list2 object</span>

<span class=nf>str</span><span class=p>(</span><span class=n>list2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## List of 5</span>
<span class=gp>#</span><span class=c1>##  $ : int [1:3] 1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ : chr &#34;a&#34;</span>
<span class=gp>#</span><span class=c1>##  $ : logi [1:3] TRUE FALSE TRUE</span>
<span class=gp>#</span><span class=c1>##  $ : num [1:2] 2.5 4.2</span>
<span class=gp>#</span><span class=c1>##  $ : chr [1:3] &#34;credit&#34; &#34;debit&#34; &#34;Paypal&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>R objects can also have attributes, which are like metadata for the object. These metadata can be very useful in that they help to describe the object. Some examples of R object attributes are:</p>
<ul>
<li>names, dimnames</li>
<li>dimensions (e.g. matrices, arrays)</li>
<li>class (e.g. integer, numeric)</li>
<li>length</li>
<li>other user-defined attributes/metadata</li>
</ul>
<p>Attributes of an object (if any) can be accessed using the attributes() function. Let’s check if list2 has any attributes.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>attributes</span><span class=p>(</span><span class=n>list2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## NULL</span>
</code></pre></td></tr></table>
</div>
</div><p>We can add names to lists using names() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## add names to a pre-existing list</span>

<span class=nf>names</span><span class=p>(</span><span class=n>list2</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;item1&#34;</span><span class=p>,</span> <span class=s>&#34;item2&#34;</span><span class=p>,</span> <span class=s>&#34;item3&#34;</span><span class=p>,</span> <span class=s>&#34;item4&#34;</span><span class=p>,</span> <span class=s>&#34;item5&#34;</span><span class=p>)</span>

<span class=nf>str</span><span class=p>(</span><span class=n>list2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## List of 5</span>
<span class=gp>#</span><span class=c1>##  $ item1: int [1:3] 1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ item2: chr &#34;a&#34;</span>
<span class=gp>#</span><span class=c1>##  $ item3: logi [1:3] TRUE FALSE TRUE</span>
<span class=gp>#</span><span class=c1>##  $ item4: num [1:2] 2.5 4.2</span>
<span class=gp>#</span><span class=c1>##  $ item5: chr [1:3] &#34;credit&#34; &#34;debit&#34; &#34;Paypal&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, you can see that each element has a name and the names are displayed after a dollar $ sign.
In order to subset lists, we can use dollar $ sign or square brackets [ ]. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the first list item in list2</span>

<span class=n>list2[1]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $item1</span>
<span class=gp>#</span><span class=c1>## [1] 1 2 3</span>
<span class=gp>#</span><span class=c1># take the first list item in list2 using $</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>list2$item1
</span></code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1 2 3</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the third element out of fifth list item</span>

<span class=n>list2</span><span class=o>$</span><span class=n>item5[3]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;Paypal&#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take multiple list items </span>

<span class=n>list2</span><span class=nf>[c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>3</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $item1</span>
<span class=gp>#</span><span class=c1>## [1] 1 2 3</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $item3</span>
<span class=gp>#</span><span class=c1>## [1]  TRUE FALSE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=matrices>Matrices</h3>
<p>A matrix is a collection of data elements arranged in a two-dimensional rectangular layout. In R, the elements of a matrix must be of same class (i.e. all elements must be numeric, or character, etc.) and all columns of a matrix must be of same length.
We can create a matrix using the matrix() function using nrow and ncol arguments.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a 2x3 numeric matrix</span>

<span class=n>m1</span> <span class=o>&lt;-</span> <span class=nf>matrix</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=p>,</span> <span class=n>nrow</span> <span class=o>=</span> <span class=m>2</span><span class=p>,</span> <span class=n>ncol</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>

<span class=n>m1</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      [,1] [,2] [,3]</span>
<span class=gp>#</span><span class=c1>## [1,]    1    3    5</span>
<span class=gp>#</span><span class=c1>## [2,]    2    4    6</span>
</code></pre></td></tr></table>
</div>
</div><p>The underlying structure of this matrix can be seen using str() and attributes() functions as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>str</span><span class=p>(</span><span class=n>m1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##  int [1:2, 1:3] 1 2 3 4 5 6</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>attributes</span><span class=p>(</span><span class=n>m1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $dim</span>
<span class=gp>#</span><span class=c1>## [1] 2 3</span>
</code></pre></td></tr></table>
</div>
</div><p>Matrices can also be created using the column-bind cbind() and row-bind rbind() functions. However, note that the vectors that are being binded must be of equal length and mode.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create two vectors</span>

<span class=n>v1</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>4</span><span class=p>,</span> <span class=m>5</span><span class=p>)</span>
<span class=n>v2</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>6</span><span class=p>,</span> <span class=m>8</span><span class=p>,</span> <span class=m>10</span><span class=p>)</span>

<span class=c1>## create a matrix using column-bind</span>

<span class=n>m2</span> <span class=o>&lt;-</span> <span class=nf>cbind</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>v2</span><span class=p>)</span>
<span class=n>m2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      v1 v2</span>
<span class=gp>#</span><span class=c1>## [1,]  1  6</span>
<span class=gp>#</span><span class=c1>## [2,]  4  8</span>
<span class=gp>#</span><span class=c1>## [3,]  5 10</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a matrix using row-bind</span>

<span class=n>m3</span> <span class=o>&lt;-</span> <span class=nf>rbind</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>v2</span><span class=p>)</span>
<span class=n>m3</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##    [,1] [,2] [,3]</span>
<span class=gp>#</span><span class=c1>## v1    1    4    5</span>
<span class=gp>#</span><span class=c1>## v2    6    8   10</span>
</code></pre></td></tr></table>
</div>
</div><p>We can also use cbind() and rbind() functions to add onto matrices.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>v3</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>9</span><span class=p>,</span> <span class=m>8</span><span class=p>,</span> <span class=m>7</span><span class=p>)</span>

<span class=n>m4</span> <span class=o>&lt;-</span> <span class=nf>rbind</span><span class=p>(</span><span class=n>m3</span><span class=p>,</span> <span class=n>v3</span><span class=p>)</span>
<span class=n>m4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##    [,1] [,2] [,3]</span>
<span class=gp>#</span><span class=c1>## v1    1    4    5</span>
<span class=gp>#</span><span class=c1>## v2    6    8   10</span>
<span class=gp>#</span><span class=c1>## v3    9    8    7</span>
</code></pre></td></tr></table>
</div>
</div><p>We can add names to the rows and columns of a matrix using rownames and colnames. Let’s add row names as subject1, subject2, and subject3 and column names as var1, var2, and var3 for m4:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## add row names to m4</span>

<span class=nf>rownames</span><span class=p>(</span><span class=n>m4</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;subject1&#34;</span><span class=p>,</span> <span class=s>&#34;subject2&#34;</span><span class=p>,</span> <span class=s>&#34;subject3&#34;</span><span class=p>)</span>

<span class=c1>## add column names to m4</span>

<span class=nf>colnames</span><span class=p>(</span><span class=n>m4</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;var1&#34;</span><span class=p>,</span> <span class=s>&#34;var2&#34;</span><span class=p>,</span> <span class=s>&#34;var3&#34;</span><span class=p>)</span>


<span class=c1>## check attributes</span>

<span class=nf>attributes</span><span class=p>(</span><span class=n>m4</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $dim</span>
<span class=gp>#</span><span class=c1>## [1] 3 3</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $dimnames</span>
<span class=gp>#</span><span class=c1>## $dimnames[[1]]</span>
<span class=gp>#</span><span class=c1>## [1] &#34;subject1&#34; &#34;subject2&#34; &#34;subject3&#34;</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $dimnames[[2]]</span>
<span class=gp>#</span><span class=c1>## [1] &#34;var1&#34; &#34;var2&#34; &#34;var3&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>In order to subset matrices we use the [ operator. As matrices have two dimensions, we need to incorporate subsetting arguments for both row and column dimensions. A generic form of matrix subsetting looks like: matrix [rows, columns].</p>
<p>We can illustrate it using matrix m4:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##          var1 var2 var3</span>
<span class=gp>#</span><span class=c1>## subject1    1    4    5</span>
<span class=gp>#</span><span class=c1>## subject2    6    8   10</span>
<span class=gp>#</span><span class=c1>## subject3    9    8    7</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the value in the first row and second column </span>

<span class=n>m4[1</span><span class=p>,</span><span class=m>2</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset for rows 1 and 2 but keep all columns</span>

<span class=n>m4[1</span><span class=o>:</span><span class=m>2</span><span class=p>,</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##          var1 var2 var3</span>
<span class=gp>#</span><span class=c1>## subject1    1    4    5</span>
<span class=gp>#</span><span class=c1>## subject2    6    8   10</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset for columns 1 and 3 but keep all rows</span>

<span class=n>m4[</span> <span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>3</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##          var1 var3</span>
<span class=gp>#</span><span class=c1>## subject1    1    5</span>
<span class=gp>#</span><span class=c1>## subject2    6   10</span>
<span class=gp>#</span><span class=c1>## subject3    9    7</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset for both rows and columns</span>

<span class=n>m4[1</span><span class=o>:</span><span class=m>2</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>3</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##          var1 var3</span>
<span class=gp>#</span><span class=c1>## subject1    1    5</span>
<span class=gp>#</span><span class=c1>## subject2    6   10</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## use column names to subset</span>

<span class=n>m4[</span> <span class=p>,</span> <span class=s>&#34;var1&#34;</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## subject1 subject2 subject3 </span>
<span class=gp>#</span><span class=c1>##        1        6        9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## use row names to subset</span>

<span class=n>m4[</span><span class=s>&#34;subject1&#34;</span> <span class=p>,</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## var1 var2 var3 </span>
<span class=gp>#</span><span class=c1>##    1    4    5</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=data-frames>Data Frames</h3>
<p>A data frame is the most common way of storing data in R and, generally, is the data structure most often used for data analyses. A data frame is a list of equal-length vectors and they can store different classes of objects in each column (i.e., numeric, character, factor).</p>
<p>Data frames are usually created by importing/reading in a data set using the functions covered in Module 2. However, data frames can also be created explicitly with the data.frame() function or they can be coerced from other types of objects like lists.</p>
<p>In the following example, we will create a simple data frame df1 and assess its basic structure:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##  create a data frame using data.frame()</span>

<span class=n>df1</span> <span class=o>&lt;-</span> <span class=nf>data.frame </span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span>
                  <span class=n>col2</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>),</span>
                  <span class=n>col3</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span>
                  <span class=n>col4</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=m>25.5</span><span class=p>,</span> <span class=m>44.2</span><span class=p>,</span> <span class=m>54.9</span><span class=p>))</span>

<span class=c1>## inspect its structure</span>

<span class=nf>str</span><span class=p>(</span><span class=n>df1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    3 obs. of  4 variables:</span>
<span class=gp>#</span><span class=c1>##  $ col1: int  1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ col2: chr  &#34;credit&#34; &#34;debit&#34; &#34;Paypal&#34;</span>
<span class=gp>#</span><span class=c1>##  $ col3: logi  TRUE FALSE TRUE</span>
<span class=gp>#</span><span class=c1>##  $ col4: num  25.5 44.2 54.9</span>
</code></pre></td></tr></table>
</div>
</div><p>In the example above, col2 is character. If we set stringsAsFactors = TRUE, then this variable will be converted to a column of factors.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## use stringsAsFactors = TRUE</span>

<span class=n>df1</span> <span class=o>&lt;-</span> <span class=nf>data.frame </span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span>
                  <span class=n>col2</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>),</span>
                  <span class=n>col3</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span>
                  <span class=n>col4</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=m>25.5</span><span class=p>,</span> <span class=m>44.2</span><span class=p>,</span> <span class=m>54.9</span><span class=p>),</span>
                  <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=c1>## inspect its structure</span>

<span class=nf>str</span><span class=p>(</span><span class=n>df1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    3 obs. of  4 variables:</span>
<span class=gp>#</span><span class=c1>##  $ col1: int  1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ col2: Factor w/ 3 levels &#34;credit&#34;,&#34;debit&#34;,..: 1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ col3: logi  TRUE FALSE TRUE</span>
<span class=gp>#</span><span class=c1>##  $ col4: num  25.5 44.2 54.9</span>
</code></pre></td></tr></table>
</div>
</div><p>We can add columns (variables) and rows (items) on to a data frame using cbind() and rbind() functions. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a new vector</span>

<span class=n>v4</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;VIC&#34;</span><span class=p>,</span> <span class=s>&#34;NSW&#34;</span><span class=p>,</span> <span class=s>&#34;TAS&#34;</span><span class=p>)</span>

<span class=c1>## add a column (variable) to df1</span>

<span class=n>df2</span> <span class=o>&lt;-</span> <span class=nf>cbind</span><span class=p>(</span><span class=n>df1</span><span class=p>,</span> <span class=n>v4</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Adding attributes to data frames is very similar to what we have done in matrices. We can use rownames() and colnames() functions to add the row and column names, respectively.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## add row names</span>

<span class=nf>rownames</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;subj1&#34;</span><span class=p>,</span> <span class=s>&#34;subj2&#34;</span><span class=p>,</span> <span class=s>&#34;subj3&#34;</span><span class=p>)</span>

<span class=c1>## add column names </span>
<span class=nf>colnames</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;number&#34;</span><span class=p>,</span> <span class=s>&#34;card_type&#34;</span><span class=p>,</span> <span class=s>&#34;fraud&#34;</span><span class=p>,</span> <span class=s>&#34;transaction&#34;</span><span class=p>,</span> <span class=s>&#34;state&#34;</span><span class=p>)</span>

<span class=c1>## check the structure and the attributes</span>

<span class=nf>str</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## &#39;data.frame&#39;:    3 obs. of  5 variables:</span>
<span class=gp>#</span><span class=c1>##  $ number     : int  1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ card_type  : Factor w/ 3 levels &#34;credit&#34;,&#34;debit&#34;,..: 1 2 3</span>
<span class=gp>#</span><span class=c1>##  $ fraud      : logi  TRUE FALSE TRUE</span>
<span class=gp>#</span><span class=c1>##  $ transaction: num  25.5 44.2 54.9</span>
<span class=gp>#</span><span class=c1>##  $ state      : chr  &#34;VIC&#34; &#34;NSW&#34; &#34;TAS&#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>attributes</span><span class=p>(</span><span class=n>df2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $names</span>
<span class=gp>#</span><span class=c1>## [1] &#34;number&#34;      &#34;card_type&#34;   &#34;fraud&#34;       &#34;transaction&#34; &#34;state&#34;      </span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $class</span>
<span class=gp>#</span><span class=c1>## [1] &#34;data.frame&#34;</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $row.names</span>
<span class=gp>#</span><span class=c1>## [1] &#34;subj1&#34; &#34;subj2&#34; &#34;subj3&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Data frames possess the characteristics of both lists and matrices. Therefore, they are subsetted with a single vector, they behave like lists and will return the selected columns with all rows and if you subset with two vectors, they behave like matrices and can be subset by row and column. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>df2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number card_type fraud transaction state</span>
<span class=gp>#</span><span class=c1>## subj1      1    credit  TRUE        25.5   VIC</span>
<span class=gp>#</span><span class=c1>## subj2      2     debit FALSE        44.2   NSW</span>
<span class=gp>#</span><span class=c1>## subj3      3    Paypal  TRUE        54.9   TAS</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset by row numbers, take second and third rows only</span>

<span class=n>df2[2</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number card_type fraud transaction state</span>
<span class=gp>#</span><span class=c1>## subj2      2     debit FALSE        44.2   NSW</span>
<span class=gp>#</span><span class=c1>## subj3      3    Paypal  TRUE        54.9   TAS</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## same as above but uses row names</span>

<span class=n>df2</span><span class=nf>[c</span><span class=p>(</span><span class=s>&#34;subj2&#34;</span><span class=p>,</span> <span class=s>&#34;subj3&#34;</span><span class=p>),</span>  <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number card_type fraud transaction state</span>
<span class=gp>#</span><span class=c1>## subj2      2     debit FALSE        44.2   NSW</span>
<span class=gp>#</span><span class=c1>## subj3      3    Paypal  TRUE        54.9   TAS</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset by column numbers, take first and forth columns only</span>

<span class=n>df2[</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span><span class=m>4</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number transaction</span>
<span class=gp>#</span><span class=c1>## subj1      1        25.5</span>
<span class=gp>#</span><span class=c1>## subj2      2        44.2</span>
<span class=gp>#</span><span class=c1>## subj3      3        54.9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## same as above but uses column names</span>

<span class=n>df2[</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;number&#34;</span><span class=p>,</span> <span class=s>&#34;transaction&#34;</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number transaction</span>
<span class=gp>#</span><span class=c1>## subj1      1        25.5</span>
<span class=gp>#</span><span class=c1>## subj2      2        44.2</span>
<span class=gp>#</span><span class=c1>## subj3      3        54.9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset by row and column numbers</span>

<span class=n>df2[2</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>4</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number transaction</span>
<span class=gp>#</span><span class=c1>## subj2      2        44.2</span>
<span class=gp>#</span><span class=c1>## subj3      3        54.9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## same as above but uses row and column names</span>

<span class=n>df2</span><span class=nf>[c</span><span class=p>(</span><span class=s>&#34;subj2&#34;</span><span class=p>,</span> <span class=s>&#34;subj3&#34;</span><span class=p>),</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;number&#34;</span><span class=p>,</span> <span class=s>&#34;transaction&#34;</span><span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       number transaction</span>
<span class=gp>#</span><span class=c1>## subj2      2        44.2</span>
<span class=gp>#</span><span class=c1>## subj3      3        54.9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset using $: take the column (variable) fraud</span>

<span class=n>df2</span><span class=o>$</span><span class=n>fraud</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  TRUE FALSE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## take the second element in the fraud column</span>

<span class=n>df2</span><span class=o>$</span><span class=n>fraud[2]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=converting-data-typesstructures>Converting Data Types/Structures</h3>
<p>In traditional programming languages, you need to specify the type of data a given variable can contain i.e. either integer, character, string or decimal. In R, this is not necessary. R is smart enough to “guess/create” the data type based on the values provided for a variable. However, R is not that smart (thanks to that! Otherwise why we need analysts!) to guess the correct data type within the context of analysis.</p>
<p>To illustrate this point, let’s import the <a href=https://github.com/yanboyang713/RMIT-Data-Repository/blob/main/banksim.csv target=_blank rel="noopener noreferrer">banksim.csv</a> data set containing the following variables:</p>
<ul>
<li>
<p><strong>id</strong>: Customer ID number</p>
</li>
<li>
<p><strong>age</strong>: Numerical variable</p>
</li>
<li>
<p><strong>marital</strong>: Categorical variable with three levels (married, single, divorced where widowed counted as divorced)</p>
</li>
<li>
<p><strong>education</strong>: Categorical variable with three levels (primary, secondary, tertiary)</p>
</li>
<li>
<p><strong>job</strong>: Categorical variable containing type of jobs</p>
</li>
<li>
<p><strong>balance</strong>: Numerical variable, balance in the bank account</p>
</li>
<li>
<p><strong>day</strong>: Numerical variable, last contacted month of the day</p>
</li>
<li>
<p><strong>month</strong>: Categorical variable, last contacted month</p>
</li>
<li>
<p><strong>duration</strong>: Numerical variable, duration of the contact time</p>
</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>readr</span><span class=p>)</span>
<span class=n>bank</span> <span class=o>&lt;-</span> <span class=nf>read_csv</span><span class=p>(</span><span class=s>&#34;data/banksim.csv&#34;</span><span class=p>)</span>

<span class=nf>str</span><span class=p>(</span><span class=n>bank</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## tibble [15 x 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span>
<span class=gp>#</span><span class=c1>##  $ id       : num [1:15] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class=gp>#</span><span class=c1>##  $ age      : chr [1:15] &#34;44&#34; &#34;88&#34; &#34;36&#34; &#34;25&lt;=&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ marital  : chr [1:15] &#34;married&#34; &#34;married&#34; &#34;divorced&#34; &#34;single&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ education: chr [1:15] &#34;secondary&#34; &#34;secondary&#34; &#34;secondary&#34; &#34;secondary&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ job      : chr [1:15] &#34;blue-collar&#34; &#34;admin.&#34; &#34;blue-collar&#34; &#34;technician&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ balance  : chr [1:15] &#34;16178&#34; &#34;330&#34; &#34;853&#34; &#34;616&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ day      : num [1:15] 21 2 20 28 12 16 15 5 26 14 ...</span>
<span class=gp>#</span><span class=c1>##  $ month    : chr [1:15] &#34;nov&#34; &#34;dec&#34; &#34;jun&#34; &#34;jul&#34; ...</span>
<span class=gp>#</span><span class=c1>##  $ duration : num [1:15] 297 357 15 117 54 -268 129 156 168 216 ...</span>
<span class=gp>#</span><span class=c1>##  - attr(*, &#34;spec&#34;)=</span>
<span class=gp>#</span><span class=c1>##   .. cols(</span>
<span class=gp>#</span><span class=c1>##   ..   id = col_double(),</span>
<span class=gp>#</span><span class=c1>##   ..   age = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   marital = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   education = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   job = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   balance = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   day = col_double(),</span>
<span class=gp>#</span><span class=c1>##   ..   month = col_character(),</span>
<span class=gp>#</span><span class=c1>##   ..   duration = col_double()</span>
<span class=gp>#</span><span class=c1>##   .. )</span>
</code></pre></td></tr></table>
</div>
</div><p>The str() output reveals how R guesses the data types of each variable. Accordingly, id, day and duration are read as numeric values, and the rest are read as characters. However, according to the variable definitions given above, the correct data type for age and balance variables should be numeric (or integer).</p>
<p>Now’s lets investigate the reason for the incorrect data types.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>bank</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## # A tibble: 15 x 9</span>
<span class=gp>#</span><span class=c1>##       id age   marital  education job         balance   day month duration</span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1     1 44    married  secondary blue-collar 16178      21 nov        297</span>
<span class=gp>#</span><span class=c1>##  2     2 88    married  secondary admin.      330         2 dec        357</span>
<span class=gp>#</span><span class=c1>##  3     3 36    divorced secondary blue-collar 853        20 jun         15</span>
<span class=gp>#</span><span class=c1>##  4     4 25&lt;=  single   secondary technician  616        28 jul        117</span>
<span class=gp>#</span><span class=c1>##  5     5 33    single   secondary services    310        12 m           54</span>
<span class=gp>#</span><span class=c1>##  6     6 37    married  tertiary  management  0          16 jul       -268</span>
<span class=gp>#</span><span class=c1>##  7     7 42    married  tertiary  management  1205       15 mar        129</span>
<span class=gp>#</span><span class=c1>##  8     8 43    married  secondary blue-collar 130         5 may        156</span>
<span class=gp>#</span><span class=c1>##  9     9 58    married  primary   u           99999      26 aug        168</span>
<span class=gp>#</span><span class=c1>## 10    10 41    married  secondary admin.      3634       14 may        216</span>
<span class=gp>#</span><span class=c1>## 11    11 0     married  primary   management  92          2 feb        447</span>
<span class=gp>#</span><span class=c1>## 12    12 34    single   secondary services    528D        2 sep        121</span>
<span class=gp>#</span><span class=c1>## 13    13 28    single   secondary admin.      350        19 may          5</span>
<span class=gp>#</span><span class=c1>## 14    14 58    widowed  tertiary  management  136         8 jul        199</span>
<span class=gp>#</span><span class=c1>## 15    15 34    married  unknown   blue-collar 41          6 may         34</span>
</code></pre></td></tr></table>
</div>
</div><p>As seen from the output, row 4 of age column has “&lt;=” and row 12 of balance column is “528D”, therefore these characters forced columns to be read as characters even if they have a numeric nature. <strong>A good practice is always to check the definitions of variables, understand their types within the context, and then to apply proper type conversions if they are not in the correct data type.</strong></p>
<p>Data type and structure conversions can be done easily using as. functions. Essentially, as. functions will convert the object to a given type (whenever possible) and is. functions will test for the given data type and return a logical value (TRUE or FALSE).</p>
<table>
<thead>
<tr>
<th>as. Functions</th>
<th>Changes type to</th>
<th>is. Functions</th>
<th>Checks if the type is</th>
</tr>
</thead>
<tbody>
<tr>
<td>as.numeric()</td>
<td>numeric</td>
<td>is.numeric()</td>
<td>numeric</td>
</tr>
<tr>
<td>as.integer()</td>
<td>integer</td>
<td>is.integer()</td>
<td>integer</td>
</tr>
<tr>
<td>as.double()</td>
<td>double</td>
<td>is.double()</td>
<td>double</td>
</tr>
<tr>
<td>as.character()</td>
<td>character</td>
<td>is.character()</td>
<td>character</td>
</tr>
<tr>
<td>as.factor()</td>
<td>factor</td>
<td>is.factor()</td>
<td>factor</td>
</tr>
<tr>
<td>as.logical()</td>
<td>logical</td>
<td>is.logical()</td>
<td>logical</td>
</tr>
<tr>
<td>as.vector()</td>
<td>vector</td>
<td>is.vector()</td>
<td>vector</td>
</tr>
<tr>
<td>as.list()</td>
<td>list</td>
<td>is.list()</td>
<td>list</td>
</tr>
<tr>
<td>as.matrix()</td>
<td>matrix</td>
<td>is.matrix()</td>
<td>matrix</td>
</tr>
<tr>
<td>as.data.frame()</td>
<td>data frame</td>
<td>is.data.frame()</td>
<td>data frame</td>
</tr>
</tbody>
</table>
<p>Here are some examples on data type conversions:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a numeric vector called num_vec</span>

<span class=n>num_vec</span> <span class=o>&lt;-</span> <span class=nf>as.vector</span><span class=p>(</span><span class=m>8</span><span class=o>:</span><span class=m>17</span><span class=p>)</span>

<span class=c1>## check if it&#39;s a vector</span>

<span class=nf>is.vector</span><span class=p>(</span><span class=n>num_vec</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## convert num_vec into a character</span>

<span class=n>char_vec</span> <span class=o>&lt;-</span><span class=nf>as.character</span><span class=p>(</span><span class=n>num_vec</span><span class=p>)</span> 

<span class=c1>## check if it&#39;s a character</span>

<span class=nf>is.character</span><span class=p>(</span><span class=n>char_vec</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a logical vector</span>

<span class=n>log_vec</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=kc>FALSE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=c1>## convert log_vec into a numeric vector</span>

<span class=n>num_vec2</span> <span class=o>&lt;-</span> <span class=nf>as.numeric</span><span class=p>(</span><span class=n>log_vec</span><span class=p>)</span>

<span class=c1>## check if it&#39;s a numeric vector</span>

<span class=nf>is.numeric</span><span class=p>(</span><span class=n>num_vec2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>The as. functions are also useful to initialize data types. The following example illustrates how you can initialize data using vectors and turn multiple vectors into a data frame:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create different types of vectors</span>

<span class=n>col1</span> <span class=o>&lt;-</span> <span class=m>1</span><span class=o>:</span><span class=m>3</span>
<span class=n>col2</span> <span class=o>&lt;-</span> <span class=nf>c </span><span class=p>(</span><span class=s>&#34;credit&#34;</span><span class=p>,</span> <span class=s>&#34;debit&#34;</span><span class=p>,</span> <span class=s>&#34;Paypal&#34;</span><span class=p>)</span>
<span class=n>col3</span> <span class=o>&lt;-</span> <span class=nf>c </span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>)</span>
<span class=n>col4</span> <span class=o>&lt;-</span> <span class=nf>c </span><span class=p>(</span><span class=m>25.5</span><span class=p>,</span> <span class=m>44.2</span><span class=p>,</span> <span class=m>54.9</span><span class=p>)</span>

<span class=c1>## use cbind to combine vectors by columns </span>

<span class=n>colvec</span> <span class=o>&lt;-</span> <span class=nf>cbind</span><span class=p>(</span><span class=n>col1</span><span class=p>,</span> <span class=n>col2</span><span class=p>,</span> <span class=n>col3</span><span class=p>,</span> <span class=n>col4</span><span class=p>)</span>

<span class=c1>## check its class</span>

<span class=nf>class</span><span class=p>(</span><span class=n>colvec</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] &#34;matrix&#34; &#34;array&#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## convert matrix to a data frame</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>as.data.frame</span><span class=p>(</span><span class=n>colvec</span><span class=p>)</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1   col2  col3 col4</span>
<span class=gp>#</span><span class=c1>## 1    1 credit  TRUE 25.5</span>
<span class=gp>#</span><span class=c1>## 2    2  debit FALSE 44.2</span>
<span class=gp>#</span><span class=c1>## 3    3 Paypal  TRUE 54.9</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=long-vs-wide-format-data>Long vs. wide format data</h3>
<p>A single data set can be rearranged in many ways. One of the ways is called <strong>“long format (a.k.a long layout)”</strong>. In this layout, the data set is arranged in such a way that a single subject’s information is stored in multiple rows.</p>
<p>In the <strong>wide format (a.k.a wide layout)</strong>, a single subject’s information is stored in multiple columns. The main difference between a wide layout and a long layout is that the wide layout contains all the measured information in different columns.</p>
<p>An illustration of the same data set stored in wide vs. long format is given below:</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1615916437/MATH2349/Model3/LongVsWideFormatData_v6babh.png></p>
<p>Fig1. The same data set presented in wide vs. long format</p>
<p>In Module 4, we will see how we can convert a long format to a wide one and vice versa using R.</p>
<h3 id=additional-resources-and-further-reading-1>Additional Resources and Further Reading</h3>
<p>Data Wrangling with R by Boehmke (2016) is a comprehensive source for all data types and structures in R. This book is also one the recommended texts in our course. It is available through RMIT Library.</p>
<p>Base R cheatsheet on <a href=http://github.com/rstudio/cheatsheets/raw/master/base-r.pdf target=_blank rel="noopener noreferrer">http://github.com/rstudio/cheatsheets/raw/master/base-r.pdf</a> is useful for remembering commonly used functions and arguments for data types and structures in R.</p>
<h3 id=references-1>References</h3>
<p>Boehmke, Bradley C. 2016. Data Wrangling with R. Springer.</p>
<p>Wickham, Hadley. 2014. Advanced R. CRC Press.</p>
<h2 id=module-4---tidy-and-manipulate-tidy-data-principles-and-manipulating-data>Module 4 - Tidy and Manipulate: Tidy Data Principles and Manipulating Data</h2>
<h3 id=overview>Overview</h3>
<h4 id=summary-3>Summary</h4>
<p>In this module, I will present Hadley Wickham’s “Tidy Data” principles (Hadley Wickham and others (2014)) and discuss the main benefits of following these principles. We will identify most common problems with messy data sets and explore the powerful tidyr package to tidy messy data sets. Lastly, we will cover the “Grammar of Data Manipulation” - the powerful dplyr package using examples.</p>
<p>In preparation of this section, I heavily used our recommended textbooks (Boehmke (2016) and Wickham and Grolemund (2016)), R Studio’s Data wrangling with R and RStudio webinar, tidyr and dplyr reference manuals (H Wickham (2014), Wickham et al. (2017)).</p>
<h4 id=learning-objectives-3>learning objectives</h4>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Identify and understand the underlying tidy data principles.</li>
<li>Identify common problems with messy data sets.</li>
<li>Learn how to get your data into a tidy form using <strong>tidyr</strong> package tools.</li>
<li>Learn data manipulation tasks (i.e., select, filter, arrange, join, merge) using the powerful <strong>dplyr</strong> package functions.</li>
</ul>
<h3 id=tidy-data-principles>Tidy Data Principles</h3>
<p>“Happy families are all alike; every unhappy family is unhappy in its own way.” —Leo Tolstoy
“Tidy datasets are all alike, but every messy dataset is messy in its own way.” —Hadley Wickham</p>
<p>Hadley Wickham wrote a stellar article called “Tidy Data” in Journal of Statistical Software to provide a standard way to organise data values within a dataset. In his paper, Wickham developed the framework of “Tidy Data Principles” to provide a standard and consistent way of storing data that makes transformation, visualization, and modelling easier. Along with the tidy data principles, he also developed the tidyr package, which provides a bunch of tools to help tidy up the messy data sets.</p>
<p>In this section, I will give you a practical introduction to tidy data and the accompanying tools in the tidyr package. If you’d like to learn more about the underlying theory, you might enjoy the Tidy Data paper published in the Journal of Statistical Software.</p>
<p>Once you’ve imported and understand the structure of your data, it is a good idea to tidy it. Tidying your data means storing it in a consistent form that matches the semantics of the data set with the way it is stored.</p>
<p>In brief, there are three interrelated rules which make a dataset tidy (Wickham and Grolemund (2016)). In tidy data:</p>
<ul>
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ul>
<p>The following illustration taken from Wickham and Grolemund (2016) shows these three rules visually:</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617030207/MATH2349/Model4/TidyDataPrinciples_v7sese.png></p>
<p>Fig1. Tidy data rules: variables are in columns, observations are in rows, and values are in cells (taken from Wickham and Grolemund (2016))</p>
<p>To demonstrate these rules, we will use a simple data set:</p>
<table>
<thead>
<tr>
<th>Student Name</th>
<th>Math</th>
<th>English</th>
</tr>
</thead>
<tbody>
<tr>
<td>Anna</td>
<td>86</td>
<td>90</td>
</tr>
<tr>
<td>John</td>
<td>43</td>
<td>75</td>
</tr>
<tr>
<td>Catherine</td>
<td>80</td>
<td>82</td>
</tr>
</tbody>
</table>
<p>In this simple data, there are in fact three variables illustrated in the following table:</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036542/MATH2349/Model4/exampleOne_isnnmf.png></p>
<p>First variable is “Student Name”, the second is “Subject” that represents whether the subject is Maths or English, and the third one is the “Grade” information inside the data matrix.</p>
<p>When we arrange each variable in columns and each student in a row then we will get the tidy version of the same data as follows:</p>
<table>
<thead>
<tr>
<th>No</th>
<th>Student Name</th>
<th>Subject</th>
<th>Grade</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Anna</td>
<td>Math</td>
<td>86</td>
</tr>
<tr>
<td>2</td>
<td>John</td>
<td>Math</td>
<td>43</td>
</tr>
<tr>
<td>3</td>
<td>Catherine</td>
<td>Math</td>
<td>80</td>
</tr>
<tr>
<td>4</td>
<td>Anna</td>
<td>English</td>
<td>90</td>
</tr>
<tr>
<td>5</td>
<td>John</td>
<td>English</td>
<td>75</td>
</tr>
<tr>
<td>6</td>
<td>Catherine</td>
<td>English</td>
<td>82</td>
</tr>
</tbody>
</table>
<p>You can see that in this format, each variable forms a column and each student forms a row:</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617036908/MATH2349/Model4/exampleTwo_kjyuwl.png></p>
<p><strong>The main advantage of using tidy principles</strong> is it allows R’s vectorized nature to shine. One can extract variables in a simple, standard way. Have a look at the following illustration. Which would you rather work with?</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037139/MATH2349/Model4/exampleThree_ktt50a.png></p>
<p>Tidy data is important because the consistent structure lets you focus on questions about the data, not fighting to get the data into the right form for different functions.</p>
<h3 id=common-problems-with-messy-data-sets>Common problems with messy data sets</h3>
<p>Real data sets can, and often do, violate the three principles of tidy data. This section describes most common problems with messy datasets:</p>
<ul>
<li>Column headers are values, not variable names: A common problem is a dataset where some (or all) of the column names are not names of variables, but values of a variable. Here is an illustration of this problem:</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png></p>
<p>In the example above, the column names 2011, 2012, and 2013 represent values of the year variable, and each row represents three observations, not one.</p>
<ul>
<li>Multiple variables are stored in rows: The opposite of the first problem can also occur when the variables are stored in rows. In such cases, cells include the actual variables, not the observations. Here is an example:</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png></p>
<ul>
<li>Multiple variables are stored in one column: Sometimes, one column stores the information of two or more variables. Therefore, multiple variables can be extracted from one column. Here is an illustration of this problem:</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png></p>
<p>In the example above, date variable actually stores three new variable information, namely; year, month, and day.</p>
<ul>
<li>Multiple columns forms a variable: You may need to combine multiple columns into a single column to form a new variable. Here is an illustration of this problem:</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png></p>
<p>In this example, the year, month, and day variables are given separately in the original data but assume that we need to combine these three columns into a single variable called date for the time series analysis.</p>
<h3 id=the-tidyr-package>The tidyr package</h3>
<p>Most messy datasets can be tidied with a small set of tools. The tidyr package is a very useful package that reshapes the layout of data sets. In the next section you will be introduced the tidyr package and its functions with examples.</p>
<p>We will use the subset of the data contained in the World Health Organization Global Tuberculosis Report (also given in tidyr package documentation) to illustrate the functions in the tidyr package. Before loading this dataset, we need to install and load the package using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## install the tidyr package</span>

<span class=c1>##install.packages(&#34;tidyr&#34;)</span>

<span class=c1>## load the tidyr package</span>

<span class=nf>library</span><span class=p>(</span><span class=n>tidyr</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>The following example shows the same data organized in four different ways (table1, table2, table3, table4a, table4b). Each dataset shows the same values of four variables, country, year, population, and cases, but each dataset organizes the values in a different way as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># load the example data organized in four different ways</span>
<span class=err>
</span><span class=err></span><span class=go>table1
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 4</span>
<span class=gp>#</span><span class=c1>##   country      year  cases population</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999    745   19987071</span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000   2666   20595360</span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999  37737  172006362</span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000  80488  174504898</span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258 1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table2
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 12 x 4</span>
<span class=gp>#</span><span class=c1>##    country      year type            count</span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1 Afghanistan  1999 cases             745</span>
<span class=gp>#</span><span class=c1>##  2 Afghanistan  1999 population   19987071</span>
<span class=gp>#</span><span class=c1>##  3 Afghanistan  2000 cases            2666</span>
<span class=gp>#</span><span class=c1>##  4 Afghanistan  2000 population   20595360</span>
<span class=gp>#</span><span class=c1>##  5 Brazil       1999 cases           37737</span>
<span class=gp>#</span><span class=c1>##  6 Brazil       1999 population  172006362</span>
<span class=gp>#</span><span class=c1>##  7 Brazil       2000 cases           80488</span>
<span class=gp>#</span><span class=c1>##  8 Brazil       2000 population  174504898</span>
<span class=gp>#</span><span class=c1>##  9 China        1999 cases          212258</span>
<span class=gp>#</span><span class=c1>## 10 China        1999 population 1272915272</span>
<span class=gp>#</span><span class=c1>## 11 China        2000 cases          213766</span>
<span class=gp>#</span><span class=c1>## 12 China        2000 population 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table3
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country      year rate             </span>
<span class=gp>#</span><span class=c1>## * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999 745/19987071     </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000 2666/20595360    </span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999 37737/172006362  </span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000 80488/174504898  </span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258/1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766/1280428583</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table4a
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 3 x 3</span>
<span class=gp>#</span><span class=c1>##   country     `1999` `2000`</span>
<span class=gp>#</span><span class=c1>## * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan    745   2666</span>
<span class=gp>#</span><span class=c1>## 2 Brazil       37737  80488</span>
<span class=gp>#</span><span class=c1>## 3 China       212258 213766</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table4b
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 3 x 3</span>
<span class=gp>#</span><span class=c1>##   country         `1999`     `2000`</span>
<span class=gp>#</span><span class=c1>## * &lt;chr&gt;            &lt;int&gt;      &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan   19987071   20595360</span>
<span class=gp>#</span><span class=c1>## 2 Brazil       172006362  174504898</span>
<span class=gp>#</span><span class=c1>## 3 China       1272915272 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=pivot_longer-function>pivot_longer() function</h4>
<p>The function pivot_longer() is an updated approach to gather() function. When column names are values instead of variables, we need to gather or in other words, we need to transform data from wide to long format.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617038509/MATH2349/Model4/pivot_longer_co6mqf.png></p>
<p>Fig2. gather() – tidyr by RStudio</p>
<p>To illustrate gather() function, let’s have a look at the data given in table4a:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table4a
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 3 x 3</span>
<span class=gp>#</span><span class=c1>##   country     `1999` `2000`</span>
<span class=gp>#</span><span class=c1>## * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan    745   2666</span>
<span class=gp>#</span><span class=c1>## 2 Brazil       37737  80488</span>
<span class=gp>#</span><span class=c1>## 3 China       212258 213766</span>
</code></pre></td></tr></table>
</div>
</div><p>To tidy a dataset like this, we need to gather those columns into a new pair of variables using gather() function. To describe that operation, we need three parameters:</p>
<ul>
<li>The set of columns that represent values, not variables. In this example, those are the columns 1999 and 2000.</li>
<li>The name of the variable whose values form the column names. The argument name key stands for that variable. For this example, the key argument is year.</li>
<li>The name of the variable whose values are spread over the cells. The argument name value stands for that, in this example value argument is the number of cases.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table4a %&gt;% gather(`1999`, `2000`, key = &#34;year&#34;, value = &#34;cases&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country     year   cases</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan 1999     745</span>
<span class=gp>#</span><span class=c1>## 2 Brazil      1999   37737</span>
<span class=gp>#</span><span class=c1>## 3 China       1999  212258</span>
<span class=gp>#</span><span class=c1>## 4 Afghanistan 2000    2666</span>
<span class=gp>#</span><span class=c1>## 5 Brazil      2000   80488</span>
<span class=gp>#</span><span class=c1>## 6 China       2000  213766</span>
</code></pre></td></tr></table>
</div>
</div><p>OR using the pivot_longer function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table4a %&gt;% pivot_longer(names_to = &#34;year&#34;, values_to = &#34;cases&#34;, cols = 2:3)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country     year   cases</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan 1999     745</span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan 2000    2666</span>
<span class=gp>#</span><span class=c1>## 3 Brazil      1999   37737</span>
<span class=gp>#</span><span class=c1>## 4 Brazil      2000   80488</span>
<span class=gp>#</span><span class=c1>## 5 China       1999  212258</span>
<span class=gp>#</span><span class=c1>## 6 China       2000  213766</span>
</code></pre></td></tr></table>
</div>
</div><p>Here, the arguments names_to is a string specifying the name of the column to create from the data stored in the column names of data, values_to is a string specifying the name of the column to create from the data stored in cell values, and cols refers to those columns that should be pivot into longer format.</p>
<p><strong>Note</strong> that in the R code below, I used the pipe (%>%) operator to take the data first, then use the gather function. The tidyr package functions can also be used along with the pipe operator %>% which is developed by Stefan Milton Bache in the R package magrittr. Remember that the functions in tidyr can be used without the pipe operator. For more information on the pipe operator, its pros and cons please refer to Dr. James Baglin’s R Bootcamp Course 1.</p>
<h4 id=pivot_wider-function>pivot_wider() function</h4>
<p>The function pivot_wider() is an updated approach to spread() function. When multiple variables are stored in rows, the spread() function generates columns from rows. In other words, it transforms data from long to wide format. The spread() function is the opposite of gather() function.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617039276/MATH2349/Model4/pivot_wider_ehwiow.png></p>
<p>Let’s look at table2 and assume that we are required to turn long formatted data into wide formatted data by generating columns from cases.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table2
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 12 x 4</span>
<span class=gp>#</span><span class=c1>##    country      year type            count</span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1 Afghanistan  1999 cases             745</span>
<span class=gp>#</span><span class=c1>##  2 Afghanistan  1999 population   19987071</span>
<span class=gp>#</span><span class=c1>##  3 Afghanistan  2000 cases            2666</span>
<span class=gp>#</span><span class=c1>##  4 Afghanistan  2000 population   20595360</span>
<span class=gp>#</span><span class=c1>##  5 Brazil       1999 cases           37737</span>
<span class=gp>#</span><span class=c1>##  6 Brazil       1999 population  172006362</span>
<span class=gp>#</span><span class=c1>##  7 Brazil       2000 cases           80488</span>
<span class=gp>#</span><span class=c1>##  8 Brazil       2000 population  174504898</span>
<span class=gp>#</span><span class=c1>##  9 China        1999 cases          212258</span>
<span class=gp>#</span><span class=c1>## 10 China        1999 population 1272915272</span>
<span class=gp>#</span><span class=c1>## 11 China        2000 cases          213766</span>
<span class=gp>#</span><span class=c1>## 12 China        2000 population 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>To tidy this up, we first analyse the representation in a similar way to gather(). This time, however, we only need two parameters:</p>
<ul>
<li>The column that contains variable names, the key column. Here, it’s type.</li>
<li>The column that contains values forms multiple variables, the value column. Here, it’s count.</li>
</ul>
<p>Once we’ve figured that out, we can use spread():</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>spread(table2, key = &#34;type&#34;, value = &#34;count&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 4</span>
<span class=gp>#</span><span class=c1>##   country      year  cases population</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999    745   19987071</span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000   2666   20595360</span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999  37737  172006362</span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000  80488  174504898</span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258 1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>OR equivalently, we have the following using the function pivot_wider() with the arguments names_from and values_from:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>pivot_wider(table2, names_from = &#34;type&#34;, values_from = &#34;count&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 4</span>
<span class=gp>#</span><span class=c1>##   country      year  cases population</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999    745   19987071</span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000   2666   20595360</span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999  37737  172006362</span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000  80488  174504898</span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258 1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, cases and population are separate variables given in columns, therefore, generating a new variable from these two variables is super easy! Let’s calculate the Tuberculosis rate (rate = cases/population) using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>rate = spread(table2, key = type, value = count)$cases / spread(table2, key = type, value = count)$population
</span><span class=go></span><span class=err>
</span><span class=err></span><span class=go>rate
</span><span class=go></span><span class=gp>#</span><span class=c1>## [1] 0.0000372741 0.0001294466 0.0002193930 0.0004612363 0.0001667495</span>
<span class=gp>#</span><span class=c1>## [6] 0.0001669488</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=separate-function>separate() function</h4>
<p>The separate() and extract() functions both can be used when multiple variables are stored in one column and you want to split them according to the separator character. Take table3 for example:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table3
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country      year rate             </span>
<span class=gp>#</span><span class=c1>## * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999 745/19987071     </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000 2666/20595360    </span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999 37737/172006362  </span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000 80488/174504898  </span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258/1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766/1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>The rate column contains both cases and population variables, and we need to split it into two variables.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table3 %&gt;% separate(rate, into = c(&#34;cases&#34;, &#34;population&#34;), sep = &#34;/&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 4</span>
<span class=gp>#</span><span class=c1>##   country      year cases  population</span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan  1999 745    19987071  </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan  2000 2666   20595360  </span>
<span class=gp>#</span><span class=c1>## 3 Brazil       1999 37737  172006362 </span>
<span class=gp>#</span><span class=c1>## 4 Brazil       2000 80488  174504898 </span>
<span class=gp>#</span><span class=c1>## 5 China        1999 212258 1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China        2000 213766 1280428583</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=unite-function>unite() function</h4>
<p>unite() is the inverse of separate() function. One can use it to combine multiple columns into a single column.
Now let’s look at this data:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table5
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 4</span>
<span class=gp>#</span><span class=c1>##   country     century year  rate             </span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan 19      99    745/19987071     </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan 20      00    2666/20595360    </span>
<span class=gp>#</span><span class=c1>## 3 Brazil      19      99    37737/172006362  </span>
<span class=gp>#</span><span class=c1>## 4 Brazil      20      00    80488/174504898  </span>
<span class=gp>#</span><span class=c1>## 5 China       19      99    212258/1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China       20      00    213766/1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>In this data, assume that we want to combine the century and year variables into one variable called new_year. We can use unite() for this purpose:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table5 %&gt;% unite(new_year, century, year)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country     new_year rate             </span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;            </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan 19_99    745/19987071     </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan 20_00    2666/20595360    </span>
<span class=gp>#</span><span class=c1>## 3 Brazil      19_99    37737/172006362  </span>
<span class=gp>#</span><span class=c1>## 4 Brazil      20_00    80488/174504898  </span>
<span class=gp>#</span><span class=c1>## 5 China       19_99    212258/1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China       20_00    213766/1280428583</span>
</code></pre></td></tr></table>
</div>
</div><p>In this case we also need to use the sep argument. The default will place an underscore (_) between the values from different columns. Here we don’t want any separator, so we use sep="" as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>table5 %&gt;% unite(new_year, century, year, sep=&#34;&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 6 x 3</span>
<span class=gp>#</span><span class=c1>##   country     new_year rate             </span>
<span class=gp>#</span><span class=c1>##   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;            </span>
<span class=gp>#</span><span class=c1>## 1 Afghanistan 1999     745/19987071     </span>
<span class=gp>#</span><span class=c1>## 2 Afghanistan 2000     2666/20595360    </span>
<span class=gp>#</span><span class=c1>## 3 Brazil      1999     37737/172006362  </span>
<span class=gp>#</span><span class=c1>## 4 Brazil      2000     80488/174504898  </span>
<span class=gp>#</span><span class=c1>## 5 China       1999     212258/1272915272</span>
<span class=gp>#</span><span class=c1>## 6 China       2000     213766/1280428583</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=the-dplyr-package>The dplyr package</h3>
<p>Although there are many data manipulation packages/functions in R, most of them lack consistent coding and the ability to easily flow together. This leads to difficult-to-read nested functions and/or choppy code. Hadley Wickham developed the very popular dplyr package to make these data processing tasks more efficient along with a syntax that is consistent and easier to remember and read.</p>
<p>The dplyr package is regarded as the “Grammar of Data Manipulation” in R and it originates from the popular plyr package, also developed by Hadley Wickham. The plyr package covers data manipulation for a range of data structures (i.e., data frames, lists, arrays) whereas dplyr is focused on data frames. In this section, I will focus on dplyr. We will cover primary functions inside dplyr for data manipulation. The full list of capabilities can be found in the dplyr reference manual. I highly recommend going through it as there are many great functions provided by dplyr that I will not cover here.</p>
<p>I will use the nycflights13 package and the data sets to explore the basic data manipulation verbs of dplyr. First, we need to install and load the dplyr and nycflights13 packages using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## install the dplyr package</span>

<span class=c1>##install.packages(&#34;dplyr&#34;)</span>

<span class=c1>## load the dplyr package</span>

<span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## install the nycflights13 package for the data set</span>

<span class=c1>##install.packages(&#34;nycflights13&#34;)</span>

<span class=c1>## load the nycflights13 package</span>

<span class=nf>library</span><span class=p>(</span><span class=n>nycflights13</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>The nycflights13 package includes five data frames containing information on airlines, airports, flights, weather, and planes that departed from New York City in 2013. The data comes from the US Bureau of Transportation Statistics. Let’s look at the nycflights13::flights data set:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># View the flights data set under the nycflights13 package</span>
<span class=err>
</span><span class=err></span><span class=go>nycflights13::flights
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 19</span>
<span class=gp>#</span><span class=c1>##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1      517            515         2      830            819</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1      533            529         4      850            830</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1      542            540         2      923            850</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1      544            545        -1     1004           1022</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1      554            600        -6      812            837</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1      554            558        -4      740            728</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1      555            600        -5      913            854</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1      557            600        -3      709            723</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1      557            600        -3      838            846</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1      558            600        -2      753            745</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>You might notice that this data frame prints differently from other data frames you might have used in the past: it only shows the first few rows and all the columns that fit on one screen. It prints differently because it’s a tibble. Tibbles are a modern take on data frames. They are slightly tweaked to work better with tidyr and dplyr (and many others). For now, you don’t need to worry about the differences (you may refer to here to learn more on tibbles.</p>
<h4 id=select-function>select() function</h4>
<p>When working with a large data frame, often we want to only assess specific variables. The select() function allows us to select and/or rename variables.</p>
<p>In addition to the existing functions like : and c(), there are a number of special functions that can work inside select. Some of them are given in the following table.</p>
<table>
<thead>
<tr>
<th>Functions</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>Select everything but</td>
</tr>
<tr>
<td>:</td>
<td>Select range</td>
</tr>
<tr>
<td>contains()</td>
<td>Select columns whose name contains a character string</td>
</tr>
<tr>
<td>ends_with()</td>
<td>Select columns whose name ends with a string</td>
</tr>
<tr>
<td>everything()</td>
<td>Select every column</td>
</tr>
<tr>
<td>matches()</td>
<td>Select columns whose name matches a regular expression</td>
</tr>
<tr>
<td>num_range()</td>
<td>Select columns named x1, x2, x3, x4, x5</td>
</tr>
<tr>
<td>one_of()</td>
<td>Select columns whose names are in a group of names</td>
</tr>
<tr>
<td>starts_with()</td>
<td>Select columns whose name starts with a character string</td>
</tr>
</tbody>
</table>
<p>To illustrate we will use the flights data. Let’s select year, month and day columns using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Select columns: year, month and day</span>
<span class=err>
</span><span class=err></span><span class=go>select(flights, year, month, day)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 3</span>
<span class=gp>#</span><span class=c1>##     year month   day</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p>Like tidyr, dplyr can also work with the %>% operator. Therefore, we can use the following code to do the same selection:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Select columns by name using the pipe operator</span>

<span class=n>flights</span> <span class=o>%&gt;%</span>  <span class=nf>select</span><span class=p>(</span><span class=n>year</span><span class=p>,</span> <span class=n>month</span><span class=p>,</span> <span class=n>day</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Here are other examples of using select():</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Select all columns between year and day (inclusive)</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% select(year:day)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 3</span>
<span class=gp>#</span><span class=c1>##     year month   day</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Select all columns except those from year to day (inclusive)</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% select( -(year:day) )
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 16</span>
<span class=gp>#</span><span class=c1>##    dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier</span>
<span class=gp>#</span><span class=c1>##       &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>##  1      517            515         2      830            819        11 UA     </span>
<span class=gp>#</span><span class=c1>##  2      533            529         4      850            830        20 UA     </span>
<span class=gp>#</span><span class=c1>##  3      542            540         2      923            850        33 AA     </span>
<span class=gp>#</span><span class=c1>##  4      544            545        -1     1004           1022       -18 B6     </span>
<span class=gp>#</span><span class=c1>##  5      554            600        -6      812            837       -25 DL     </span>
<span class=gp>#</span><span class=c1>##  6      554            558        -4      740            728        12 UA     </span>
<span class=gp>#</span><span class=c1>##  7      555            600        -5      913            854        19 B6     </span>
<span class=gp>#</span><span class=c1>##  8      557            600        -3      709            723       -14 EV     </span>
<span class=gp>#</span><span class=c1>##  9      557            600        -3      838            846        -8 B6     </span>
<span class=gp>#</span><span class=c1>## 10      558            600        -2      753            745         8 AA     </span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 9 more variables: flight &lt;int&gt;,</span>
<span class=gp>#</span><span class=c1>## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>For more information on available functions in select, type ?select.</p>
<h4 id=filter-function>filter() function</h4>
<p>The filter() function allows us to identify or select observations in which a particular variable matches a specific value/condition. The condition in the filter() function can be any kind of logical comparison and Boolean operators, such as:</p>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;</td>
<td>Less than</td>
</tr>
<tr>
<td>></td>
<td>Greater than</td>
</tr>
<tr>
<td>==</td>
<td>Equal to</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Less than or equal to</td>
</tr>
<tr>
<td>>=</td>
<td>Greater than or equal to</td>
</tr>
<tr>
<td>!=</td>
<td>Not equal to</td>
</tr>
<tr>
<td>%in%</td>
<td>Group membership</td>
</tr>
<tr>
<td>is.na</td>
<td>Is NA</td>
</tr>
<tr>
<td>!is.na</td>
<td>Is not NA</td>
</tr>
<tr>
<td>&</td>
<td>Boolean and</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>xor</td>
<td>exactly or</td>
</tr>
<tr>
<td>!</td>
<td>not</td>
</tr>
<tr>
<td>any</td>
<td>any true</td>
</tr>
<tr>
<td>all</td>
<td>all true</td>
</tr>
</tbody>
</table>
<p>For example, we can select all flights on January 1st using the following:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Filter the flights on January 1st</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;%  filter( month == 1, day == 1)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 842 x 19</span>
<span class=gp>#</span><span class=c1>##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1      517            515         2      830            819</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1      533            529         4      850            830</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1      542            540         2      923            850</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1      544            545        -1     1004           1022</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1      554            600        -6      812            837</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1      554            558        -4      740            728</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1      555            600        -5      913            854</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1      557            600        -3      709            723</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1      557            600        -3      838            846</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1      558            600        -2      753            745</span>
<span class=gp>#</span><span class=c1>## # ... with 832 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>When you run that line of code, dplyr executes the filtering operation and returns a new data frame. dplyr functions never modify their inputs, so if you want to save the result, you’ll need to use the assignment operator, &lt;-:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Filter the flights on January 1st and save this result </span>

<span class=n>jan1</span> <span class=o>&lt;-</span> <span class=n>flights</span> <span class=o>%&gt;%</span>  <span class=nf>filter</span><span class=p>(</span> <span class=n>month</span> <span class=o>==</span> <span class=m>1</span><span class=p>,</span> <span class=n>day</span> <span class=o>==</span> <span class=m>1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>The following code finds all flights that departed in November or December:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Filter the flights departing in November or December</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=n>flights</span> <span class=o>%&gt;%</span>  <span class=nf>filter</span><span class=p>(</span> <span class=n>month</span> <span class=o>==</span> <span class=m>11</span> <span class=o>|</span> <span class=n>month</span> <span class=o>==</span> <span class=m>12</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>If we want to find flights that aren’t delayed (on arrival or departure) by more than two hours, we can use either of the following two filters:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Filter the flights that aren&#39;t delayed (on arrival or departure) by more than two hours</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% filter( arr_delay &lt;= 120, dep_delay &lt;= 120 )
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 316,050 x 19</span>
<span class=gp>#</span><span class=c1>##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1      517            515         2      830            819</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1      533            529         4      850            830</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1      542            540         2      923            850</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1      544            545        -1     1004           1022</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1      554            600        -6      812            837</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1      554            558        -4      740            728</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1      555            600        -5      913            854</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1      557            600        -3      709            723</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1      557            600        -3      838            846</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1      558            600        -2      753            745</span>
<span class=gp>#</span><span class=c1>## # ... with 316,040 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## gives the same result as above</span>

<span class=n>flights</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span> <span class=o>!</span> <span class=p>(</span><span class=n>arr_delay</span> <span class=o>&gt;</span> <span class=m>120</span> <span class=o>|</span> <span class=n>dep_delay</span> <span class=o>&gt;</span> <span class=m>120</span><span class=p>)</span> <span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>For more information on available functions in filter, type ?filter.</p>
<h4 id=arrange-function>arrange() function</h4>
<p>The arrange() function allows us to order data by variables in ascending or descending order.
Let’s order the flights data in an ascending order using year, month and day.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Order the data set according to three variables</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% arrange( year, month, day )
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 19</span>
<span class=gp>#</span><span class=c1>##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1      517            515         2      830            819</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1      533            529         4      850            830</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1      542            540         2      923            850</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1      544            545        -1     1004           1022</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1      554            600        -6      812            837</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1      554            558        -4      740            728</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1      555            600        -5      913            854</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1      557            600        -3      709            723</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1      557            600        -3      838            846</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1      558            600        -2      753            745</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>We can also apply a descending argument to rank-order from highest to lowest. The following shows the same data but in descending order by applying desc() within the arrange() function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Order the data set according to departure time in a descending order</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% arrange( desc(dep_time) )
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 19</span>
<span class=gp>#</span><span class=c1>##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013    10    30     2400           2359         1      327            337</span>
<span class=gp>#</span><span class=c1>##  2  2013    11    27     2400           2359         1      515            445</span>
<span class=gp>#</span><span class=c1>##  3  2013    12     5     2400           2359         1      427            440</span>
<span class=gp>#</span><span class=c1>##  4  2013    12     9     2400           2359         1      432            440</span>
<span class=gp>#</span><span class=c1>##  5  2013    12     9     2400           2250        70       59           2356</span>
<span class=gp>#</span><span class=c1>##  6  2013    12    13     2400           2359         1      432            440</span>
<span class=gp>#</span><span class=c1>##  7  2013    12    19     2400           2359         1      434            440</span>
<span class=gp>#</span><span class=c1>##  8  2013    12    29     2400           1700       420      302           2025</span>
<span class=gp>#</span><span class=c1>##  9  2013     2     7     2400           2359         1      432            436</span>
<span class=gp>#</span><span class=c1>## 10  2013     2     7     2400           2359         1      443            444</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that the missing values will always be sorted at the end.</p>
<h4 id=mutate-function>mutate() function</h4>
<p>The mutate() function allows us to add new variables while preserving the existing variables. Here is the list of some useful functions used inside the mutate().</p>
<table>
<thead>
<tr>
<th>Functions</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>pmin(), pmax()</td>
<td>Element wise min and max</td>
</tr>
<tr>
<td>cummin(), cummax()</td>
<td>Cumulative min and max</td>
</tr>
<tr>
<td>cumsum(), cumprod()</td>
<td>Cumulative sum and product</td>
</tr>
<tr>
<td>between()</td>
<td>Are values between a and b?</td>
</tr>
<tr>
<td>cume_dist()</td>
<td>Cumulative distribution of values</td>
</tr>
<tr>
<td>cumall(), cumany()</td>
<td>Cumulative all and any</td>
</tr>
<tr>
<td>cummean()</td>
<td>Cumulative mean</td>
</tr>
<tr>
<td>lead(), lag()</td>
<td>Copy with values one position</td>
</tr>
<tr>
<td>ntile()</td>
<td>Bin vector into n buckets</td>
</tr>
<tr>
<td>dense_rank(), min_rank(), percent_rank(), row_number()</td>
<td>Various ranking methods</td>
</tr>
</tbody>
</table>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Select specific variables from the data and store them in a new data frame</span>
<span class=err>
</span><span class=err></span><span class=go>flights_sub&lt;- flights %&gt;% select(arr_delay, dep_delay, air_time)
</span><span class=go></span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># Create new variables &#34;gain&#34;, &#34;hours&#34;, and &#34;gain_per_hour&#34;</span>
<span class=err>
</span><span class=err></span><span class=go>mutate(flights_sub, gain = arr_delay - dep_delay, hours = air_time / 60, gain_per_hour = gain / hours)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 6</span>
<span class=gp>#</span><span class=c1>##    arr_delay dep_delay air_time  gain hours gain_per_hour</span>
<span class=gp>#</span><span class=c1>##        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1        11         2      227     9 3.78           2.38</span>
<span class=gp>#</span><span class=c1>##  2        20         4      227    16 3.78           4.23</span>
<span class=gp>#</span><span class=c1>##  3        33         2      160    31 2.67          11.6 </span>
<span class=gp>#</span><span class=c1>##  4       -18        -1      183   -17 3.05          -5.57</span>
<span class=gp>#</span><span class=c1>##  5       -25        -6      116   -19 1.93          -9.83</span>
<span class=gp>#</span><span class=c1>##  6        12        -4      150    16 2.5            6.4 </span>
<span class=gp>#</span><span class=c1>##  7        19        -5      158    24 2.63           9.11</span>
<span class=gp>#</span><span class=c1>##  8       -14        -3       53   -11 0.883        -12.5 </span>
<span class=gp>#</span><span class=c1>##  9        -8        -3      140    -5 2.33          -2.14</span>
<span class=gp>#</span><span class=c1>## 10         8        -2      138    10 2.3            4.35</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that the new variables will appear at the end of the flights data frame.
An alternative to mutate() is transmute() which creates a new variable and then drops the other variables. Essentially, it allows you to create a new data frame with only the new variables created.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>transmute(flights, gain = arr_delay - dep_delay, hours = air_time / 60, gain_per_hour = gain / hours)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 3</span>
<span class=gp>#</span><span class=c1>##     gain hours gain_per_hour</span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1     9 3.78           2.38</span>
<span class=gp>#</span><span class=c1>##  2    16 3.78           4.23</span>
<span class=gp>#</span><span class=c1>##  3    31 2.67          11.6 </span>
<span class=gp>#</span><span class=c1>##  4   -17 3.05          -5.57</span>
<span class=gp>#</span><span class=c1>##  5   -19 1.93          -9.83</span>
<span class=gp>#</span><span class=c1>##  6    16 2.5            6.4 </span>
<span class=gp>#</span><span class=c1>##  7    24 2.63           9.11</span>
<span class=gp>#</span><span class=c1>##  8   -11 0.883        -12.5 </span>
<span class=gp>#</span><span class=c1>##  9    -5 2.33          -2.14</span>
<span class=gp>#</span><span class=c1>## 10    10 2.3            4.35</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=summarise-or-summarize--function>summarise() (or summarize() ) function</h4>
<p>The summarise() (a.k.a. summarize() ) function allows us to perform the majority of summary statistics when performing exploratory data analysis. Here is the list of some useful functions that can be used inside summary().</p>
<table>
<thead>
<tr>
<th>Functions</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>min(), max()</td>
<td>Minimum and maximum values</td>
</tr>
<tr>
<td>mean()</td>
<td>Mean value</td>
</tr>
<tr>
<td>median()</td>
<td>Median value</td>
</tr>
<tr>
<td>sum()</td>
<td>Sum of values</td>
</tr>
<tr>
<td>var(), sd()</td>
<td>Variance and standard deviation of a vector</td>
</tr>
<tr>
<td>first()</td>
<td>First value in a vector</td>
</tr>
<tr>
<td>last()</td>
<td>Last value in a vector</td>
</tr>
<tr>
<td>nth()</td>
<td>Nth value in a vector</td>
</tr>
<tr>
<td>n()</td>
<td>The number of values in a vector</td>
</tr>
<tr>
<td>n_distinct()</td>
<td>The number of distinct values in a vector</td>
</tr>
</tbody>
</table>
<p>All functions in this list takes a vector of values and returns a single summary value. We can get the average delay using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Take the average of departure delay</span>
<span class=err>
</span><span class=err></span><span class=go>summarise(flights, delay = mean(dep_delay, na.rm = TRUE))
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 1 x 1</span>
<span class=gp>#</span><span class=c1>##   delay</span>
<span class=gp>#</span><span class=c1>##   &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>## 1  12.6</span>
</code></pre></td></tr></table>
</div>
</div><p>The na.rm = TRUE argument in mean() function will allow us to ignore the missing values while computing the average. We will revisit na.rm = TRUE argument in the next section (in Module 5).</p>
<h4 id=group_by--summarise-function>group_by() + summarise() function</h4>
<p>If we want to take the summary statistics grouped by a variable, then we need to use another function called group_by(). group_by() along with summarise() functions will allow us to take and compare summary statistics grouped by a factor variable.</p>
<p>For example, if we applied the same code to a data frame grouped by destination, we can get the average delay for each destination.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Group by destination and use summarise to calculate the mean delay</span>
<span class=err>
</span><span class=err></span><span class=go>flights %&gt;% group_by(dest) %&gt;% summarise(mean_delay = mean(dep_delay, na.rm = TRUE))
</span><span class=go></span><span class=gp>#</span><span class=c1>## `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 105 x 2</span>
<span class=gp>#</span><span class=c1>##    dest  mean_delay</span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;      &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1 ABQ        13.7 </span>
<span class=gp>#</span><span class=c1>##  2 ACK         6.46</span>
<span class=gp>#</span><span class=c1>##  3 ALB        23.6 </span>
<span class=gp>#</span><span class=c1>##  4 ANC        12.9 </span>
<span class=gp>#</span><span class=c1>##  5 ATL        12.5 </span>
<span class=gp>#</span><span class=c1>##  6 AUS        13.0 </span>
<span class=gp>#</span><span class=c1>##  7 AVL         8.19</span>
<span class=gp>#</span><span class=c1>##  8 BDL        17.7 </span>
<span class=gp>#</span><span class=c1>##  9 BGR        19.5 </span>
<span class=gp>#</span><span class=c1>## 10 BHM        29.7 </span>
<span class=gp>#</span><span class=c1>## # ... with 95 more rows</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=joining-data-sets>Joining data sets</h4>
<p>Often, we have separate data frames that can have common and differing variables for similar observations. These types of data sets are referred as relational data sets.</p>
<p>We will revisit the nycflights13 package. The nycflights13 package contains the following data sets:</p>
<ul>
<li>airlines includes the names of airline companies and their abbreviated code:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>airlines
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 16 x 2</span>
<span class=gp>#</span><span class=c1>##    carrier name                       </span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;   &lt;chr&gt;                      </span>
<span class=gp>#</span><span class=c1>##  1 9E      Endeavor Air Inc.          </span>
<span class=gp>#</span><span class=c1>##  2 AA      American Airlines Inc.     </span>
<span class=gp>#</span><span class=c1>##  3 AS      Alaska Airlines Inc.       </span>
<span class=gp>#</span><span class=c1>##  4 B6      JetBlue Airways            </span>
<span class=gp>#</span><span class=c1>##  5 DL      Delta Air Lines Inc.       </span>
<span class=gp>#</span><span class=c1>##  6 EV      ExpressJet Airlines Inc.   </span>
<span class=gp>#</span><span class=c1>##  7 F9      Frontier Airlines Inc.     </span>
<span class=gp>#</span><span class=c1>##  8 FL      AirTran Airways Corporation</span>
<span class=gp>#</span><span class=c1>##  9 HA      Hawaiian Airlines Inc.     </span>
<span class=gp>#</span><span class=c1>## 10 MQ      Envoy Air                  </span>
<span class=gp>#</span><span class=c1>## 11 OO      SkyWest Airlines Inc.      </span>
<span class=gp>#</span><span class=c1>## 12 UA      United Air Lines Inc.      </span>
<span class=gp>#</span><span class=c1>## 13 US      US Airways Inc.            </span>
<span class=gp>#</span><span class=c1>## 14 VX      Virgin America             </span>
<span class=gp>#</span><span class=c1>## 15 WN      Southwest Airlines Co.     </span>
<span class=gp>#</span><span class=c1>## 16 YV      Mesa Airlines Inc.</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>airports gives information about each airport, identified by the airport code (faa):</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>airports
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 1,458 x 8</span>
<span class=gp>#</span><span class=c1>##    faa   name                       lat    lon   alt    tz dst   tzone          </span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;          </span>
<span class=gp>#</span><span class=c1>##  1 04G   Lansdowne Airport         41.1  -80.6  1044    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  2 06A   Moton Field Municipal A~  32.5  -85.7   264    -6 A     America/Chicago</span>
<span class=gp>#</span><span class=c1>##  3 06C   Schaumburg Regional       42.0  -88.1   801    -6 A     America/Chicago</span>
<span class=gp>#</span><span class=c1>##  4 06N   Randall Airport           41.4  -74.4   523    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  5 09J   Jekyll Island Airport     31.1  -81.4    11    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  6 0A9   Elizabethton Municipal ~  36.4  -82.2  1593    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  7 0G6   Williams County Airport   41.5  -84.5   730    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  8 0G7   Finger Lakes Regional A~  42.9  -76.8   492    -5 A     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>##  9 0P2   Shoestring Aviation Air~  39.8  -76.6  1000    -5 U     America/New_Yo~</span>
<span class=gp>#</span><span class=c1>## 10 0S9   Jefferson County Intl     48.1 -123.    108    -8 A     America/Los_An~</span>
<span class=gp>#</span><span class=c1>## # ... with 1,448 more rows</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>planes gives information about each plane, identified by its tail number (tailnum):</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>planes
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 3,322 x 9</span>
<span class=gp>#</span><span class=c1>##    tailnum  year type          manufacturer   model  engines seats speed engine </span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>##  1 N10156   2004 Fixed wing m~ EMBRAER        EMB-1~       2    55    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  2 N102UW   1998 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  3 N103US   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  4 N104UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  5 N10575   2002 Fixed wing m~ EMBRAER        EMB-1~       2    55    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  6 N105UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  7 N107US   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  8 N108UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>##  9 N109UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>## 10 N110UW   1999 Fixed wing m~ AIRBUS INDUST~ A320-~       2   182    NA Turbo-~</span>
<span class=gp>#</span><span class=c1>## # ... with 3,312 more rows</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>weather gives the weather conditions at each NYC airport for each hour:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>weather
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 26,115 x 15</span>
<span class=gp>#</span><span class=c1>##    origin  year month   day  hour  temp  dewp humid wind_dir wind_speed</span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 </span>
<span class=gp>#</span><span class=c1>##  2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06</span>
<span class=gp>#</span><span class=c1>##  3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 </span>
<span class=gp>#</span><span class=c1>##  4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 </span>
<span class=gp>#</span><span class=c1>##  5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 </span>
<span class=gp>#</span><span class=c1>##  6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 </span>
<span class=gp>#</span><span class=c1>##  7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 </span>
<span class=gp>#</span><span class=c1>##  8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 </span>
<span class=gp>#</span><span class=c1>##  9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 </span>
<span class=gp>#</span><span class=c1>## 10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 </span>
<span class=gp>#</span><span class=c1>## # ... with 26,105 more rows, and 5 more variables: wind_gust &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Therefore, for nycflights13:</p>
<ul>
<li>flights connects to planes via a single variable, tailnum.</li>
<li>flights connects to airlines through the carrier variable.</li>
<li>flights connects to airports in two ways: via the origin and dest variables.</li>
<li>flights connects to weather via origin (the location), and year, month, day, and hour (the time).</li>
</ul>
<p>The following illustration (adapted from Wickham and Grolemund (2016)) shows the relationship between flights, airlines, airports and weather data sets, and the key variables connecting them.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043188/MATH2349/Model4/joiningDatasets_bp5why.png></p>
<p>Fig4. Chain of relations between the data sets in nycflights13 (taken from Wickham and Grolemund (2016))</p>
<p>The dplyr package offers three sets of joining functions to provide alternative ways to join data frames. These are:</p>
<ul>
<li>Mutating joins: This group of functions add new variables to one data frame from matching observations in another.</li>
<li>Filtering joins: This group of functions filter observations from one data frame based on whether or not they match an observation in the other table.</li>
<li>Set operations: This group of functions treat observations as if they were set elements.</li>
</ul>
<h5 id=mutating-joins>Mutating joins</h5>
<p>The first set of functions to combine data sets is called “mutating joins”. left_join(), right_join(), inner_join(), and full_join() functions are in this group. The mutating join functions allow you to combine variables from two tables and add variables to the right (like mutate).</p>
<p>Note that, mutating join functions add variables to the right. Therefore, if you have a lot of variables already in the data, the new variables won’t get printed out. As flights data set has many variables, I will first create a narrower data set named flights2 to easily show you what’s going on in the examples.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Create a new data set named flights2 including year - day, hour, origin, destination, tailnum and carrier variables</span>
<span class=err>
</span><span class=err></span><span class=go>flights2 &lt;- flights %&gt;% select(year:day, hour, origin, dest, tailnum, carrier)
</span><span class=go></span><span class=err>
</span><span class=err></span><span class=go>flights2
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 8</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     5 EWR    IAH   N14228  UA     </span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     5 LGA    IAH   N24211  UA     </span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     5 JFK    MIA   N619AA  AA     </span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     5 JFK    BQN   N804JB  B6     </span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ATL   N668DN  DL     </span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     5 EWR    ORD   N39463  UA     </span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 EWR    FLL   N516JB  B6     </span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 LGA    IAD   N829AS  EV     </span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 JFK    MCO   N593JB  B6     </span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA     </span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p>Imagine you want to add the full airline name (from airlines) to the flights2 data. You can combine the airlines and flights2 data frames using left_join(). Remember that we will need a key variable and the key variable will be the carrier variable to join these two data sets.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># joining flights2 and airlines using the carrier name.</span>
<span class=err>
</span><span class=err></span><span class=go>flights2 %&gt;% left_join(airlines, by = &#34;carrier&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 9</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier name                    </span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   </span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     5 EWR    IAH   N14228  UA      United Air Lines Inc.   </span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     5 LGA    IAH   N24211  UA      United Air Lines Inc.   </span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     5 JFK    MIA   N619AA  AA      American Airlines Inc.  </span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     5 JFK    BQN   N804JB  B6      JetBlue Airways         </span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ATL   N668DN  DL      Delta Air Lines Inc.    </span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     5 EWR    ORD   N39463  UA      United Air Lines Inc.   </span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 EWR    FLL   N516JB  B6      JetBlue Airways         </span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 LGA    IAD   N829AS  EV      ExpressJet Airlines Inc.</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 JFK    MCO   N593JB  B6      JetBlue Airways         </span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      American Airlines Inc.  </span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=controlling-how-the-data-sets-are-matched>Controlling how the data sets are matched</h5>
<p>Each mutating join takes an argument by that controls which variables are used to match observations in the two data sets. There are a few ways to specify it:</p>
<ul>
<li>NULL: The default value. dplyr will will use all variables that appear in both tables, a natural join. For example, the flights and weather data sets match on their common variables: year, month, day, hour and origin.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># joining flights2 and weather using the default key = NULL.</span>
<span class=err>
</span><span class=err></span><span class=go>flights2 %&gt;% left_join(weather)
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 18</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier  temp  dewp humid</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     5 EWR    IAH   N14228  UA       39.0  28.0  64.4</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     5 LGA    IAH   N24211  UA       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     5 JFK    MIA   N619AA  AA       39.0  27.0  61.6</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     5 JFK    BQN   N804JB  B6       39.0  27.0  61.6</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     5 EWR    ORD   N39463  UA       39.0  28.0  64.4</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 EWR    FLL   N516JB  B6       37.9  28.0  67.2</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 LGA    IAD   N829AS  EV       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 JFK    MCO   N593JB  B6       37.9  27.0  64.3</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 7 more variables: wind_dir &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>A character vector, by = &ldquo;x&rdquo;. For example, flights and planes have tailnum in common.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># joining flights2 and planes using the tailnum.</span>
<span class=err>
</span><span class=err></span><span class=go>flights2 %&gt;% left_join(planes, by = &#34;tailnum&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 16</span>
<span class=gp>#</span><span class=c1>##    year.x month   day  hour origin dest  tailnum carrier year.y type </span>
<span class=gp>#</span><span class=c1>##     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;</span>
<span class=gp>#</span><span class=c1>##  1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixe~</span>
<span class=gp>#</span><span class=c1>##  2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixe~</span>
<span class=gp>#</span><span class=c1>##  3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixe~</span>
<span class=gp>#</span><span class=c1>##  4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixe~</span>
<span class=gp>#</span><span class=c1>##  5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixe~</span>
<span class=gp>#</span><span class=c1>##  6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixe~</span>
<span class=gp>#</span><span class=c1>##  7   2013     1     1     6 EWR    FLL   N516JB  B6        2000 Fixe~</span>
<span class=gp>#</span><span class=c1>##  8   2013     1     1     6 LGA    IAD   N829AS  EV        1998 Fixe~</span>
<span class=gp>#</span><span class=c1>##  9   2013     1     1     6 JFK    MCO   N593JB  B6        2004 Fixe~</span>
<span class=gp>#</span><span class=c1>## 10   2013     1     1     6 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt; </span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 6 more variables: manufacturer &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>A named character vector: by = c(&ldquo;a&rdquo; = &ldquo;b&rdquo;). This will match variable a in table x to variable b in table y. This is useful when the key variables in both data sets are not given the same name. For example, flights data set has the destination airport code (dest) and the airports data set has the faa code. Essentially these two are equivalent. Therefore, we can use the following to join these two data sets:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2 %&gt;% left_join(airports, c(&#34;dest&#34; = &#34;faa&#34;))
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 336,776 x 15</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier name    lat   lon   alt</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     5 EWR    IAH   N14228  UA      Geor~  30.0 -95.3    97</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     5 LGA    IAH   N24211  UA      Geor~  30.0 -95.3    97</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     5 JFK    MIA   N619AA  AA      Miam~  25.8 -80.3     8</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     5 JFK    BQN   N804JB  B6      &lt;NA&gt;   NA    NA      NA</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ATL   N668DN  DL      Hart~  33.6 -84.4  1026</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     5 EWR    ORD   N39463  UA      Chic~  42.0 -87.9   668</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 EWR    FLL   N516JB  B6      Fort~  26.1 -80.2     9</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 LGA    IAD   N829AS  EV      Wash~  38.9 -77.5   313</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 JFK    MCO   N593JB  B6      Orla~  28.4 -81.3    96</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA      Chic~  42.0 -87.9   668</span>
<span class=gp>#</span><span class=c1>## # ... with 336,766 more rows, and 3 more variables: tz &lt;dbl&gt;, dst &lt;chr&gt;,</span>
<span class=gp>#</span><span class=c1>## #   tzone &lt;chr&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>To help you learn how different types of xxx_join() functions work, I’m going to use Hadley Wickham’s visual representation (Wickham and Grolemund (2016)):</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png></p>
<h5 id=filtering-joins>Filtering Joins</h5>
<p>Filtering joins match observations in the same way as mutating joins, but affect the observations, not the variables. There are two types of filtering joins: semi_join() and anti_join().</p>
<ul>
<li>semi_join(x, y): keeps all observations in x that have a match in y.</li>
<li>anti_join(x, y): drops all observations in x that have a match in y.</li>
</ul>
<p>Anti-joins are useful for diagnosing join mismatches. For example, when connecting flights and planes, you might be interested to know that there are many flights that don’t have a match in planes:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights %&gt;% anti_join(planes, by = &#34;tailnum&#34;) %&gt;% count(tailnum, sort = TRUE)
</span><span class=go></span><span class=gp>#</span><span class=c1>## # A tibble: 722 x 2</span>
<span class=gp>#</span><span class=c1>##    tailnum     n</span>
<span class=gp>#</span><span class=c1>##    &lt;chr&gt;   &lt;int&gt;</span>
<span class=gp>#</span><span class=c1>##  1 &lt;NA&gt;     2512</span>
<span class=gp>#</span><span class=c1>##  2 N725MQ    575</span>
<span class=gp>#</span><span class=c1>##  3 N722MQ    513</span>
<span class=gp>#</span><span class=c1>##  4 N723MQ    507</span>
<span class=gp>#</span><span class=c1>##  5 N713MQ    483</span>
<span class=gp>#</span><span class=c1>##  6 N735MQ    396</span>
<span class=gp>#</span><span class=c1>##  7 N0EGMQ    371</span>
<span class=gp>#</span><span class=c1>##  8 N534MQ    364</span>
<span class=gp>#</span><span class=c1>##  9 N542MQ    363</span>
<span class=gp>#</span><span class=c1>## 10 N531MQ    349</span>
<span class=gp>#</span><span class=c1>## # ... with 712 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p>Here is a visual representation of these two filtering joins.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png></p>
<h5 id=when-to-use-mutating-or-filtering-joins>When to use mutating or filtering joins</h5>
<p>Suppose you have flights2 (X) and weather (Y) data sets. Recall, these data sets match on their common variables: year, month, day, hour and origin.</p>
<p>If you want to add/combine columns to/from data set X from/to data set Y, you need to use mutating joins.</p>
<p><strong>LEFT_JOIN</strong>: Let’s say, you want to see the weather of flights departing at 6 in the morning. You will need to use left_join() to ADD the weather columns to the flights2 data set.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2_h6 &lt;- flights2 %&gt;% filter(hour == 6)
</span><span class=go></span><span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># joining flights2 and weather using the default key = NULL.</span>
<span class=go>flights2_h6 %&gt;% left_join(weather)
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 25,951 x 18</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier  temp  dewp humid</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     6 EWR    FLL   N516JB  B6       37.9  28.0  67.2</span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     6 LGA    IAD   N829AS  EV       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     6 JFK    MCO   N593JB  B6       37.9  27.0  64.3</span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ORD   N3ALAA  AA       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     6 JFK    PBI   N793JB  B6       37.9  27.0  64.3</span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 JFK    TPA   N657JB  B6       37.9  27.0  64.3</span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 JFK    LAX   N29129  UA       37.9  27.0  64.3</span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 EWR    SFO   N53441  UA       37.9  28.0  67.2</span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    DFW   N3DUAA  AA       39.9  25.0  54.8</span>
<span class=gp>#</span><span class=c1>## # ... with 25,941 more rows, and 7 more variables: wind_dir &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>RIGHT_JOIN</strong>: Let’s say, you want to see the flights that has weather visibility of 5. You will need to use right_join() to ADD the flights2 columns to the weather data set.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>weather_v5 &lt;- weather %&gt;% filter(visib == 5)
</span><span class=go></span><span class=err>
</span><span class=err></span><span class=go>flights2 %&gt;% right_join(weather_v5) %&gt;% select(visib, everything())
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 4,916 x 18</span>
<span class=gp>#</span><span class=c1>##    visib  year month   day  hour origin dest  tailnum carrier  temp  dewp humid</span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1     5  2013     1     9     7 LGA    BOS   N947UW  US       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  2     5  2013     1     9     7 LGA    DCA   N712US  US       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  3     5  2013     1     9     7 LGA    MIA   N953DL  DL       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  4     5  2013     1     9     7 LGA    ORD   N466AA  AA       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  5     5  2013     1     9     7 LGA    MIA   N3CDAA  AA       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  6     5  2013     1     9     7 LGA    XNA   N730MQ  MQ       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  7     5  2013     1     9     7 LGA    ORD   N438UA  UA       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  8     5  2013     1     9     7 LGA    MCO   N506JB  B6       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>##  9     5  2013     1     9     7 LGA    MKE   N979AT  FL       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>## 10     5  2013     1     9     7 LGA    RSW   N593JB  B6       37.0  33.1  85.4</span>
<span class=gp>#</span><span class=c1>## # ... with 4,906 more rows, and 6 more variables: wind_dir &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>INNER_JOIN</strong>: Let’s say, you want to see the flights that departs at 6 in the morning and has weather visibility of 5. You will need to use inner_join() to COMBINE the flights2_h6 and weather_v5 columns into a single data set with hour = 6 and visib = 5.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2_h6 %&gt;% inner_join(weather_v5) %&gt;% select(hour, visib, everything())
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 497 x 18</span>
<span class=gp>#</span><span class=c1>##     hour visib  year month   day origin dest  tailnum carrier  temp  dewp humid</span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1     6     5  2013     1    29 JFK    FLL   N588JB  B6       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  2     6     5  2013     1    29 JFK    IAD   N830AS  EV       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  3     6     5  2013     1    29 JFK    RSW   N516JB  B6       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  4     6     5  2013     1    29 JFK    PHL   N949UW  US       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  5     6     5  2013     1    29 JFK    LAX   N67134  UA       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  6     6     5  2013     1    29 JFK    SFO   N532UA  UA       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  7     6     5  2013     1    29 JFK    PBI   N768JB  B6       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  8     6     5  2013     1    29 JFK    SJU   N793JB  B6       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>##  9     6     5  2013     1    29 JFK    ATL   N197PQ  9E       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>## 10     6     5  2013     1    29 JFK    BOS   N775JB  B6       37.0  35.1  92.5</span>
<span class=gp>#</span><span class=c1>## # ... with 487 more rows, and 6 more variables: wind_dir &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>FULL_JOIN</strong>: Let’s say, you want to see the flights that departs at 6 in the morning or has weather visibility of 5. You will need to use full_join() to COMBINE the flights2_h6 and weather_v5 columns into a single data set with hour = 6 OR visib = 5.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2_h6 %&gt;% full_join(weather_v5) %&gt;% select(hour, visib, everything())
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 26,315 x 18</span>
<span class=gp>#</span><span class=c1>##     hour visib  year month   day origin dest  tailnum carrier  temp  dewp humid</span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class=gp>#</span><span class=c1>##  1     6    NA  2013     1     1 LGA    ATL   N668DN  DL         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  2     6    NA  2013     1     1 EWR    FLL   N516JB  B6         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  3     6    NA  2013     1     1 LGA    IAD   N829AS  EV         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  4     6    NA  2013     1     1 JFK    MCO   N593JB  B6         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  5     6    NA  2013     1     1 LGA    ORD   N3ALAA  AA         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  6     6    NA  2013     1     1 JFK    PBI   N793JB  B6         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  7     6    NA  2013     1     1 JFK    TPA   N657JB  B6         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  8     6    NA  2013     1     1 JFK    LAX   N29129  UA         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>##  9     6    NA  2013     1     1 EWR    SFO   N53441  UA         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>## 10     6    NA  2013     1     1 LGA    DFW   N3DUAA  AA         NA    NA    NA</span>
<span class=gp>#</span><span class=c1>## # ... with 26,305 more rows, and 6 more variables: wind_dir &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span>
<span class=gp>#</span><span class=c1>## #   time_hour &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Meanwhile, if you want to filter records in data set X using data set Y retaining only columns of data set X, you need to use filtering joins.</p>
<p><strong>SEMI_JOIN</strong>: Let’s say, you want to see flights with weather visibility of 5. You will need to use semi_join() to FILTER the flights2 data set using the weather_v5 data set.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2 %&gt;% semi_join(weather_v5)
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 4,809 x 8</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>##  1  2013     1     9     7 LGA    BOS   N947UW  US     </span>
<span class=gp>#</span><span class=c1>##  2  2013     1     9     7 LGA    DCA   N712US  US     </span>
<span class=gp>#</span><span class=c1>##  3  2013     1     9     7 LGA    MIA   N953DL  DL     </span>
<span class=gp>#</span><span class=c1>##  4  2013     1     9     7 LGA    ORD   N466AA  AA     </span>
<span class=gp>#</span><span class=c1>##  5  2013     1     9     7 LGA    MIA   N3CDAA  AA     </span>
<span class=gp>#</span><span class=c1>##  6  2013     1     9     7 LGA    XNA   N730MQ  MQ     </span>
<span class=gp>#</span><span class=c1>##  7  2013     1     9     7 LGA    ORD   N438UA  UA     </span>
<span class=gp>#</span><span class=c1>##  8  2013     1     9     7 LGA    MCO   N506JB  B6     </span>
<span class=gp>#</span><span class=c1>##  9  2013     1     9     7 LGA    MKE   N979AT  FL     </span>
<span class=gp>#</span><span class=c1>## 10  2013     1     9     7 LGA    RSW   N593JB  B6     </span>
<span class=gp>#</span><span class=c1>## # ... with 4,799 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>ANTI_JOIN</strong>: Let’s say, you want to see flights with weather visibility not equal to 5. You will need to use anti_join() to FILTER the flights2 data set using the weather_v5 dataset.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>flights2 %&gt;% anti_join(weather_v5)
</span><span class=go></span><span class=gp>#</span><span class=c1>## Joining, by = c(&#34;year&#34;, &#34;month&#34;, &#34;day&#34;, &#34;hour&#34;, &#34;origin&#34;)</span>
<span class=gp>#</span><span class=c1>## # A tibble: 331,967 x 8</span>
<span class=gp>#</span><span class=c1>##     year month   day  hour origin dest  tailnum carrier</span>
<span class=gp>#</span><span class=c1>##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>##  1  2013     1     1     5 EWR    IAH   N14228  UA     </span>
<span class=gp>#</span><span class=c1>##  2  2013     1     1     5 LGA    IAH   N24211  UA     </span>
<span class=gp>#</span><span class=c1>##  3  2013     1     1     5 JFK    MIA   N619AA  AA     </span>
<span class=gp>#</span><span class=c1>##  4  2013     1     1     5 JFK    BQN   N804JB  B6     </span>
<span class=gp>#</span><span class=c1>##  5  2013     1     1     6 LGA    ATL   N668DN  DL     </span>
<span class=gp>#</span><span class=c1>##  6  2013     1     1     5 EWR    ORD   N39463  UA     </span>
<span class=gp>#</span><span class=c1>##  7  2013     1     1     6 EWR    FLL   N516JB  B6     </span>
<span class=gp>#</span><span class=c1>##  8  2013     1     1     6 LGA    IAD   N829AS  EV     </span>
<span class=gp>#</span><span class=c1>##  9  2013     1     1     6 JFK    MCO   N593JB  B6     </span>
<span class=gp>#</span><span class=c1>## 10  2013     1     1     6 LGA    ORD   N3ALAA  AA     </span>
<span class=gp>#</span><span class=c1>## # ... with 331,957 more rows</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=set-operations>Set operations</h5>
<p>Set operations expect the x and y inputs to have the same variables and treat the observations like sets. There are three types of set operations:</p>
<ul>
<li>intersect(x, y): return only observations in both x and y.</li>
<li>union(x, y): return unique observations in x and y.</li>
<li>setdiff(x, y): return observations in x, but not in y.</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045672/MATH2349/Model4/SetOperations_ru8lnr.png></p>
<h5 id=merging-data-sets>Merging data sets</h5>
<p>Often you may just need to merge data frames by row and column. The bind_rows() and bind_cols() bind the multiple data frames by row and column, respectively.</p>
<ul>
<li>bind_rows(x, y): Append y to x as new rows.</li>
<li>bind_cols(x, y): Append y to x as new columns.</li>
</ul>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617045837/MATH2349/Model4/MergingDatasets_fnoqva.png></p>
<h3 id=additional-resources-and-further-reading-2>Additional Resources and Further Reading</h3>
<p>You can refer to the tidyr package manual (H Wickham (2014)) and the Tidy Data paper for a detailed information on tidy data principles and tidyr package.</p>
<p>Our recommended textbooks (Boehmke (2016) and Wickham and Grolemund (2016)), R Studio’s Data wrangling with R and RStudio webinar, and dplyr reference manual (H Wickham (2014), Wickham et al. (2017)) are great resources to excel your knowledge in Data Manipulation with dplyr.</p>
<p>If you are interested in improving your coding style, I would recommend using the tidyverse style guide. Note that a good coding style is like correct punctuation, you can manage without it, but a good coding style makes things easier to read for you and for the others who are gonna use your codes!</p>
<h3 id=references-2>References</h3>
<p>Boehmke, Bradley C. 2016. Data Wrangling with R. Springer.</p>
<p>Wickham, H. 2014. “Tidyr: Easily Tidy Data with Spread () and Gather () Functions. R Package.” Version 0.2. 0. Available at Http://CRAN. R-Project. Org/Package= Tidyr [Verified 7 June 2016].</p>
<p>Wickham, Hadley, and Garrett Grolemund. 2016. R for Data Science: Import, Tidy, Transform, Visualize, and Model Data. " O’Reilly Media, Inc.".</p>
<p>Wickham, Hadley, and others. 2014. “Tidy Data.” Journal of Statistical Software 59 (10): 1–23.</p>
<p>Wickham, H, R Francois, L Henry, and K Müller. 2017. “Dplyr: A Grammar of Data Manipulation. R Package Version 0.7. 0.” URL https://CRAN. R-project. org/package= dplyr.</p>
<h2 id=module-5---scan-missing-values>Module 5 - Scan: Missing Values</h2>
<h3 id=introduction>Introduction</h3>
<p>Dealing missing values is an unavoidable task in the data preprocessing. For almost every data set, we will encounter some missing values. So, it is important to know how R handles missing values and how they are represented. In this module first, you will learn how the missing values and special values are represented in R. Then, you will learn how to identify, recode and exclude missing values. Moreover, we will cover missing value imputation techniques briefly. Note that the missing value analysis and the missing value imputation are broader concepts that would be a stand-alone topic of another course. Interested readers may refer to the books and resources in the additional resources and the further reading section for further details.</p>
<p>The analysts may also need to check and correct the obvious errors and/or inconsistencies in a data set. In this module, I also briefly introduced the deductive and deducorrect packages (in fact deducorrect is a former version of deductive package), and useful functions to correct the obvious errors and inconsistencies in a given data set. However, this part of module left as an optional reading for students.</p>
<h3 id=learning-objectives-4>learning objectives</h3>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Learn how missing and special values are represented in the data set.</li>
<li>Identify missing values in the data set.</li>
<li>Learn how to recode missing values.</li>
<li>Learn the functions for removing missing values.</li>
<li>Learn commonly used approaches to impute/replace missing value(s).</li>
<li>(Optional) Check and correct obvious inconsistencies and errors in the data set.</li>
</ul>
<h3 id=missing-data>Missing Data</h3>
<p>In R, a numeric missing value is represented by NA (NA stands for “not available”), while character missing values are represented by <na>. In addition to NA and <na>, some other values may represent missing values (i.e. 99, ., .., just space, or NULL) depending on the software (i.e., Excel, SPSS etc.) that you import in your data.</p>
<p>Let’s have a look at the pet1.csv data:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>readr</span><span class=p>)</span>

<span class=n>pet1</span> <span class=o>&lt;-</span> <span class=nf>read_csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/pet1.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## -- Column specification --------------------------------------------------------</span>
<span class=gp>#</span><span class=c1>## cols(</span>
<span class=gp>#</span><span class=c1>##   id = col_double(),</span>
<span class=gp>#</span><span class=c1>##   State = col_character(),</span>
<span class=gp>#</span><span class=c1>##   Region = col_character(),</span>
<span class=gp>#</span><span class=c1>##   Reference = col_double(),</span>
<span class=gp>#</span><span class=c1>##   Animal_Name = col_character(),</span>
<span class=gp>#</span><span class=c1>##   Colour_primary = col_character()</span>
<span class=gp>#</span><span class=c1>## )</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>head</span><span class=p>(</span><span class=n>pet1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## # A tibble: 6 x 6</span>
<span class=gp>#</span><span class=c1>##       id State    Region   Reference Animal_Name Colour_primary </span>
<span class=gp>#</span><span class=c1>##    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;          </span>
<span class=gp>#</span><span class=c1>## 1 118269 Victoria Ballarat        NA Jack Wilson Brown          </span>
<span class=gp>#</span><span class=c1>## 2 106347 Victoria Ballarat        NA Eva         Black And White</span>
<span class=gp>#</span><span class=c1>## 3 156347 Victoria Wyndham         NA &lt;NA&gt;        TRI            </span>
<span class=gp>#</span><span class=c1>## 4  63947 Victoria Geelong         NA Archie      White/Brown    </span>
<span class=gp>#</span><span class=c1>## 5  79724 Victoria Ballarat        NA Susie       Brown          </span>
<span class=gp>#</span><span class=c1>## 6  43442 Victoria Geelong         NA Pearl       Tri Colour</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that, as we read this data from a .csv file, missing values are represented as NA for the integer reference variable where else <na> for the character Animal_Name variable.
However, let’s look at another example SPSS data file named population_NA.sav:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>foreign</span><span class=p>)</span>

<span class=n>population_NA</span> <span class=o>&lt;-</span> <span class=nf>read.spss</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/population_NA.sav&#34;</span><span class=p>,</span> <span class=n>to.data.frame</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## re-encoding from UTF-8</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=go>population_NA
</span><span class=go></span><span class=gp>#</span><span class=c1>##                                 Region X.2013 X.2014 X.2015  X.2016</span>
<span class=gp>#</span><span class=c1>## 1  ISL                                   3.21   3.25   3.28 3.32   </span>
<span class=gp>#</span><span class=c1>## 2  CAN                                   3.87   3.91   3.94 3.99   </span>
<span class=gp>#</span><span class=c1>## 3  RUS                                   7.83   7.85   7.87 ..     </span>
<span class=gp>#</span><span class=c1>## 4  COL                                  41.27  41.74     NA ..     </span>
<span class=gp>#</span><span class=c1>## 5  ZAF                                  43.53  44.22     NA ..     </span>
<span class=gp>#</span><span class=c1>## 6  LTU                                  47.42  46.96  46.63 46.11  </span>
<span class=gp>#</span><span class=c1>## 7  MEX                                  60.43  61.10  61.76 62.41  </span>
<span class=gp>#</span><span class=c1>## 8  IND                                 394.85     NA     NA ..     </span>
<span class=gp>#</span><span class=c1>## 9  NLD                                 497.64 499.59 501.68 504.01 </span>
<span class=gp>#</span><span class=c1>## 10 KOR                                 504.92 506.97 508.91 510.77</span>
</code></pre></td></tr></table>
</div>
</div><p>As you see in the data frame, there are two different representations for the missing values: one is NA, the other is .. . Therefore, we need to be careful about different representations of the missing values while importing the data from other software.</p>
<h3 id=identifying-missing-data>Identifying Missing Data</h3>
<p>To identify missing values we will use is.na() function which returns a logical vector with TRUE in the element locations that contain missing values represented by NA. is.na() will work on vectors, lists, matrices, and data frames.
Here are some examples of is.na() function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a vector with missing data</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>4</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>6</span><span class=o>:</span><span class=m>7</span><span class=p>,</span> <span class=kc>NA</span><span class=p>)</span>
<span class=n>x</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  1  2  3  4 NA  6  7 NA</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>is.na</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a data frame with missing data</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=kc>NA</span><span class=p>),</span>
                 <span class=n>col2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;this&#34;</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span><span class=s>&#34;is&#34;</span><span class=p>,</span> <span class=s>&#34;text&#34;</span><span class=p>),</span> 
                 <span class=n>col3</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span> 
                 <span class=n>col4</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>2.5</span><span class=p>,</span> <span class=m>4.2</span><span class=p>,</span> <span class=m>3.2</span><span class=p>,</span> <span class=kc>NA</span><span class=p>))</span>

<span class=c1>## identify NAs in full data frame</span>

<span class=nf>is.na</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       col1  col2  col3  col4</span>
<span class=gp>#</span><span class=c1>## [1,] FALSE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>## [2,] FALSE  TRUE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>## [3,] FALSE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>## [4,]  TRUE FALSE FALSE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## identify NAs in specific data frame column</span>

<span class=nf>is.na</span><span class=p>(</span><span class=n>df</span><span class=o>$</span><span class=n>col4</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE FALSE FALSE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>To identify the location or the number of NAs we can use the which() and sum() functions:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## identify location of NAs in vector</span>

<span class=nf>which</span><span class=p>(</span><span class=nf>is.na</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 5 8</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## identify count of NAs in data frame</span>

<span class=nf>sum</span><span class=p>(</span><span class=nf>is.na</span><span class=p>(</span><span class=n>df</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 3</span>
</code></pre></td></tr></table>
</div>
</div><p>More convenient way to compute the total missing values in each column is to use colSums():</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>colSums</span><span class=p>(</span><span class=nf>is.na</span><span class=p>(</span><span class=n>df</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## col1 col2 col3 col4 </span>
<span class=gp>#</span><span class=c1>##    1    1    0    1</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=recode-missing-data>Recode Missing Data</h3>
<p>We can use normal subsetting and assignment operations in order to recode missing values; or recode specific indicators that represent missing values.
For instance, we can recode missing values in vector x with the mean values in x. To do this, first we need to subset the vector to identify NAs and then assign these elements a value. Here is an example:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># create vector with missing data</span>
<span class=err>
</span><span class=err></span><span class=go>x &lt;- c(1:4, NA, 6:7, NA)
</span><span class=go>x
</span></code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  1  2  3  4 NA  6  7 NA</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## recode missing values with the mean (also see &#34;Missing Value Imputation Techniques&#34; section)</span>

<span class=n>x</span><span class=nf>[is.na</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=n>x</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 1.000000 2.000000 3.000000 4.000000 3.833333 6.000000 7.000000 3.833333</span>
</code></pre></td></tr></table>
</div>
</div><p>Similarly, if missing values are represented by another value (i.e. ..) we can simply subset the data for the elements that contain that value and then assign a desired value to those elements.
Remember that population_NA data frame has missing values represented by &ldquo;..&rdquo; in the X.2016 column. Now let’s change &ldquo;..&rdquo; values to NA’s.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## population_NA data frame has missing values represented by &#34;..&#34; in the X.2016 column.</span>

<span class=n>population_NA</span><span class=o>$</span><span class=n>X.2016</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##  [1] &#34;3.32   &#34; &#34;3.99   &#34; &#34;..     &#34; &#34;..     &#34; &#34;..     &#34; &#34;46.11  &#34; &#34;62.41  &#34;</span>
<span class=gp>#</span><span class=c1>##  [8] &#34;..     &#34; &#34;504.01 &#34; &#34;510.77 &#34;</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Note the white spaces after ..&#39;s and  change  &#34;..     &#34; values to NAs</span>

<span class=n>population_NA[population_NA</span> <span class=o>==</span> <span class=s>&#34;..     &#34;</span> <span class=n>]</span> <span class=o>&lt;-</span> <span class=kc>NA</span>

<span class=n>population_NA</span>
</code></pre></td></tr></table>
</div>
</div><p>Or,</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>population_NA</span><span class=nf>[which</span><span class=p>(</span><span class=n>population_NA</span> <span class=o>==</span> <span class=s>&#34;..     &#34;</span> <span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=kc>NA</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##                                 Region X.2013 X.2014 X.2015  X.2016</span>
<span class=gp>#</span><span class=c1>## 1  ISL                                   3.21   3.25   3.28 3.32   </span>
<span class=gp>#</span><span class=c1>## 2  CAN                                   3.87   3.91   3.94 3.99   </span>
<span class=gp>#</span><span class=c1>## 3  RUS                                   7.83   7.85   7.87    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 4  COL                                  41.27  41.74     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 5  ZAF                                  43.53  44.22     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 6  LTU                                  47.42  46.96  46.63 46.11  </span>
<span class=gp>#</span><span class=c1>## 7  MEX                                  60.43  61.10  61.76 62.41  </span>
<span class=gp>#</span><span class=c1>## 8  IND                                 394.85     NA     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 9  NLD                                 497.64 499.59 501.68 504.01 </span>
<span class=gp>#</span><span class=c1>## 10 KOR                                 504.92 506.97 508.91 510.77</span>
</code></pre></td></tr></table>
</div>
</div><p>If we want to recode missing values in a single data frame variable, we can subset for the missing value in that specific variable of interest and then assign it the replacement value. For example, in the following example, we will recode the missing value in col4 with the mean value of col4.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## data frame with missing data</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=kc>NA</span><span class=p>),</span>
                 <span class=n>col2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;this&#34;</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span><span class=s>&#34;is&#34;</span><span class=p>,</span> <span class=s>&#34;text&#34;</span><span class=p>),</span> 
                 <span class=n>col3</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span> 
                 <span class=n>col4</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>2.5</span><span class=p>,</span> <span class=m>4.2</span><span class=p>,</span> <span class=m>3.2</span><span class=p>,</span> <span class=kc>NA</span><span class=p>))</span>

<span class=c1>## recode the missing value in col4 with the mean value of col4</span>

<span class=n>df</span><span class=o>$</span><span class=n>col4</span><span class=nf>[is.na</span><span class=p>(</span><span class=n>df</span><span class=o>$</span><span class=n>col4</span><span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>df</span><span class=o>$</span><span class=n>col4</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2  col3 col4</span>
<span class=gp>#</span><span class=c1>## 1    1 this  TRUE  2.5</span>
<span class=gp>#</span><span class=c1>## 2    2 &lt;NA&gt; FALSE  4.2</span>
<span class=gp>#</span><span class=c1>## 3    3   is  TRUE  3.2</span>
<span class=gp>#</span><span class=c1>## 4   NA text  TRUE  3.3</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that, replace_na() function from tidyr package can also be used to replace NA values. For more information and examples see <a href=https://tidyr.tidyverse.org/reference/replace_na.html target=_blank rel="noopener noreferrer"><strong>here</strong></a>.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># Replace NAs in a data frame</span>
<span class=go>df &lt;- tibble(x = c(1, 2, NA), y = c(&#34;a&#34;, NA, &#34;b&#34;))
</span><span class=go>df %&gt;% replace_na(list(x = 0, y = &#34;unknown&#34;))
</span><span class=go></span><span class=gp>#</span><span class=c1>#&gt; # A tibble: 3 x 2</span>
<span class=gp>#</span><span class=c1>#&gt;       x y      </span>
<span class=gp>#</span><span class=c1>#&gt;   &lt;dbl&gt; &lt;chr&gt;  </span>
<span class=gp>#</span><span class=c1>#&gt; 1     1 a      </span>
<span class=gp>#</span><span class=c1>#&gt; 2     2 unknown</span>
<span class=gp>#</span><span class=c1>#&gt; 3     0 b      </span>
<span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># Replace NAs in a vector</span>
<span class=go>df %&gt;% dplyr::mutate(x = replace_na(x, 0))
</span><span class=go></span><span class=gp>#</span><span class=c1>#&gt; # A tibble: 3 x 2</span>
<span class=gp>#</span><span class=c1>#&gt;       x y    </span>
<span class=gp>#</span><span class=c1>#&gt;   &lt;dbl&gt; &lt;chr&gt;</span>
<span class=gp>#</span><span class=c1>#&gt; 1     1 a    </span>
<span class=gp>#</span><span class=c1>#&gt; 2     2 NA   </span>
<span class=gp>#</span><span class=c1>#&gt; 3     0 b    </span>
<span class=gp>#</span><span class=c1># OR</span>
<span class=go>df$x %&gt;% replace_na(0)
</span><span class=go></span><span class=gp>#</span><span class=c1>#&gt; [1] 1 2 0</span>
<span class=go>df$y %&gt;% replace_na(&#34;unknown&#34;)
</span><span class=go></span><span class=gp>#</span><span class=c1>#&gt; [1] &#34;a&#34;       &#34;unknown&#34; &#34;b&#34;      </span>
<span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># Replace NULLs in a list: NULLs are the list-col equivalent of NAs</span>
<span class=go>df_list &lt;- tibble(z = list(1:5, NULL, 10:20))
</span><span class=go>df_list %&gt;% replace_na(list(z = list(5)))
</span><span class=go></span><span class=gp>#</span><span class=c1>#&gt; # A tibble: 3 x 1</span>
<span class=gp>#</span><span class=c1>#&gt;   z         </span>
<span class=gp>#</span><span class=c1>#&gt;   &lt;list&gt;    </span>
<span class=gp>#</span><span class=c1>#&gt; 1 &lt;int [5]&gt; </span>
<span class=gp>#</span><span class=c1>#&gt; 2 &lt;dbl [1]&gt; </span>
<span class=gp>#</span><span class=c1>#&gt; 3 &lt;int [11]&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=excluding-missing-data>Excluding Missing Data</h3>
<p>A common method of handling missing values is simply to omit the records or fields with missing values from the analysis. However, this may be dangerous, since the pattern of missing values may in fact be systematic, and simply deleting records with missing values would lead to a biased subset of the data.</p>
<p>Some authors recommend that if the amount of missing data is very small relatively to the size of the data set (up to 5%), then leaving out the few values with missing features would be the best strategy in order not to bias the analysis. When this is the case, we can exclude missing values in a couple different ways.
If we want to exclude missing values from mathematical operations, we can use the na.rm = TRUE argument. If you do not exclude these values, most functions will return an NA. Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a vector with missing values</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>4</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>6</span><span class=o>:</span><span class=m>7</span><span class=p>,</span> <span class=kc>NA</span><span class=p>)</span>

<span class=c1>## including NA values will produce an NA output when used with mathematical operations</span>

<span class=nf>mean</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] NA</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## excluding NA values will calculate the mathematical operation for all non-missing values</span>

<span class=nf>mean</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] 3.833333</span>
</code></pre></td></tr></table>
</div>
</div><p>We may also want to subset our data to obtain complete observations (those observations in our data that contain no missing data). We can do this a few different ways.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## data frame with missing values</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span> <span class=kc>NA</span><span class=p>),</span>
                 <span class=n>col2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;this&#34;</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span><span class=s>&#34;is&#34;</span><span class=p>,</span> <span class=s>&#34;text&#34;</span><span class=p>),</span> 
                 <span class=n>col3</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span> 
                 <span class=n>col4</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>2.5</span><span class=p>,</span> <span class=m>4.2</span><span class=p>,</span> <span class=m>3.2</span><span class=p>,</span> <span class=kc>NA</span><span class=p>))</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2  col3 col4</span>
<span class=gp>#</span><span class=c1>## 1    1 this  TRUE  2.5</span>
<span class=gp>#</span><span class=c1>## 2    2 &lt;NA&gt; FALSE  4.2</span>
<span class=gp>#</span><span class=c1>## 3    3   is  TRUE  3.2</span>
<span class=gp>#</span><span class=c1>## 4   NA text  TRUE   NA</span>
</code></pre></td></tr></table>
</div>
</div><p>First, to find complete cases we can leverage the complete.cases() function which returns a logical vector identifying rows which are complete cases. So, in the following case rows 1 and 3 are complete cases. We can use this information to subset our data frame which will return the rows which complete.cases() found to be TRUE.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  TRUE FALSE  TRUE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## subset data frame with complete.cases to get only complete cases</span>

<span class=n>df</span><span class=nf>[complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2 col3 col4</span>
<span class=gp>#</span><span class=c1>## 1    1 this TRUE  2.5</span>
<span class=gp>#</span><span class=c1>## 3    3   is TRUE  3.2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## or subset with `!` operator to get incomplete cases</span>

<span class=n>df[</span><span class=o>!</span><span class=nf>complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2  col3 col4</span>
<span class=gp>#</span><span class=c1>## 2    2 &lt;NA&gt; FALSE  4.2</span>
<span class=gp>#</span><span class=c1>## 4   NA text  TRUE   NA</span>
</code></pre></td></tr></table>
</div>
</div><p>A shorthand alternative approach is to simply use na.omit() to omit all rows containing missing values.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## or use na.omit() to get same as above</span>

<span class=nf>na.omit</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2 col3 col4</span>
<span class=gp>#</span><span class=c1>## 1    1 this TRUE  2.5</span>
<span class=gp>#</span><span class=c1>## 3    3   is TRUE  3.2</span>
</code></pre></td></tr></table>
</div>
</div><p>However, it seems like a waste to omit the information in all the other fields just because one field value is missing. Therefore, data analysts should carefully approach to excluding missing values especially when the amount of missing data is very large.
Another recommended approach is to replace the missing value with a value substituted according to various criteria. These approaches will be given in the next section.</p>
<h3 id=basic-missing-value-imputation-techniques>Basic Missing Value Imputation Techniques</h3>
<p>Imputation is the process of estimating or deriving values for fields where data is missing. There is a vast body of literature on imputation methods and it goes beyond the scope of this course to discuss all of them. In this section I will provide basic missing value imputation techniques only.</p>
<h4 id=replace-the-missing-values-with-some-constant-specified-by-the-analyst>Replace the missing value(s) with some constant, specified by the analyst</h4>
<p>In some cases, a missing value can be determined because the observed values combined with their constraints force a unique solution. As an example, consider the following data frame listing the costs for staff, cleaning, housing and the total total for three months.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>month</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>),</span>
                 <span class=n>staff</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>15000</span> <span class=p>,</span> <span class=m>20000</span><span class=p>,</span> <span class=m>23000</span><span class=p>),</span> 
                 <span class=n>cleaning</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>100</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>500</span><span class=p>),</span> 
                 <span class=n>housing</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>300</span><span class=p>,</span> <span class=m>200</span><span class=p>,</span> <span class=kc>NA</span><span class=p>),</span>
                 <span class=n>total</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>20500</span><span class=p>,</span> <span class=m>24000</span><span class=p>))</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   month staff cleaning housing total</span>
<span class=gp>#</span><span class=c1>## 1     1 15000      100     300    NA</span>
<span class=gp>#</span><span class=c1>## 2     2 20000       NA     200 20500</span>
<span class=gp>#</span><span class=c1>## 3     3 23000      500      NA 24000</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, assume that we have the following rules for the calculation of total cost: staff + cleaning + housing = total and all costs > 0. Therefore, if one of the variables is missing, we can clearly derive the missing values by solving the rule. For this example, first month’s total cost can be found as 15000 + 100 + 300 = 15400. Other missing values can be found in a similar way.
The deducorrect and validate packages have a number of functions available that can impute (and correct) the values according to the given rules automatically for a given data frame.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;deductive&#34;)</span>
<span class=c1>##install.packages(&#34;validate&#34;)</span>

<span class=nf>library</span><span class=p>(</span><span class=n>deductive</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>validate</span><span class=p>)</span>
<span class=c1>## Define the rules as a validator expression</span>

<span class=n>Rules</span> <span class=o>&lt;-</span> <span class=nf>validator</span><span class=p>(</span> <span class=n>staff</span> <span class=o>+</span> <span class=n>cleaning</span> <span class=o>+</span> <span class=n>housing</span> <span class=o>==</span> <span class=n>total</span><span class=p>,</span>
                              <span class=n>staff</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>,</span>
                              <span class=n>housing</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>,</span>
                              <span class=n>cleaning</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>)</span>

<span class=c1>## Use impute_lr function</span>

<span class=n>imputed_df</span> <span class=o>&lt;-</span> <span class=nf>impute_lr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span><span class=n>Rules</span><span class=p>)</span>

<span class=n>imputed_df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   month staff cleaning housing total</span>
<span class=gp>#</span><span class=c1>## 1     1 15000      100     300 15400</span>
<span class=gp>#</span><span class=c1>## 2     2 20000      300     200 20500</span>
<span class=gp>#</span><span class=c1>## 3     3 23000      500     500 24000</span>
</code></pre></td></tr></table>
</div>
</div><p>The deducorrect package together with validate provide a collection of powerful methods for automated data cleaning and imputing. For more information on these packages please refer to “Correction of Obvious Inconsistencies and Errors” section of the module notes and the deducorrect package manual and validate package manual.</p>
<h4 id=replace-the-missing-values-with-the-mean-median-or-mode>Replace the missing value(s) with the mean, median or mode</h4>
<p>Replacing the missing value with the mean, median (for numerical variables) or the mode (for categorical variables) is a crude way of treating missing values. The <strong>Hmisc</strong> package has a convenient wrapper function allowing you to specify what function is used to compute imputed values from the non-missing.
Consider the following data frame with missing values:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span> <span class=n>no</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=p>),</span>
                 <span class=n>x1</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>15000</span> <span class=p>,</span> <span class=m>20000</span><span class=p>,</span> <span class=m>23000</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>18000</span><span class=p>,</span> <span class=m>21000</span><span class=p>),</span> 
                 <span class=n>x2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>4</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>4</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>7</span><span class=p>,</span> <span class=m>8</span><span class=p>),</span>
                 <span class=n>x3</span> <span class=o>=</span> <span class=nf>factor</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=s>&#34;False&#34;</span><span class=p>,</span> <span class=s>&#34;False&#34;</span><span class=p>,</span> <span class=s>&#34;False&#34;</span><span class=p>,</span> <span class=s>&#34;True&#34;</span><span class=p>,</span> <span class=s>&#34;True&#34;</span><span class=p>)))</span>
<span class=n>x</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   no    x1 x2    x3</span>
<span class=gp>#</span><span class=c1>## 1  1 15000  4  &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 2  2 20000 NA False</span>
<span class=gp>#</span><span class=c1>## 3  3 23000  4 False</span>
<span class=gp>#</span><span class=c1>## 4  4    NA  5 False</span>
<span class=gp>#</span><span class=c1>## 5  5 18000  7  True</span>
<span class=gp>#</span><span class=c1>## 6  6 21000  8  True</span>
</code></pre></td></tr></table>
</div>
</div><p>For this data frame, imputation of the mean, median and mode can be done using Hmisc package as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;Hmisc&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>Hmisc</span><span class=p>)</span>

<span class=c1>## mean imputation (for numerical variables)</span>

<span class=n>x1</span> <span class=o>&lt;-</span> <span class=nf>impute</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>x1</span><span class=p>,</span> <span class=n>fun</span> <span class=o>=</span> <span class=n>mean</span><span class=p>)</span> 

<span class=n>x1</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      1      2      3      4      5      6 </span>
<span class=gp>#</span><span class=c1>##  15000  20000  23000 19400*  18000  21000</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## median imputation (for numerical variables)</span>

<span class=n>x2</span> <span class=o>&lt;-</span> <span class=nf>impute</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>x2</span><span class=p>,</span> <span class=n>fun</span> <span class=o>=</span> <span class=n>median</span><span class=p>)</span> 

<span class=n>x2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##  1  2  3  4  5  6 </span>
<span class=gp>#</span><span class=c1>##  4 5*  4  5  7  8</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## mode imputation (for categorical/factor variables)</span>

<span class=n>x3</span> <span class=o>&lt;-</span> <span class=nf>impute</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>x3</span><span class=p>,</span> <span class=n>fun</span><span class=o>=</span> <span class=n>mode</span><span class=p>)</span>

<span class=n>x3</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##      1      2      3      4      5      6 </span>
<span class=gp>#</span><span class=c1>## False*  False  False  False   True   True</span>
</code></pre></td></tr></table>
</div>
</div><p>A nice feature of the impute function is that the resulting vector remembers what values were imputed. This information may be requested with is.imputed function as in the example below.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># check which values are imputed</span>
<span class=err>
</span><span class=err></span><span class=go>is.imputed(x1)
</span></code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE FALSE FALSE  TRUE FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>is.imputed</span><span class=p>(</span><span class=n>x2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE  TRUE FALSE FALSE FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>is.imputed</span><span class=p>(</span><span class=n>x3</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  TRUE FALSE FALSE FALSE FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=more-complex-approaches-to-missing-value-imputation>More Complex Approaches to Missing Value Imputation</h4>
<p>Another strategy is to use predictive models to impute the missing data. There are many different predictive models and algorithms to predict and impute the missing values. Regression analysis, multiple imputation methods, random forests, k nearest neighbours, last observation carried forward / next observation carried backward, etc. are only some of these techniques. In R, there are many different packages (e.g., mice, missForest, impute etc.) that can be used to predict and impute the missing data.</p>
<p>For the detailed information on the missing value imputation please refer to the “<a href="https://primo-direct-apac.hosted.exlibrisgroup.com/primo-explore/fulldisplay?docid=RMIT_ALMA2137428490001341&context=L&vid=RMITU&search_scope=Books_articles_and_more&isFrbr=true&tab=default_tab&lang=en_US" target=_blank rel="noopener noreferrer">Statistical analysis with missing data (Little and Rubin (2014))</a>” for the theory behind the missing value mechanism and analysis. For multiple imputation techniques and case studies using R, please refer to “<a href="https://primo-direct-apac.hosted.exlibrisgroup.com/primo-explore/fulldisplay?docid=RMIT_ALMA5159878830001341&context=L&vid=RMITU&search_scope=Books_articles_and_more&tab=default_tab&lang=en_US" target=_blank rel="noopener noreferrer">Flexible imputation of missing data (Van Buuren (2012))</a>”.</p>
<h3 id=special-values>Special values</h3>
<p>In addition to missing values, there are a few special values that are used in R. These are <strong>-Inf</strong>, <strong>Inf</strong> and <strong>NaN</strong>.
If a computation results in a number that is too big, R will return <strong>Inf</strong> (meaning positive infinity) for a positive number and <strong>-Inf</strong> for a negative number (meaning negative infinity). Here are some examples:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R> <span class=m>3</span> <span class=n>^</span> <span class=m>1024</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] Inf</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R> <span class=m>-3</span> <span class=n>^</span> <span class=m>1024</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] -Inf</span>
</code></pre></td></tr></table>
</div>
</div><p>This is also the value returned when you divide by 0:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=m>12</span> <span class=o>/</span> <span class=m>0</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] Inf</span>
</code></pre></td></tr></table>
</div>
</div><p>Sometimes, a computation will produce a result that makes little sense. In these cases, R will often return NaN (meaning “not a number”):</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=kc>Inf</span> <span class=o>-</span> <span class=kc>Inf</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] NaN</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=m>0</span><span class=o>/</span><span class=m>0</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] NaN</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=identifying-special-values>Identifying Special Values</h3>
<p>Calculations involving special values often result in special values, thus it is important to handle special values prior to analysis. The <strong>is.finite</strong>, <strong>is.infinite</strong>, or <strong>is.nan</strong> functions will generate logical values (TRUE or FALSE) and they can be used to identify the special values in a data set.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a vector with special values</span>

<span class=n>m</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>1</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=o>-</span><span class=kc>Inf</span><span class=p>,</span> <span class=kc>Inf</span><span class=p>,</span> <span class=p>(</span><span class=kc>Inf</span><span class=o>*</span><span class=m>2</span><span class=p>)</span> <span class=p>)</span>
<span class=n>m</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]    2  NaN   NA  Inf -Inf  Inf  Inf</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check finite values</span>

<span class=nf>is.finite</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check infinite (-inf or +inf) values</span>

<span class=nf>is.infinite</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check not a number (NaN) values</span>

<span class=nf>is.nan</span><span class=p>(</span><span class=n>m</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a data frame containing special values</span>

<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>col1</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span> <span class=m>2</span><span class=p>,</span> <span class=m>0</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=m>1</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=o>-</span><span class=kc>Inf</span><span class=p>,</span> <span class=kc>Inf</span><span class=p>),</span>
                 <span class=n>col2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span> <span class=kc>NA</span><span class=p>,</span> <span class=kc>Inf</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=m>2</span><span class=o>/</span><span class=m>0</span><span class=p>,</span> <span class=kc>NaN</span><span class=p>,</span> <span class=o>-</span><span class=kc>Inf</span><span class=p>,</span> <span class=m>4</span><span class=p>))</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2</span>
<span class=gp>#</span><span class=c1>## 1    2   NA</span>
<span class=gp>#</span><span class=c1>## 2  NaN  Inf</span>
<span class=gp>#</span><span class=c1>## 3   NA  Inf</span>
<span class=gp>#</span><span class=c1>## 4  Inf  NaN</span>
<span class=gp>#</span><span class=c1>## 5 -Inf -Inf</span>
<span class=gp>#</span><span class=c1>## 6  Inf    4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check whether dataframe has infinite (-inf or +inf) values</span>

<span class=nf>is.infinite</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>

<span class=c1>## Error in is.infinite(df) : default method not implemented for type &#39;list&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>These functions accept vectorial input, therefore you will receive an error when you try to use it with a data frame. In such cases, we can use apply family functions.</p>
<h4 id=remark-useful-apply-family-functions>Remark: Useful apply family functions</h4>
<p>The apply family functions will apply a specified function to a given data object (e.g. vectors, lists, matrices, data frames). Most common forms of apply functions are:</p>
<ul>
<li>apply() for matrices and data frames</li>
<li>lapply() for lists (output as list)</li>
<li>sapply() for lists (output simplified)</li>
<li>tapply() for vectors</li>
<li>… many others</li>
</ul>
<p>There is a very useful and <a href=https://www.datacamp.com/community/tutorials/r-tutorial-apply-family target=_blank rel="noopener noreferrer">comprehensive tutorial on apply family functions</a> in DataCamp. Please read this tutorial for more information on the usage of apply family. You can also use swirl() to practice apply family functions. In swirl(), “R Programming Course” Lesson 10 and 11 cover the apply family functions.</p>
<p>Among those apply functions, sapply and lapply functions can apply any function to a list. Remember from Module 3 that data frames possess the characteristics of both lists and matrices. Therefore, we can use sapply or lappy for data frames.</p>
<p>Now for the previous example, let’s use sapply function:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2</span>
<span class=gp>#</span><span class=c1>## 1    2   NA</span>
<span class=gp>#</span><span class=c1>## 2  NaN  Inf</span>
<span class=gp>#</span><span class=c1>## 3   NA  Inf</span>
<span class=gp>#</span><span class=c1>## 4  Inf  NaN</span>
<span class=gp>#</span><span class=c1>## 5 -Inf -Inf</span>
<span class=gp>#</span><span class=c1>## 6  Inf    4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## check whether dataframe has infinite (-inf or +inf) values using sapply</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>is.infinite</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       col1  col2</span>
<span class=gp>#</span><span class=c1>## [1,] FALSE FALSE</span>
<span class=gp>#</span><span class=c1>## [2,] FALSE  TRUE</span>
<span class=gp>#</span><span class=c1>## [3,] FALSE  TRUE</span>
<span class=gp>#</span><span class=c1>## [4,]  TRUE FALSE</span>
<span class=gp>#</span><span class=c1>## [5,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [6,]  TRUE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>By using sapply we could see the infinite values in the data frame. Now remember that is.infinite function doesn’t check for NaN numbers. Therefore, we also need to check the data frame for NaN values. In order to do that, we can write a simple function to check every numerical column in a data frame for infinite values or NaN’s.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## data frame</span>

<span class=n>df</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   col1 col2</span>
<span class=gp>#</span><span class=c1>## 1    2   NA</span>
<span class=gp>#</span><span class=c1>## 2  NaN  Inf</span>
<span class=gp>#</span><span class=c1>## 3   NA  Inf</span>
<span class=gp>#</span><span class=c1>## 4  Inf  NaN</span>
<span class=gp>#</span><span class=c1>## 5 -Inf -Inf</span>
<span class=gp>#</span><span class=c1>## 6  Inf    4</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Check every numerical column whether they have infinite or NaN values using a function called is.special</span>

<span class=n>is.special</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>){</span>
<span class=nf>if </span><span class=p>(</span><span class=nf>is.numeric</span><span class=p>(</span><span class=n>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>is.infinite</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>|</span> <span class=nf>is.nan</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
<span class=p>}</span>

<span class=c1>## apply this function to the data frame.</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>is.special</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       col1  col2</span>
<span class=gp>#</span><span class=c1>## [1,] FALSE FALSE</span>
<span class=gp>#</span><span class=c1>## [2,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [3,] FALSE  TRUE</span>
<span class=gp>#</span><span class=c1>## [4,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [5,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [6,]  TRUE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>Here, the is.special function is applied to each column of df using sapply. is.special checks the data frame for numerical special values if the type is numeric. Using a similar approach you can also check for special values or NA’s at the same time using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Check every numerical column whether they have infinite or NaN or NA values using a function called is.specialorNA</span>

<span class=n>is.specialorNA</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>){</span>
<span class=nf>if </span><span class=p>(</span><span class=nf>is.numeric</span><span class=p>(</span><span class=n>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>is.infinite</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>|</span> <span class=nf>is.nan</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>|</span> <span class=nf>is.na</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
<span class=p>}</span>

<span class=c1>## apply this function to the data frame.</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>is.specialorNA</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       col1  col2</span>
<span class=gp>#</span><span class=c1>## [1,] FALSE  TRUE</span>
<span class=gp>#</span><span class=c1>## [2,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [3,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [4,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [5,]  TRUE  TRUE</span>
<span class=gp>#</span><span class=c1>## [6,]  TRUE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>Especially for big datasets, the output of is.xxxx functions would be very long as it returns TRUE or FALSE values for each row and column in the data frame. To avoid such non-informative and long output you can use sum() function together with is.xxxx functions and apply it to a data frame using lapply or sapply. However, you cannot use (nested) functions inside apply family functions. One solution to this is to write a user defined function inside apply function.</p>
<p>Here is a good example on population_NA data frame:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## a dataset with some NA values</span>

<span class=n>population_NA</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##                                 Region X.2013 X.2014 X.2015  X.2016</span>
<span class=gp>#</span><span class=c1>## 1  ISL                                   3.21   3.25   3.28 3.32   </span>
<span class=gp>#</span><span class=c1>## 2  CAN                                   3.87   3.91   3.94 3.99   </span>
<span class=gp>#</span><span class=c1>## 3  RUS                                   7.83   7.85   7.87    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 4  COL                                  41.27  41.74     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 5  ZAF                                  43.53  44.22     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 6  LTU                                  47.42  46.96  46.63 46.11  </span>
<span class=gp>#</span><span class=c1>## 7  MEX                                  60.43  61.10  61.76 62.41  </span>
<span class=gp>#</span><span class=c1>## 8  IND                                 394.85     NA     NA    &lt;NA&gt;</span>
<span class=gp>#</span><span class=c1>## 9  NLD                                 497.64 499.59 501.68 504.01 </span>
<span class=gp>#</span><span class=c1>## 10 KOR                                 504.92 506.97 508.91 510.77</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## let&#39;s check whether the data frame has NA values using sapply</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>population_NA</span><span class=p>,</span> <span class=n>is.na</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       Region X.2013 X.2014 X.2015 X.2016</span>
<span class=gp>#</span><span class=c1>##  [1,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
<span class=gp>#</span><span class=c1>##  [2,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
<span class=gp>#</span><span class=c1>##  [3,]  FALSE  FALSE  FALSE  FALSE   TRUE</span>
<span class=gp>#</span><span class=c1>##  [4,]  FALSE  FALSE  FALSE   TRUE   TRUE</span>
<span class=gp>#</span><span class=c1>##  [5,]  FALSE  FALSE  FALSE   TRUE   TRUE</span>
<span class=gp>#</span><span class=c1>##  [6,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
<span class=gp>#</span><span class=c1>##  [7,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
<span class=gp>#</span><span class=c1>##  [8,]  FALSE  FALSE   TRUE   TRUE   TRUE</span>
<span class=gp>#</span><span class=c1>##  [9,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
<span class=gp>#</span><span class=c1>## [10,]  FALSE  FALSE  FALSE  FALSE  FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>We can avoid long output and calculate the total number of missing values for each column using sum() and is.na() functions.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Note that the code given below would throw an error</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>population_NA</span><span class=p>,</span> <span class=nf>sum</span><span class=p>(</span><span class=nf>is.na</span><span class=p>()))</span>

<span class=c1>## Error in is.na() : 0 arguments passed to &#39;is.na&#39; which requires 1</span>
</code></pre></td></tr></table>
</div>
</div><p>Instead you can write your own function inside sapply() and calculate the total missing values for each column:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>sapply</span><span class=p>(</span><span class=n>population_NA</span><span class=p>,</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=nf>sum</span><span class=p>(</span> <span class=nf>is.na</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## Region X.2013 X.2014 X.2015 X.2016 </span>
<span class=gp>#</span><span class=c1>##      0      0      1      3      4</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=optional-reading-checking-for-obvious-inconsistencies-or-errors>Optional Reading: Checking for Obvious Inconsistencies or Errors</h3>
<p>An obvious inconsistency occurs when a data record contains a value or combination of values that cannot correspond to a real-world situation. For example, a person’s age cannot be negative, a man cannot be pregnant, and an under-aged person cannot possess a drivers’ license. Such knowledge can be expressed as rules or constraints. In data preprocessing literature these rules are referred to as edit rules or edits, in short. Checking for obvious inconsistencies can be done straightforwardly in R using logical indices.
For example, to check which elements of x obey the rule: “x must be non-negative” one can simply use the following.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## create a vector called x</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span> <span class=m>0</span><span class=p>,</span> <span class=m>-2</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>5</span><span class=p>)</span>

<span class=c1>## check the non-negative elements</span>

<span class=n>x_nonnegative</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>)</span>

<span class=n>x_nonnegative</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## [1]  TRUE FALSE  TRUE  TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>However, as the number of variables increases, the number of rules may increase, and it may be a good idea to manage the rules separate from the data. For such cases, the <strong>editrules</strong> package allows us to define rules on categorical, numerical or mixed-type data sets which each record must obey. Furthermore, editrules can check which rules are obeyed or not and allows one to find the minimal set of variables to adapt so that all rules can be obeyed. This package also implements several basic rule operations allowing users to test rule sets for contradictions and certain redundancies.</p>
<p>To illustrate I will use a small data set (datawitherrors.csv) given below:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>datawitherrors</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/datawitherrors.csv&#34;</span><span class=p>)</span>

<span class=n>datawitherrors</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   ï..no age agegroup height  status yearsmarried</span>
<span class=gp>#</span><span class=c1>## 1     1  21    adult    178  single           -1</span>
<span class=gp>#</span><span class=c1>## 2     2   2    child    147 married            0</span>
<span class=gp>#</span><span class=c1>## 3     3  18    adult    167 married           20</span>
<span class=gp>#</span><span class=c1>## 4     4 221  elderly    154 widowed            2</span>
<span class=gp>#</span><span class=c1>## 5     5  34    child   -174 married            3</span>
</code></pre></td></tr></table>
</div>
</div><p>As you noticed, there are many inconsistencies/errors in this small data set (i.e., age = 221, height = -174, years married = -1, etc.) . To begin with a simple case, let’s define a restriction on the age variable using editset functions. In order to use editset functions, we need to install and load the editrules package.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;editrules&#34;)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>editrules</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>In the first rule, we will define the restriction on the age variable as $ 0 age 150 $ using editset function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=p>(</span><span class=n>Rule1</span> <span class=o>&lt;-</span> <span class=nf>editset</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;age &gt;= 0&#34;</span><span class=p>,</span> <span class=s>&#34;age &lt;= 150&#34;</span><span class=p>)))</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## Edit set:</span>
<span class=gp>#</span><span class=c1>## num1 : 0 &lt;= age</span>
<span class=gp>#</span><span class=c1>## num2 : age &lt;= 150</span>
</code></pre></td></tr></table>
</div>
</div><p>The editset function parses the textual rules and stores them in an editset object. Each rule is assigned a name according to its type (numeric, categorical, or mixed) and a number. The data set can be checked against these rules using the violatedEdits function.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>violatedEdits</span><span class=p>(</span><span class=n>Rule1</span><span class=p>,</span> <span class=n>datawitherrors</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       edit</span>
<span class=gp>#</span><span class=c1>## record  num1  num2</span>
<span class=gp>#</span><span class=c1>##      1 FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      2 FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      3 FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      4 FALSE  TRUE</span>
<span class=gp>#</span><span class=c1>##      5 FALSE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>violatedEdits returns a logical array indicating for each row of the data, which rules are violated. From the output, it can be understood that the 4th record violates the second rule (age &lt;= 150).
One can also read rules, directly from a text file using the editfile function. As an example, consider the contents of the following text file (also available here):</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>1 # numerical rules
2 age &gt;= 0
3 height &gt; 0
4 age &lt;= 150
5 age &gt; yearsmarried
6
7 # categorical rules
8 status %in% c(“married”,“single”,“widowed”)
9 agegroup %in% c(“child”,“adult”,“elderly”)
10 if ( status == “married” ) agegroup %in% c(“adult”,“elderly”)
11
12 # mixed rules
13 if ( status %in% c(“married”,“widowed”)) age - yearsmarried &gt;= 17
14 if ( age &lt; 18 ) agegroup == “child”
15 if ( age &gt;= 18 &amp;&amp; age &lt;65 ) agegroup == “adult”
16 if ( age &gt;= 65 ) agegroup == “elderly”
</code></pre></td></tr></table>
</div>
</div><p>These rules are numerical, categorical and mixed (both data types). Comments are written behind the usual # character. The rule set can be read using editfile function as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Rules</span> <span class=o>&lt;-</span> <span class=nf>editfile</span><span class=p>(</span><span class=s>&#34;data/editrules.txt&#34;</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;all&#34;</span><span class=p>)</span>

<span class=n>Rules</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## Data model:</span>
<span class=gp>#</span><span class=c1>## dat6 : agegroup %in% c(&#39;adult&#39;, &#39;child&#39;, &#39;elderly&#39;)</span>
<span class=gp>#</span><span class=c1>## dat7 : status %in% c(&#39;married&#39;, &#39;single&#39;, &#39;widowed&#39;) </span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## Edit set:</span>
<span class=gp>#</span><span class=c1>## num1 : 0 &lt;= age</span>
<span class=gp>#</span><span class=c1>## num2 : 0 &lt; height</span>
<span class=gp>#</span><span class=c1>## num3 : age &lt;= 150</span>
<span class=gp>#</span><span class=c1>## num4 : yearsmarried &lt; age</span>
<span class=gp>#</span><span class=c1>## cat5 : if( agegroup == &#39;child&#39; ) status != &#39;married&#39;</span>
<span class=gp>#</span><span class=c1>## mix6 : if( age &lt; yearsmarried + 17 ) !( status %in% c(&#39;married&#39;, &#39;widowed&#39;) )</span>
<span class=gp>#</span><span class=c1>## mix7 : if( age &lt; 18 ) !( agegroup %in% c(&#39;adult&#39;, &#39;elderly&#39;) )</span>
<span class=gp>#</span><span class=c1>## mix8 : if( 18 &lt;= age &amp; age &lt; 65 ) !( agegroup %in% c(&#39;child&#39;, &#39;elderly&#39;) )</span>
<span class=gp>#</span><span class=c1>## mix9 : if( 65 &lt;= age ) !( agegroup %in% c(&#39;adult&#39;, &#39;child&#39;) )</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>violatedEdits</span><span class=p>(</span><span class=n>Rules</span><span class=p>,</span> <span class=n>datawitherrors</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##       edit</span>
<span class=gp>#</span><span class=c1>## record  num1  num2  num3  num4  dat6  dat7  cat5  mix6  mix7  mix8  mix9</span>
<span class=gp>#</span><span class=c1>##      1 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      2 FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      3 FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      4 FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class=gp>#</span><span class=c1>##      5 FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE</span>
</code></pre></td></tr></table>
</div>
</div><p>As the number of rules grows, looking at the full array produced by violatedEdits becomes complicated. For this reason, editrules offers methods to summarise or visualise the result as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Violated</span> <span class=o>&lt;-</span> <span class=nf>violatedEdits</span><span class=p>(</span><span class=n>Rules</span><span class=p>,</span> <span class=n>datawitherrors</span><span class=p>)</span>

<span class=c1>## summary of violated rules</span>

<span class=nf>summary</span><span class=p>(</span><span class=n>Violated</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## Edit violations, 5 observations, 0 completely missing (0%):</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>##  editname freq rel</span>
<span class=gp>#</span><span class=c1>##      cat5    2 40%</span>
<span class=gp>#</span><span class=c1>##      mix6    2 40%</span>
<span class=gp>#</span><span class=c1>##      num2    1 20%</span>
<span class=gp>#</span><span class=c1>##      num3    1 20%</span>
<span class=gp>#</span><span class=c1>##      num4    1 20%</span>
<span class=gp>#</span><span class=c1>##      mix8    1 20%</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## Edit violations per record:</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>##  errors freq rel</span>
<span class=gp>#</span><span class=c1>##       0    1 20%</span>
<span class=gp>#</span><span class=c1>##       1    1 20%</span>
<span class=gp>#</span><span class=c1>##       2    2 40%</span>
<span class=gp>#</span><span class=c1>##       3    1 20%</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## plot of violated rules</span>

<span class=nf>plot</span><span class=p>(</span><span class=n>Violated</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1619040108/MATH2349/Module5/ViolatedFrequency_cs8twl.png></p>
<p>Using the functions available in editrules package, users can detect the obvious errors and/or inconsistencies in the data set and define edit rules to identify the inconsistent records.
Moreover, analysts may need to correct the obvious errors and/or inconsistencies in a data set. In the next section, I will introduce the deducorrect package (it is a former version of deductive package) functions to correct the obvious errors and inconsistencies.</p>
<h3 id=optional-reading-correction-of-obvious-inconsistencies-or-errors>Optional Reading: Correction of Obvious Inconsistencies or Errors</h3>
<p>When the data you are analysing is generated by people rather than machines or measurement devices, certain typical human-generated errors are likely to occur. Given that data must obey certain edit rules, the occurrence of such errors can sometimes be detected from raw data with (almost) certainty. Examples of errors that can be detected are typing errors in numbers, rounding errors in numbers, and sign errors.</p>
<p>The deducorrect package has several functions available that can correct such errors. Consider the following data frame (datawitherrors2.csv):</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>datawitherrors2</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/datawitherrors2.csv&#34;</span><span class=p>)</span>

<span class=n>datawitherrors2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   no height unit</span>
<span class=gp>#</span><span class=c1>## 1  1 178.00   cm</span>
<span class=gp>#</span><span class=c1>## 2  2   1.47    m</span>
<span class=gp>#</span><span class=c1>## 3  3  70.00 inch</span>
<span class=gp>#</span><span class=c1>## 4  4 154.00   cm</span>
<span class=gp>#</span><span class=c1>## 5  5   5.92   ft</span>
</code></pre></td></tr></table>
</div>
</div><p>The task here is to standardise the lengths and express all of them in meters. The deducorrect package can correct this inconsistency using correctionRules function. For example, to perform the above task, one first specifies a file with correction rules as follows.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>1 # convert centimeters
2 if ( unit == “cm” ){
3 height &lt;- height/100
4 }
5 # convert inches
6 if (unit == “inch” ){
7 height &lt;- height/39.37
8 }
9 # convert feet
10 if (unit == “ft” ){
11 height &lt;- height/3.28
12 }
13 # set all units to meter
14 unit &lt;- “m”
</code></pre></td></tr></table>
</div>
</div><p>With correctionRules we can read these rules from the txt file using .file argument.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##install.packages(&#34;deducorrect&#34;)</span>

<span class=nf>library</span><span class=p>(</span><span class=n>deducorrect</span><span class=p>)</span>
<span class=c1>## read rules from txt file using validate</span>

<span class=n>Rules2</span> <span class=o>&lt;-</span> <span class=nf>correctionRules</span><span class=p>(</span><span class=s>&#34;data/editrules2.txt&#34;</span><span class=p>)</span>

<span class=n>Rules2</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## Object of class &#39;correctionRules&#39;</span>
<span class=gp>#</span><span class=c1>## ##  1-------</span>
<span class=gp>#</span><span class=c1>##   if (unit == &#34;cm&#34;) height &lt;- height/100 </span>
<span class=gp>#</span><span class=c1>## ##  2-------</span>
<span class=gp>#</span><span class=c1>##   if (unit == &#34;inch&#34;) height &lt;- height/39.37 </span>
<span class=gp>#</span><span class=c1>## ##  3-------</span>
<span class=gp>#</span><span class=c1>##   if (unit == &#34;ft&#34;) height &lt;- height/3.28 </span>
<span class=gp>#</span><span class=c1>## ##  4-------</span>
<span class=gp>#</span><span class=c1>##   unit &lt;- &#34;m&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Now, we can apply them to the data frame and obtain a log of all actual changes as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>cor</span> <span class=o>&lt;-</span> <span class=nf>correctWithRules</span><span class=p>(</span><span class=n>Rules2</span><span class=p>,</span> <span class=n>datawitherrors2</span><span class=p>)</span>

<span class=n>cor</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>## $corrected</span>
<span class=gp>#</span><span class=c1>##   no   height unit</span>
<span class=gp>#</span><span class=c1>## 1  1 1.780000    m</span>
<span class=gp>#</span><span class=c1>## 2  2 1.470000    m</span>
<span class=gp>#</span><span class=c1>## 3  3 1.778004    m</span>
<span class=gp>#</span><span class=c1>## 4  4 1.540000    m</span>
<span class=gp>#</span><span class=c1>## 5  5 1.804878    m</span>
<span class=gp>#</span><span class=c1>## </span>
<span class=gp>#</span><span class=c1>## $corrections</span>
<span class=gp>#</span><span class=c1>##   row variable  old      new                                        how</span>
<span class=gp>#</span><span class=c1>## 1   1   height  178     1.78     if (unit == &#34;cm&#34;) height &lt;- height/100</span>
<span class=gp>#</span><span class=c1>## 2   1     unit   cm        m                                unit &lt;- &#34;m&#34;</span>
<span class=gp>#</span><span class=c1>## 3   3   height   70 1.778004 if (unit == &#34;inch&#34;) height &lt;- height/39.37</span>
<span class=gp>#</span><span class=c1>## 4   3     unit inch        m                                unit &lt;- &#34;m&#34;</span>
<span class=gp>#</span><span class=c1>## 5   4   height  154     1.54     if (unit == &#34;cm&#34;) height &lt;- height/100</span>
<span class=gp>#</span><span class=c1>## 6   4     unit   cm        m                                unit &lt;- &#34;m&#34;</span>
<span class=gp>#</span><span class=c1>## 7   5   height 5.92 1.804878    if (unit == &#34;ft&#34;) height &lt;- height/3.28</span>
<span class=gp>#</span><span class=c1>## 8   5     unit   ft        m                                unit &lt;- &#34;m&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>The returned value, cor$corrected will give a list containing the corrected data as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>cor</span><span class=o>$</span><span class=n>corrected</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>##   no   height unit</span>
<span class=gp>#</span><span class=c1>## 1  1 1.780000    m</span>
<span class=gp>#</span><span class=c1>## 2  2 1.470000    m</span>
<span class=gp>#</span><span class=c1>## 3  3 1.778004    m</span>
<span class=gp>#</span><span class=c1>## 4  4 1.540000    m</span>
<span class=gp>#</span><span class=c1>## 5  5 1.804878    m</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=additional-resources-and-further-reading-3>Additional Resources and Further Reading</h3>
<p>As mentioned before, the missing value analysis and the missing value imputation are broader concepts that would be a standalone topic of another course. Interested readers may refer to the “<a href="https://primo-direct-apac.hosted.exlibrisgroup.com/primo-explore/fulldisplay?docid=RMIT_ALMA2137428490001341&context=L&vid=RMITU&search_scope=Books_articles_and_more&isFrbr=true&tab=default_tab&lang=en_US" target=_blank rel="noopener noreferrer">Statistical analysis with missing data (Little and Rubin (2014))</a>” and “<a href="https://primo-direct-apac.hosted.exlibrisgroup.com/primo-explore/fulldisplay?docid=RMIT_ALMA5159878830001341&context=L&vid=RMITU&search_scope=Books_articles_and_more&tab=default_tab&lang=en_US" target=_blank rel="noopener noreferrer">Flexible imputation of missing data (Van Buuren (2012))</a>” for the theory behind the missing value mechanism and analysis.</p>
<p>There are many good R tutorials for handling missing data using R. “<a href=http://www.jordicasanellas.com/data-science-blog/missing-data-impute-or-do-not-impute-r-examples target=_blank rel="noopener noreferrer">Missing Data: To impute or note to impute?</a>” and “<a href=https://livebook.datascienceheroes.com/data-preparation.html#missing_data target=_blank rel="noopener noreferrer">Data Science Live Book</a>” are only two of them. Moreover, the missForest and mice packages’ manuals provide detailed information on the missing value imputation using random forest algorithm and multiple imputation techniques, respectively.</p>
<p>For checking and correcting errors and inconsistencies in the data, users can refer to the <a href=https://cran.r-project.org/web/packages/deducorrect/deducorrect.pdf target=_blank rel="noopener noreferrer">deducorrect</a> , <a href=https://cran.r-project.org/web/packages/deductive/deductive.pdf target=_blank rel="noopener noreferrer">deductive</a> and <a href=https://cran.r-project.org/web/packages/validate/validate.pdf target=_blank rel="noopener noreferrer">validate</a> packages’ manuals and “<a href=https://cran.r-project.org/doc/contrib/de_Jonge+van_der_Loo-Introduction_to_data_cleaning_with_R.pdf target=_blank rel="noopener noreferrer">An introduction to data cleaning with R (De Jonge and Loo (2013))</a>” discussion paper.</p>
<h3 id=references-3>References</h3>
<p>De Jonge, Edwin, and Mark van der Loo. 2013. “An Introduction to Data Cleaning with R.” Heerlen: Statistics Netherlands.</p>
<p>Little, Roderick JA, and Donald B Rubin. 2014. Statistical Analysis with Missing Data. Vol. 333. John Wiley & Sons.</p>
<p>Van Buuren, Stef. 2012. Flexible Imputation of Missing Data. CRC press.</p>
<h2 id=module-6---scan-outliers>Module 6 - Scan: Outliers</h2>
<h3 id=overview-1>Overview</h3>
<h4 id=summary-4>Summary</h4>
<p>In statistics, an outlier is defined as an observation which stands far away from the most of other observations. An outlier can be a result of a measurement error and the inclusion of that error would have a great impact on the analysis results. Therefore, every data set should be scanned for possible outliers before conducting any statistical analysis. Like missing values, detecting outliers and dealing with them are also crucial in the data preprocessing. In this module, first you will learn how to identify univariate and multivariate outliers using descriptive, graphical and distance-based methods. Then, you will learn different approaches to deal with these values using R.</p>
<h4 id=learning-objectives-5>Learning Objectives</h4>
<p>The learning objectives of this module are as follows:</p>
<ul>
<li>Identify the outlier(s) in the data set.</li>
<li>Apply descriptive methods to identify univariate outliers.</li>
<li>Apply graphical approaches to scan for univariate or multivariate outliers.</li>
<li>Apply distance-based metrics to identify univariate or multivariate outliers.</li>
<li>Learn commonly used approaches to handle outliers.</li>
</ul>
<h3 id=outliers>Outliers</h3>
<p>In statistics, an outlier is defined as an observation which stands far away from most of the other observations. An outlier deviates so much from other observations as to arouse suspicion that is was generated by a different mechanism (Hawkins (1980)). Let’s take an example. Assume that we are interested in customer profiling and we find out that the average annual income of our customers is 800K. But there are two customers having annual income of 3 and 3.2 million dollars. These two customers’ annual income is much higher than rest of the customers (see the boxplot below). These two observations will be seen as outliers.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190535/MATH2349/Module6/incomeOutliers_mbh02m.png></p>
<h4 id=types-of-outliers>Types of Outliers</h4>
<p>Outlier can be univariate and multivariate. Univariate outliers can be found when looking at a distribution of values in a single variable. The example given above is an example of a univariate outlier as we only look at the distribution of income (i.e., one variable) among our customers. On the other hand, multivariate outliers can be found in a n-dimensional space (of n-variables). In order to find them, we need to look at distributions in multi-dimensions.</p>
<p>To illustrate multivariate outliers, let’s assume that we are interested in understanding the relationship between height and weight. Below, we have univariate and bivariate distribution for Height and Weight. When we look at the univariate distributions of Height and Weight (i.e., using boxplots) separately, we don’t spot any abnormal cases (i.e. above and below the $$ 1.5 × IQR $$ fence). However, when we look at the bivariate (two dimensional) distribution of Height and Weight (using scatter plot), we can see that we have one observation whose weight is 45.19 kg and height is 185.09 (on the upper-left side of the scatter plot). This observation is far away from most of the other weight and height combinations thus, will be seen as a multivariate outlier.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190943/MATH2349/Module6/multivariateOutliers_va7ifj.png>
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620190983/MATH2349/Module6/multivariateOutliersTwo_htth3e.png></p>
<h4 id=most-common-causes-of-outliers>Most Common Causes of Outliers</h4>
<p>Often an outlier can be a result of data entry errors, measurement errors, experimental errors, intentional errors, data processing errors or due to the sampling (i.e., sampling error). The following are the most common causes of outliers (taken from: <a href=https://www.analyticsvidhya.com/blog/2016/01/guide-data-exploration/ target=_blank rel="noopener noreferrer">https://www.analyticsvidhya.com/blog/2016/01/guide-data-exploration/</a>)</p>
<ul>
<li><strong>Data Entry Error</strong>: Outliers can arise because of the human errors during data collection, recording, or entry.</li>
<li><strong>Measurement Error</strong>: It is the most common source of outliers. This is caused when the measurement instrument used turns out to be faulty.</li>
<li><strong>Experimental Error</strong>: Another cause of outliers is the experimental error. Experimental errors can arise during data extraction, experiment/survey planning and executing errors.</li>
<li><strong>Intentional Error</strong>: This type of outlier is commonly found in self-reported measures that involves sensitive data. For example, teens would typically under report the amount of alcohol that they consume. Only a fraction of them would report actual value. Here actual values might look like outliers because rest of the teens are under reporting the consumption.</li>
<li><strong>Data Processing Error</strong>: Often, due to the data sets are extracted from multiple sources, it is possible that some manipulation or extraction errors may lead to outliers in the data set.</li>
<li><strong>Sampling Error</strong>: Sometimes, outliers can arise due to the sampling (taking samples from population) process. Typically, this type of outliers can be seen when we take a few observations as a sample.</li>
</ul>
<h3 id=detecting-outliers>Detecting Outliers</h3>
<p>Outliers can drastically change the results of the data analysis and statistical modelling. Some of the unfavourable impacts of outliers are as follows:</p>
<ul>
<li>They increase the error variance.</li>
<li>They reduce the power of statistical tests.</li>
<li>They can bias or influence the estimates of model parameters that may be of substantive interest.</li>
</ul>
<p>Therefore, one of the most important tasks in data preprocessing is to identify and properly handle the outliers.</p>
<p>There are many methods developed for outlier detection. Majority of them deal with numerical data. This module will introduce the most basic ones with their application using R packages.</p>
<h4 id=univariate-outlier-detection-methods>Univariate Outlier Detection Methods</h4>
<p>One of the simplest methods for detecting univariate outliers is the use of boxplots. A boxplot is a graphical display for describing the distribution of the data using the median, the first (Q1) and third quartiles (Q3), and the inter-quartile range (IQR = Q3 − Q1). Below is an illustration of a typical boxplot (taken from [Dr. James Baglin’s Intro to Stats website] (<a href=https://astral-theory-157510.appspot.com/secured/MATH1324_Module_02.html#box_plots%29%29 target=_blank rel="noopener noreferrer">https://astral-theory-157510.appspot.com/secured/MATH1324_Module_02.html#box_plots))</a>.</p>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620191501/MATH2349/Module6/UnivariateOutlierDetectionBoxplot_owyyes.png></p>
<p>In the boxplot, the &ldquo;Tukey’s method of outlier detection&rdquo; is used to detect outliers. According to this method, outliers are defined as the values in the data set that fall beyond the range of $$ −1.5 × IQR $$ to $$ 1.5 × IQR $$. These $$ −1.5 × IQR $$ and $$ 1.5 × IQR $$ limits are called &ldquo;outlier fences&rdquo; and any values lying outside the outlier fences are depicted using an &ldquo;o&rdquo; or a similar symbol on the boxplot.</p>
<p><strong>Note</strong> that Tukey’s method is a <strong>nonparametric</strong> way of detecting outliers, therefore it is mainly used to test outliers in <strong>non-symmetric / non-normal</strong> data distributions.
In order to illustrate the boxplot, we will use the <a href=https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/Diamonds.csv target=_blank rel="noopener noreferrer">Diamonds.csv</a> data set available under the data repository.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Diamonds</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/Diamonds.csv&#34;</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>Diamonds</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#   carat       cut color clarity depth table price    x    y    z</span>
<span class=gp>#</span><span class=c1># 1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43</span>
<span class=gp>#</span><span class=c1># 2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31</span>
<span class=gp>#</span><span class=c1># 3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31</span>
<span class=gp>#</span><span class=c1># 4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63</span>
<span class=gp>#</span><span class=c1># 5  0.31      Good     J     SI2  63.3    58   335 4.34 4.35 2.75</span>
<span class=gp>#</span><span class=c1># 6  0.24 Very Good     J    VVS2  62.8    57   336 3.94 3.96 2.48</span>
</code></pre></td></tr></table>
</div>
</div><p>We can use boxplot() function (under Base graphics) to get the boxplot of the carat variable:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Diamonds</span><span class=o>$</span><span class=n>carat</span> <span class=o>%&gt;%</span>  <span class=nf>boxplot</span><span class=p>(</span><span class=n>main</span><span class=o>=</span><span class=s>&#34;Boxplot of Diamond Carat&#34;</span><span class=p>,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;Carat&#34;</span><span class=p>,</span> <span class=n>col</span> <span class=o>=</span> <span class=s>&#34;grey&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620192006/MATH2349/Module6/boxplot-outliers_hqrxre.png></p>
<p>According to the Tukey’s method, the carat variable seems to have many outliers. In the next section, we will discuss different approaches to handle these outliers.
There are also distance based methods to detect univariate outliers. One of them is to use the z- scores (i.e., normal scores) method. In this method, a standardised score (z-score) of all observations are calculated using the following equation:</p>
<p>$$ z_i = \frac{X_i - \bar{X}}{S} $$</p>
<p>In the equation below, $ X_i $ denotes the values of observations, $ \bar{X} $ and $ S $ are the sample mean and standard deviation, respectively. An observation is regarded as an outlier based on its z-score, if the absolute value of its <strong>z-score is greater than 3</strong>.</p>
<p><strong>Note</strong> that, z-score method is a parametric way of detecting outliers and assumes that the underlying data is normally distributed. Therefore, if the distribution is not approximately normal, this method shouldn’t be used.</p>
<p>In order to illustrate the z-score approach, we will use the &ldquo;outliers package&rdquo;. The outliers package provides several useful functions to systematically extract outliers. Among those, the scores() function will calculate the z-scores (in addition to the t, chi-square, IQR, and Median absolute deviation scores) for the given data. Note that, there are many alternative functions in R for calculating z-scores. You may also use these functions and detect the outliers.
Let’s investigate any outliers in the depth variable using z-score approach. First, we will make sure that the depth distribution is approximately normal. For this purpose we can use histogram (or boxplot()) to check the distribution:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>hist</span><span class=p>(</span><span class=n>Diamonds</span><span class=o>$</span><span class=n>depth</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195380/MATH2349/Module6/histogramOutliers_ffx21h.png></p>
<p>After confirming the depth variable has an approximately normal distribution, we can calculate z scores using outliers package:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>outliers</span><span class=p>)</span>
<span class=n>z.scores</span> <span class=o>&lt;-</span> <span class=n>Diamonds</span><span class=o>$</span><span class=n>depth</span> <span class=o>%&gt;%</span>  <span class=nf>scores</span><span class=p>(</span><span class=n>type</span> <span class=o>=</span> <span class=s>&#34;z&#34;</span><span class=p>)</span>
<span class=n>z.scores</span> <span class=o>%&gt;%</span> <span class=nf>summary</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class=gp>#</span><span class=c1># -13.08748  -0.52310   0.03532   0.00000   0.52393  12.04128</span>
</code></pre></td></tr></table>
</div>
</div><p>From the summary() output, we can see that the minimum z score is -13.08 and the maximum is 12.04.</p>
<p>Using which(), we can also find the locations of the z-scores whose absolute value is greater than 3.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Finds the locations of outliers in the depth variable</span>

<span class=nf>which</span><span class=p>(</span><span class=nf>abs</span><span class=p>(</span><span class=n>z.scores</span><span class=p>)</span> <span class=o>&gt;</span><span class=m>3</span> <span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Finds the total number of outliers according to the z-score</span>

<span class=nf>length </span><span class=p>(</span><span class=nf>which</span><span class=p>(</span><span class=nf>abs</span><span class=p>(</span><span class=n>z.scores</span><span class=p>)</span> <span class=o>&gt;</span><span class=m>3</span> <span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><p>According to the z-score method, the depth variable has 685 outliers.
There are also many statistical tests to detect outliers. Some of them are the Chi-square test for outliers, the Cochran’s test, the Dixon test and the Grubbs test. In this course, we won’t cover these statistical testing approaches used for detecting outliers. You may refer to the [outliers package manual] (<a href=https://cran.r-project.org/web/packages/outliers/outliers.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/outliers/outliers.pdf</a>) which includes useful functions for the commonly used outlier tests as well as the distance-based approaches.</p>
<h4 id=multivariate-outlier-detection-methods>Multivariate Outlier Detection Methods</h4>
<p>When we have only two variables, the bivariate visualisation techniques like bivariate boxplots and scatter plots, can easily be used to detect any outliers.
To illustrate the bivariate, we will assume that we are only interested in one numerical carat variable and a one factor (quantitative) cut variable in the Diamonds data set.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>boxplot</span><span class=p>(</span><span class=n>Diamonds</span><span class=o>$</span><span class=n>carat</span> <span class=o>~</span> <span class=n>Diamonds</span><span class=o>$</span><span class=n>cut</span><span class=p>,</span> <span class=n>main</span><span class=o>=</span><span class=s>&#34;Diamond carat by cut&#34;</span><span class=p>,</span> <span class=n>ylab</span> <span class=o>=</span> <span class=s>&#34;Carat&#34;</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span> <span class=s>&#34;Cut&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620195865/MATH2349/Module6/bivariateBoxplots_u5k2t4.png></p>
<p>Using the univariate boxplot approach, we can easily detect outliers in carat for a given cut.
Another bivariate visualisation method is the scatter plots. These plots are used to visualise the relationship between two quantitative variables. They are also very useful tools to detect obvious outliers for the two-dimensional data (i.e., for two continuous variables).
The plot() function will be used to get the scatter plot and detect outliers in carat and depth variables:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Diamonds</span> <span class=o>%&gt;%</span> <span class=nf>plot</span><span class=p>(</span><span class=n>carat</span> <span class=o>~</span> <span class=n>depth</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>.,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;Carat&#34;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#34;Depth&#34;</span><span class=p>,</span> <span class=n>main</span><span class=o>=</span><span class=s>&#34;Carat by Depth&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196026/MATH2349/Module6/scatterPlots_w3gsp5.png></p>
<p>According to the scatter plot, there are some possible outliers on the lower left (the data points where both carat and depth is small) and lower right-hand side of the scatter (the data points with larger depth but small carat values).</p>
<p>Scatter plots are useful methods to detect abnormal observations for a given pair of variables. However, when there are more than two variables, scatter plots can no longer be used. For such cases, multivariate distance-based methods of outlier detection can be used.</p>
<p><strong>The Mahalanobis distance</strong> is the most commonly used distance metric to detect outliers for the multivariate setting. The Mahalanobis distance is simply an extension of the univariate z-score, which also accounts for the correlation structure between all the variables. Mahalanobis distance follows a Chi-square distribution with n (number of variables) degrees of freedom, therefore <strong>any Mahalanobis distance greater than the critical chi-square value is treated as outliers.</strong></p>
<p>I will not go into details of calculation of the Mahalanobis distance. We will use the MVN package to get these distances as it will also provide us the useful Mahalanobis distance vs. Chi-square quantile distribution plot (QQ plot) and contour plots. For more information on this package and its capabilities please refer to the paper on <a href=https://cran.r-project.org/web/packages/MVN/vignettes/MVN.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/MVN/vignettes/MVN.pdf</a>.</p>
<p>To illustrate the usage of the MVN package to detect multivariate outliers, we will use a subset of the Iris data, which is versicolor flowers, with the first three variables (Sepal.Length, Sepal.Width and Petal.Length).</p>
<p>First let’s read the data using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># load iris data and subset using versicolor flowers, with the first three variables</span>

<span class=n>iris</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/iris.csv&#34;</span><span class=p>)</span>
<span class=n>versicolor</span> <span class=o>&lt;-</span> <span class=n>iris</span> <span class=o>%&gt;%</span>  <span class=nf>filter</span><span class=p>(</span><span class=n>Species</span> <span class=o>==</span> <span class=s>&#34;versicolor&#34;</span> <span class=p>)</span> <span class=o>%&gt;%</span>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=n>Sepal.Length</span><span class=p>,</span> <span class=n>Sepal.Width</span><span class=p>,</span> <span class=n>Petal.Length</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>versicolor</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#   Sepal.Length Sepal.Width Petal.Length</span>
<span class=gp>#</span><span class=c1># 1          7.0         3.2          4.7</span>
<span class=gp>#</span><span class=c1># 2          6.4         3.2          4.5</span>
<span class=gp>#</span><span class=c1># 3          6.9         3.1          4.9</span>
<span class=gp>#</span><span class=c1># 4          5.5         2.3          4.0</span>
<span class=gp>#</span><span class=c1># 5          6.5         2.8          4.6</span>
<span class=gp>#</span><span class=c1># 6          5.7         2.8          4.5</span>
</code></pre></td></tr></table>
</div>
</div><p>The <strong>mvn()</strong> function under MVN package (Korkmaz, Goksuluk, and Zararsiz (2014)) lets us to define the multivariate outlier detection method using the <em><strong>multivariateOutlierMethod</strong></em> argument. When we use <strong>multivariateOutlierMethod = &ldquo;quan&rdquo;</strong> argument, it detects the multivariate outliers using the chi-square distribution critical value approach mentioned above. The <strong>showOutliers = TRUE</strong> argument will depict any multivariate outliers and show them on the QQ plot.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Multivariate outlier detection using Mahalanobis distance with QQ plots</span>

<span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>mvn</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>versicolor</span><span class=p>,</span> <span class=n>multivariateOutlierMethod</span> <span class=o>=</span> <span class=s>&#34;quan&#34;</span><span class=p>,</span> <span class=n>showOutliers</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png></p>
<p>As we can see on the QQ plot, the Mahalonobis distance suggests existence of two outliers for this subset of the iris data.</p>
<p>If we would like to see the list of possible multivariate outliers, we can use <strong>result$multivariateOutliers</strong> to select only the results related to outliers as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>results</span><span class=o>$</span><span class=n>multivariateOutliers</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#    Observation Mahalanobis Distance Outlier</span>
<span class=gp>#</span><span class=c1># 34          34               10.974    TRUE</span>
<span class=gp>#</span><span class=c1># 49          49                9.580    TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>This output is very useful in terms of providing the locations of outliers in the data set. In our example the 34st and 49th observations are the suggested outliers for this subset of iris data.
The mvn() function has also different plot options to help discovering possible multivariate outliers. For example, to get the bivariate contour plots, we can use multivariatePlot = &ldquo;contour&rdquo; argument. However, note that contour plots can only be used for two variables.
Let’s illustrate the contour plots on the subset of setosa flowers, with the first two variables, Sepal.Length and Sepal.Width.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># load iris data and subset using setosa flowers, with the first two variables</span>

<span class=n>setosa</span> <span class=o>&lt;-</span> <span class=n>iris</span> <span class=o>%&gt;%</span>  <span class=nf>filter</span><span class=p>(</span> <span class=n>Species</span> <span class=o>==</span> <span class=s>&#34;setosa&#34;</span> <span class=p>)</span> <span class=o>%&gt;%</span>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=n>Sepal.Length</span><span class=p>,</span> <span class=n>Sepal.Width</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>setosa</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#   Sepal.Length Sepal.Width</span>
<span class=gp>#</span><span class=c1># 1          5.1         3.5</span>
<span class=gp>#</span><span class=c1># 2          4.9         3.0</span>
<span class=gp>#</span><span class=c1># 3          4.7         3.2</span>
<span class=gp>#</span><span class=c1># 4          4.6         3.1</span>
<span class=gp>#</span><span class=c1># 5          5.0         3.6</span>
<span class=gp>#</span><span class=c1># 6          5.4         3.9</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Multivariate outlier detection using Mahalanobis distance with contour plots</span>

<span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>mvn</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>setosa</span><span class=p>,</span> <span class=n>multivariateOutlierMethod</span> <span class=o>=</span> <span class=s>&#34;quan&#34;</span><span class=p>,</span> <span class=n>multivariatePlot</span> <span class=o>=</span> <span class=s>&#34;contour&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197011/MATH2349/Module6/contourPlotsOutlier_sdu7d3.png>
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620197100/MATH2349/Module6/chi-squareQQplotOutlier_uwxdrr.png></p>
<p>From the contour plot, we can see one anomality on the left-hand side of the plot, however, according to the QQ plot, this abnormal case doesn’t seem to be an outlier as its Mahanolobis distance didn’t exceed the threshold chi-square value.
Some applications of univariate and multivariate outlier detection can extend from fraud detection (i.e., unusual purchasing behaviour of a credit card owner), medicine (i.e. detection of unusual symptoms of a patient), sports statistics (i.e., abnormal performance for players may indicate doping), measurement errors (i.e., abnormal values could provide an indication of a measurement error), etc. Like missing value analysis, univariate and multivariate outlier analyses are also broader concepts. There are also different distance-based and probabilistic methods (like clustering analysis, genetic algorithm, etc.) that can be used to detect outliers in the high dimensional data sets. There is a huge theory behind the outlier detection methods and outlier analysis would be a standalone topic of another course. Interested readers may refer to the &ldquo;Outlier analysis, by Charu C. Aggarwal&rdquo; for the theory behind the outlier detection methods (Aggarwal (2015)).</p>
<h3 id=approaches-to-handling-outliers>Approaches to Handling Outliers</h3>
<p>Most of the ways to deal with outliers are similar to the methods of missing values like deleting them or imputing some values (i.e., mean, median, mode) instead. There are also other approaches specific to dealing with outliers like capping, transforming, and binning them. Here, we will discuss the common techniques used to deal with outliers. Some of the methods mentioned in this Module (like transforming and binning) will be covered in the next module (Module 7: Transform), therefore I won’t go into the details of transforming and binning here.</p>
<h4 id=excluding-or-deleting-outliers>Excluding or Deleting Outliers</h4>
<p>Some authors recommend that if the outlier is due to data entry error, data processing error or outlier observations are very small in numbers, then leaving out or deleting the outliers would be used as a strategy. When this is the case, we can exclude/delete outliers in a couple different ways.</p>
<p>To illustrate, let’s revisit the outliers in the carat variable. Remember that we already found the locations of the outliers in the carat variable using which() function. Intuitively, we can exclude these observations from the data using:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Carat_clean</span><span class=o>&lt;-</span> <span class=n>Diamonds</span><span class=o>$</span><span class=n>carat[</span> <span class=o>-</span> <span class=nf>which</span><span class=p>(</span> <span class=nf>abs</span><span class=p>(</span><span class=n>z.scores</span><span class=p>)</span> <span class=o>&gt;</span><span class=m>3</span> <span class=p>)</span><span class=n>]</span>
</code></pre></td></tr></table>
</div>
</div><p>Let’s see another example on the previous versicolor data:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>versicolor</span> <span class=o>&lt;-</span> <span class=n>iris</span> <span class=o>%&gt;%</span>  <span class=nf>filter</span><span class=p>(</span><span class=n>Species</span> <span class=o>==</span> <span class=s>&#34;versicolor&#34;</span> <span class=p>)</span> <span class=o>%&gt;%</span>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=n>Sepal.Length</span><span class=p>,</span> <span class=n>Sepal.Width</span><span class=p>,</span><span class=n>Petal.Length</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>versicolor</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#   Sepal.Length Sepal.Width Petal.Length</span>
<span class=gp>#</span><span class=c1># 1          7.0         3.2          4.7</span>
<span class=gp>#</span><span class=c1># 2          6.4         3.2          4.5</span>
<span class=gp>#</span><span class=c1># 3          6.9         3.1          4.9</span>
<span class=gp>#</span><span class=c1># 4          5.5         2.3          4.0</span>
<span class=gp>#</span><span class=c1># 5          6.5         2.8          4.6</span>
<span class=gp>#</span><span class=c1># 6          5.7         2.8          4.5</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>results</span> <span class=o>&lt;-</span> <span class=nf>mvn</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>versicolor</span><span class=p>,</span> <span class=n>multivariateOutlierMethod</span> <span class=o>=</span> <span class=s>&#34;quan&#34;</span><span class=p>,</span> <span class=n>showOutliers</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>results</span><span class=o>$</span><span class=n>multivariateOutliers</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#    Observation Mahalanobis Distance Outlier</span>
<span class=gp>#</span><span class=c1># 34          34               10.974    TRUE</span>
<span class=gp>#</span><span class=c1># 49          49                9.580    TRUE</span>
</code></pre></td></tr></table>
</div>
</div><p>The Mahalonobis distance method provided us the locations of outliers in the data set. In our example the 34st and 49th observations are the suggested outliers. Using the basic filtering and subsetting functions, we can easily exclude these two outliers:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Exclude 34st and 49th observations</span>

<span class=n>versicolor_clean</span> <span class=o>&lt;-</span> <span class=n>versicolor[</span> <span class=o>-</span><span class=nf>c</span><span class=p>(</span><span class=m>34</span><span class=p>,</span><span class=m>49</span><span class=p>),</span> <span class=n>]</span>

<span class=c1># Check the dimension and see outliers are excluded</span>

<span class=nf>dim</span><span class=p>(</span><span class=n>versicolor_clean</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># [1] 48  3</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that, the mvn() function also has an argument called showNewData = TRUE to exclude the outliers. One can simply detect and remove outliers using the following argument:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>versicolor_clean2</span> <span class=o>&lt;-</span> <span class=nf>mvn</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>versicolor</span><span class=p>,</span> <span class=n>multivariateOutlierMethod</span> <span class=o>=</span> <span class=s>&#34;quan&#34;</span><span class=p>,</span> <span class=n>showOutliers</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>showNewData</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1620196659/MATH2349/Module6/QQplotOutlier_ol5fk9.png></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Prints the data without outliers</span>

<span class=nf>dim</span><span class=p>(</span><span class=n>versicolor_clean2</span><span class=o>$</span><span class=n>newData</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># [1] 48  3</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=imputing>Imputing</h3>
<p>Like imputation of missing values, we can also impute outliers. We can use mean (need to be used with caution!), median imputation or capping methods to replace outliers. Before imputing values, we should analyse the distribution carefully, and investigate whether the suggested outlier is a result of data entry/processing error. If the outlier is due to a data entry/processing error, we can go with imputing values.
For the illustration purposes, let’s replace the two outlier values in carat variable with its mean by using Base R functions:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Diamonds</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;data/Diamonds.csv&#34;</span><span class=p>)</span>
<span class=n>Diamonds</span><span class=o>$</span><span class=n>carat[</span> <span class=nf>which</span><span class=p>(</span> <span class=nf>abs</span><span class=p>(</span><span class=n>z.scores</span><span class=p>)</span> <span class=o>&gt;</span><span class=m>3</span> <span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>Diamonds</span><span class=o>$</span><span class=n>carat</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>Replacing outliers with the median or a user specified value can also be done using a similar approach. Note that, you may also prefer to write your own functions to deal with outliers.</p>
<h3 id=capping-aka-winsorising>Capping (a.k.a Winsorising)</h3>
<p>Capping or winsorising involves replacing the outliers with the nearest neighbours that are not outliers. For example, for outliers that lie outside the outlier fences on a boxplot, we can cap it by replacing those observations outside the lower limit with the value of 5th percentile and those that lie above the upper limit, with the value of 95th percentile.</p>
<p>In order to cap the outliers we can use a user-defined function as follows (taken from: Stackoverflow):</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Define a function to cap the values outside the limits</span>

<span class=n>cap</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>){</span>
    <span class=n>quantiles</span> <span class=o>&lt;-</span> <span class=nf>quantile</span><span class=p>(</span> <span class=n>x</span><span class=p>,</span> <span class=nf>c</span><span class=p>(</span><span class=m>.05</span><span class=p>,</span> <span class=m>0.25</span><span class=p>,</span> <span class=m>0.75</span><span class=p>,</span> <span class=m>.95</span> <span class=p>)</span> <span class=p>)</span>
    <span class=n>x[</span> <span class=n>x</span> <span class=o>&lt;</span> <span class=n>quantiles[2]</span> <span class=o>-</span> <span class=m>1.5</span><span class=o>*</span><span class=nf>IQR</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=n>]</span> <span class=o>&lt;-</span> <span class=n>quantiles[1]</span>
    <span class=n>x[</span> <span class=n>x</span> <span class=o>&gt;</span> <span class=n>quantiles[3]</span> <span class=o>+</span> <span class=m>1.5</span><span class=o>*</span><span class=nf>IQR</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=n>]</span> <span class=o>&lt;-</span> <span class=n>quantiles[4]</span>
    <span class=n>x</span><span class=p>}</span>
</code></pre></td></tr></table>
</div>
</div><p>To illustrate capping we will use the Diamond data set. In order to cap the outliers in the carat variable, we can simply apply our user-defined function to the carat variable as follows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Diamonds</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;https://raw.githubusercontent.com/yanboyang713/RMIT-Data-Repository/main/Diamonds.csv&#34;</span><span class=p>)</span>
<span class=n>carat_capped</span> <span class=o>&lt;-</span> <span class=n>Diamonds</span><span class=o>$</span><span class=n>carat</span> <span class=o>%&gt;%</span> <span class=nf>cap</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><p>We can also apply this function to a data frame using sapply function. Here is an example of applying cap() function to a subset of the Diamonds data frame:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Take a subset of Diamonds data using quantitative variables</span>

<span class=n>Diamonds_sub</span> <span class=o>&lt;-</span> <span class=n>Diamonds</span> <span class=o>%&gt;%</span>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=n>carat</span><span class=p>,</span> <span class=n>depth</span><span class=p>,</span> <span class=n>price</span><span class=p>)</span>

<span class=c1># See descriptive statistics</span>

<span class=nf>summary</span><span class=p>(</span><span class=n>Diamonds_sub</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#      carat            depth           price      </span>
<span class=gp>#</span><span class=c1>#  Min.   :0.2000   Min.   :43.00   Min.   :  326  </span>
<span class=gp>#</span><span class=c1>#  1st Qu.:0.4000   1st Qu.:61.00   1st Qu.:  950  </span>
<span class=gp>#</span><span class=c1>#  Median :0.7000   Median :61.80   Median : 2401  </span>
<span class=gp>#</span><span class=c1>#  Mean   :0.7979   Mean   :61.75   Mean   : 3933  </span>
<span class=gp>#</span><span class=c1>#  3rd Qu.:1.0400   3rd Qu.:62.50   3rd Qu.: 5324  </span>
<span class=gp>#</span><span class=c1>#  Max.   :5.0100   Max.   :79.00   Max.   :18823</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1># Apply a user defined function &#34;cap&#34; to a data frame</span>

<span class=n>Diamonds_capped</span> <span class=o>&lt;-</span> <span class=nf>sapply</span><span class=p>(</span><span class=n>Diamonds_sub</span><span class=p>,</span> <span class=n>FUN</span> <span class=o>=</span> <span class=n>cap</span><span class=p>)</span>

<span class=c1># Check summary statistics again</span>

<span class=nf>summary</span><span class=p>(</span><span class=n>Diamonds_capped</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1>#      carat            depth           price      </span>
<span class=gp>#</span><span class=c1>#  Min.   :0.2000   Min.   :58.80   Min.   :  326  </span>
<span class=gp>#</span><span class=c1>#  1st Qu.:0.4000   1st Qu.:61.00   1st Qu.:  950  </span>
<span class=gp>#</span><span class=c1>#  Median :0.7000   Median :61.80   Median : 2401  </span>
<span class=gp>#</span><span class=c1>#  Mean   :0.7821   Mean   :61.75   Mean   : 3812  </span>
<span class=gp>#</span><span class=c1>#  3rd Qu.:1.0400   3rd Qu.:62.50   3rd Qu.: 5324  </span>
<span class=gp>#</span><span class=c1>#  Max.   :2.0000   Max.   :64.70   Max.   :13107</span>
<span class=err>
</span></code></pre></td></tr></table>
</div>
</div><h4 id=transforming-and-binning-values>Transforming and binning values</h4>
<p>Transforming variables can also eliminate outliers. Natural logarithm of a value reduces the variation caused by outliers. Binning is also a form of variable transformation. Transforming and binning will be covered in detail in the next module (Module 7: Transform).</p>
<h4 id=outliers-can-also-be-valuable>Outliers can also be valuable!</h4>
<p>The outlier detection methods (i.e. Tukey’s method, z-score method) provide us ‘suggested outliers’ in the data which tend to be far away from the rest of observations. Therefore, they serve as a reminder of possible anomalies in the data.</p>
<p>For some applications, those anomalies would be problematic (especially for the statistical tests) and usually be handled using omitting, imputing, capping, binning or applying transformations …etc. as they can bias the statistical results.</p>
<p>On the other hand, for some other applications like anomaly detection or fraud detection, these anomalies could be valuable and interesting. For such cases you may choose to leave (and investigate further) those values as they can tell you an interesting story about your data.</p>
<p>To wrap-up: We don’t always remove, impute, cap or transform suggested outliers in the data, for some applications outliers can provide valuable information or insight therefore analysts may choose to keep those values for further investigation.</p>
<h3 id=additional-resources-and-further-reading-4>Additional Resources and Further Reading</h3>
<p>As mentioned before, univariate and multivariate outlier analysis are broader concepts. Interested readers may refer to the “Outlier analysis, by Charu C. Aggarwal” for the theory behind the outlier detection methods (Aggarwal (2015)). Another useful resource is “R and Data Mining: Examples and Case Studies” by Yanchang Zhao (also available <a href=https://cran.r-project.org/doc/contrib/Zhao_R_and_data_mining.pdf target=_blank rel="noopener noreferrer">here</a>). Chapter 7 of this book covers univariate and multivariate outlier detection methods, outlier detection using clustering and outlier detection in time series.</p>
<p>The [outliers package manual] (<a href=https://cran.r-project.org/web/packages/outliers/outliers.pdf target=_blank rel="noopener noreferrer">https://cran.r-project.org/web/packages/outliers/outliers.pdf</a>) includes useful functions for the commonly used outlier tests and the distance-based approaches. This package can be used to detect univariate outliers.</p>
<p>I find the MVN package useful for detecting multivariate outliers as it provides many alternative visualizations in addition to the distance-based metrics. The MVN package also includes different types of univariate and multivariate tests for normality. For more information and capabilities of the MVN package please refer to the paper by Korkmaz, Goksuluk, and Zararsiz (2014), which is available <a href=https://cran.r-project.org/web/packages/MVN/vignettes/MVN.pdf target=_blank rel="noopener noreferrer">here</a>.</p>
<p>There are also other R packages for outlier detection, and all might give different results. [This blog by Antony Unwin] (<a href=http://blog.revolutionanalytics.com/2018/03/outliers.html target=_blank rel="noopener noreferrer">http://blog.revolutionanalytics.com/2018/03/outliers.html</a>) compares different outlier detection methods available in R using the OutliersO3 package.</p>
<p>References
Aggarwal, Charu C. 2015. “Outlier Analysis.” In Data Mining, 237–63. Springer.</p>
<p>Hawkins, Douglas M. 1980. Identification of Outliers. Vol. 11. Springer.</p>
<p>Korkmaz, Selcuk, Dincer Goksuluk, and Gokmen Zararsiz. 2014. “MVN: An R Package for Assessing Multivariate Normality.” The R Journal 6 (2): 151–62.</p>
<h2 id=cheatsheet>Cheatsheet</h2>
<h3 id=modele-2>Modele 2</h3>
<h4 id=readingimporting-data-1>Reading/Importing Data</h4>
<h5 id=from-csv-files>from CSV files</h5>
<h6 id=base-r>Base R</h6>
<ul>
<li>Import</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>Iris1</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=n>file</span><span class=o>=</span> “<span class=o>~/</span><span class=n>Desktop</span><span class=o>/</span><span class=n>data</span><span class=o>/</span><span class=n>iris.csv</span>”<span class=p>)</span> <span class=p>(</span><span class=n>.csv</span> <span class=n>eliminates</span> <span class=n>any</span> <span class=n>spaces</span> <span class=n>in</span> <span class=n>variable</span> <span class=n>names</span> <span class=n>and</span> <span class=n>fills</span> <span class=n>it</span> <span class=n>with</span> ‘<span class=n>.’</span><span class=p>)</span>
<span class=n>Iris2</span> <span class=o>&lt;-</span> <span class=nf>read.csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>NOTE:</strong></p>
<ol>
<li>Set Working directory</li>
</ol>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>setwd</span><span class=p>(</span><span class=s>&#34;~/Desktop/data&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ol start=2>
<li>Check Structure</li>
</ol>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>str</span><span class=p>(</span><span class=n>iris1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Using table to read csv file.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris5</span> <span class=o>&lt;-</span> <span class=nf>read.table</span><span class=p>(</span> <span class=s>&#34;iris.csv&#34;</span> <span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s>&#34;,&#34;</span> <span class=n>or</span> <span class=n>\t</span><span class=p>,</span> <span class=n>header</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>readr (10 times faster)</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>##  (maintain full name, auto set stringasfactor=FALSE)</span>
<span class=n>iris9</span> <span class=o>&lt;-</span> <span class=nf>read_csv</span><span class=p>(</span><span class=s>&#34;iris.csv&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>NOTE:</strong>
Display 1st to 6th rows and 1st to 4th variables iris9[1:6,1:4]</p>
<h5 id=from-excel-files>from Excel files</h5>
<ul>
<li>xlsx</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## Using sheet index or name: </span>
<span class=n>iris11</span><span class=o>&lt;-</span> <span class=nf>read.xlsx</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheetName</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span> <span class=n>startRow</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>

<span class=c1>## Row column index: </span>
<span class=n>iris12</span><span class=o>&lt;-</span> <span class=nf>read.xlsx</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheetName</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span> <span class=n>rowIndex</span> <span class=o>=</span> <span class=m>3</span><span class=o>:</span><span class=m>5</span><span class=p>,</span> <span class=n>colIndex</span> <span class=o>=</span> <span class=m>1</span><span class=o>:</span><span class=m>4</span><span class=p>)</span>
<span class=p>(</span><span class=nf>keepFormulas </span><span class=p>(</span><span class=n>use</span> <span class=n>on</span> <span class=n>which</span> <span class=n>any</span> <span class=n>platform</span><span class=p>,</span> <span class=n>allows</span> <span class=n>you</span> <span class=n>no</span> <span class=n>to</span> <span class=n>external</span> <span class=n>see</span> <span class=n>the</span> <span class=n>dependencies</span><span class=p>,</span> <span class=n>text</span> <span class=n>of</span> <span class=n>any</span> <span class=n>formulas</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Readxl
use on which any platform, no external dependencies, load date and times</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris13</span><span class=o>&lt;-</span> <span class=nf>read_excel</span><span class=p>(</span><span class=s>&#34;iris.xlsx&#34;</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span><span class=n>skip</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>col_names</span> <span class=o>=</span> <span class=nf>paste </span><span class=p>(</span><span class=s>&#34;Var&#34;</span><span class=p>,</span> <span class=n>Data</span> <span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>gdata (to read excel, Base R cannot read excel)</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>science_data</span> <span class=o>&lt;-</span> <span class=nf>read.xls</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=from-statistical-software>from statistical software</h5>
<ul>
<li>Foreign</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>iris_spss</span> <span class=o>&lt;-</span> <span class=nf>read.spss</span><span class=p>(</span><span class=s>&#34;iris.sav&#34;</span><span class=p>,</span> <span class=n>to.data.frame</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=scraping-html-table-data-1>Scraping HTML Table Data</h5>
<ul>
<li>rvest</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>births</span> <span class=o>&lt;-</span> <span class=nf>read_html</span><span class=p>(</span><span class=s>&#34;link here&#34;</span><span class=p>)</span>

<span class=c1>## show select no. of tables:</span>
<span class=nf>length</span><span class=p>(</span><span class=nf>html_nodes</span><span class=p>(</span><span class=n>births</span><span class=p>,</span> <span class=s>&#34;table&#34;</span><span class=p>))</span> <span class=c1>## [1] 1</span>

<span class=c1>## select the of second tables element of the html_nodes</span>
<span class=n>births_data</span><span class=o>&lt;-</span> <span class=nf>html_table</span><span class=p>(</span><span class=nf>html_nodes</span><span class=p>(</span><span class=n>births</span><span class=p>,</span> <span class=s>&#34;table&#34;</span><span class=p>)</span><span class=n>[[1]]</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=write-data>Write data</h4>
<h5 id=to-text-files>to text files</h5>
<ul>
<li>Base R
To csv:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>write.csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_csv&#34;</span><span class=p>,</span> <span class=n>row.names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>To text:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>write.table</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;cars_txt&#34;</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s>&#34;\t&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>readr
To csv:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>write_csv</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=s>&#34;export_csv2&#34;</span><span class=p>,</span> <span class=n>col_names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><p>To text:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>write_delim</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>path</span> <span class=o>=</span> <span class=s>&#34;export_txt2&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h5 id=to-excel-files>to Excel files</h5>
<ul>
<li>xlsx</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>write.xlsx</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>file</span><span class=o>=</span> <span class=s>&#34;cars.xlsx&#34;</span><span class=p>,</span> <span class=n>row.names</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>create workbook:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>multiple_df</span> <span class=o>&lt;-</span> <span class=nf>createWorkbook</span><span class=p>()</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>create sheet in workbook:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>car_df</span> <span class=o>&lt;-</span> <span class=nf>createSheet</span><span class=p>(</span><span class=n>wb</span> <span class=o>=</span> <span class=n>multiple_df</span><span class=p>,</span> <span class=n>sheetName</span> <span class=o>=</span> <span class=s>&#34;Cars&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>add Data frame:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>addDataFrame</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>iris</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=n>iris_df</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=r-object-file>R object File</h4>
<ul>
<li>Saving Data as an R object File:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>save </span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;xy.RData&#34;</span><span class=p>)</span>
<span class=nf>save.image</span><span class=p>()</span> <span class=p>(</span><span class=n>saves</span> <span class=n>all</span> <span class=n>current</span> <span class=n>workspace</span> <span class=n>as</span> <span class=n>.RData</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>save a single object to file:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>saveRDS </span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=s>&#34;x.rds&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>restore it under a different name:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>x2</span> <span class=o>&lt;-</span> <span class=nf>readRDS </span><span class=p>(</span><span class=s>&#34;x.rds&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>check if x and x2 are identical:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>identical </span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>x2</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=module-3>Module 3</h3>
<h4 id=data-types-and-levels>Data Types and levels</h4>
<ul>
<li>Check class: Class()</li>
<li>Numeric object integer or double: typeof()</li>
<li>Level of factor: levels()</li>
<li>Creating character class: var1 &lt;- c(&ldquo;debit&rdquo;, &ldquo;credit&rdquo;)</li>
<li>Creating integer variable: var2 &lt;- c(4L, 7L, 14L)</li>
</ul>
<h4 id=factor>Factor</h4>
<p>Createing factor variable: var4 &lt;- factor (c(&ldquo;Male&rdquo;, &ldquo;Female&rdquo;, &ldquo;Male&rdquo;, &ldquo;Female&rdquo;), level = c(&ldquo;Male&rdquo;, &ldquo;Female&rdquo;), ordered = True)
auto sets the levels alphabetically if not stated Result ## [1] Male Female Male Male ## Levels: Male Female</p>
<h4 id=vectors-1>Vectors</h4>
<ul>
<li>Creating a vector ex1&lt;- c(“a”, “b”, 1, 2, 3)
elements of vector must be same type otherwise coerced</li>
<li>Order of coercion logical &lt; integer &lt; numeric &lt; character (best)</li>
<li>Add vectors to existing one ex4&lt;- c(ex2, 4, 6) ## [1] 1 2 3 1 0 4 6</li>
<li>Subsetting vector ex4[3] take3rd element ex4[c(1,3,5)] 1st 3rd & 5th
ex4[c(1:3)] 1 to 3 ex4 [-1] all except first ex4[ex4&lt;3] all elements less than 3</li>
</ul>
<h4 id=lists-allows-combination-of-different-data-types-and-lengths>Lists allows combination of different data types and lengths</h4>
<ul>
<li>Creating a list list1 &lt;- list(1:3, “a”, c(TRUE, FALSE, TRUE), c(2.5, 4.2))</li>
<li>Check Structure str(list1) shows a list of 4 with different classes</li>
<li>Add onto existing list list2&lt;- append(list1, list(c(“credit”, “debit”, “paypay”) shows list of 5</li>
<li>Checking Attributes attributes ( list2 ) metadata of object</li>
<li>Add name:
names(list2) &lt;- c(“item1”, item2”, “item3”, “item4”,“item5”) gives name for each element</li>
<li>Subsetting lists:
<ul>
<li>list2[1]: takes 1st item in list2</li>
<li>List2 [ [ 1 ] ]: take 1st item in list2 without attributes (name)</li>
<li>List2$item1: take 1st list item using name</li>
<li>List2$item5 [ 3 ]: take 3rd element out of 5th list item</li>
</ul>
</li>
</ul>
<h4 id=matrices-1>Matrices</h4>
<ul>
<li>Creating matrices:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m1</span><span class=o>&lt;-</span> <span class=nf>matrix</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=p>,</span> <span class=n>nrow</span><span class=o>=</span><span class=m>2</span><span class=p>,</span> <span class=n>ncol</span><span class=o>=</span><span class=m>3</span><span class=p>)</span> 
</code></pre></td></tr></table>
</div>
</div><p>elements inside must be same class, all columns must be same length, [row,col]</p>
<ul>
<li>Creating matrices using bind
eg. V1, V2 vectors with same length, can also use different data structure as long as they are same length.</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>m2</span> <span class=o>&lt;-</span> <span class=nf>cbind</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>v2</span><span class=p>)</span> <span class=c1>#col bind</span>
<span class=n>m2</span> <span class=o>&lt;-</span> <span class=nf>rbind</span><span class=p>(</span><span class=n>v1</span><span class=p>,</span> <span class=n>v2</span><span class=p>)</span> <span class=c1>#row bind</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Add name to matrice</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>rownames</span><span class=p>(</span><span class=n>m4</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;subject1&#34;</span><span class=p>,</span><span class=s>&#34;subject2&#34;</span><span class=p>,</span><span class=s>&#34;subject3&#34;</span><span class=p>)</span>
<span class=nf>colnames </span><span class=p>(</span><span class=n>m4</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span>“<span class=n>var1</span><span class=p>,</span> “<span class=n>var2</span><span class=p>,</span> “<span class=n>var3</span>”<span class=p>)</span> <span class=n>check</span> <span class=n>with</span> <span class=nf>attributes</span><span class=p>(</span><span class=n>m4</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Subsetting matrice:
<ul>
<li>m4 [1, 2] # value of 1st row 2nd col</li>
<li>m4 [1:2, ] # subset for rows 1 and 2 but keep all columns</li>
<li>m4 [, c(1, 3)] # subset for columns 1 and 3 but keep all rows</li>
</ul>
</li>
</ul>
<h4 id=data-frames-1>Data Frames</h4>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>df1</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>col1</span><span class=o>=</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=p>,</span><span class=n>col2</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;credit&#34;</span><span class=p>,</span><span class=s>&#34;debit&#34;</span><span class=p>,</span><span class=s>&#34;Paypal&#34;</span><span class=p>),</span>
<span class=n>col3</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=kc>TRUE</span><span class=p>,</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=kc>TRUE</span><span class=p>),</span><span class=n>col4</span> <span class=o>=</span> <span class=nf>c </span><span class=p>(</span><span class=m>25.5</span><span class=p>,</span> <span class=m>44.2</span><span class=p>,</span> <span class=m>54.9</span><span class=p>),</span>
<span class=n>stringsAsFactors</span><span class=o>=</span><span class=kc>FALSE</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Adding to data frame df2&lt;-cbind(df1, v4) can add col or rows(item)</li>
<li>Add name df same as matrices attributes(df2) shows col & row names</li>
<li>Subsetting df df behaves like both lists and matrices
<ul>
<li>df[2:3, ]</li>
<li>df [c(&ldquo;subj1&rdquo;, &ldquo;subj3&rdquo;), ]</li>
<li>df [2:3, c(1,4)]</li>
<li>df2$fraud[2] # 2nd element in the fraud column</li>
</ul>
</li>
</ul>
<h4 id=convert-data-types-structures>Convert Data Types/ Structures</h4>
<ul>
<li>as.numeric() as.matrix() num_v&lt;- as.vector(8:17) convert to vec</li>
<li>is.numeric() is.matrix() is.vector(num_vec) # check if vector</li>
</ul>
<h3 id=module-4>Module 4</h3>
<h4 id=tidy-data-principles-1>Tidy Data Principles</h4>
<ol>
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
<h4 id=common-problems-with-messy-data-sets-1>Common problems with messy data sets</h4>
<ol>
<li>
<p>Column headers are values, not variable names
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037383/MATH2349/Model4/CommonProblemOne_jekvaq.png>
gather(): [wide to long](###pivot_longer() function)
Or
pivot_longer</p>
</li>
<li>
<p>Multiple variables are stored in rows (no primary key)
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037561/MATH2349/Model4/CommonProblemTwo_hmqyrc.png>
spread: [long to wide](###pivot_wider() function)
Or
pivot_wider</p>
</li>
<li>
<p>Multiple variables are stored in one column
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037681/MATH2349/Model4/CommonProblemThree_bnk7kb.png>
separate() [col having too many variables](###separate() function)</p>
</li>
<li>
<p>Multiple columns forms a variable
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617037881/MATH2349/Model4/CommonProblemFour_og6y7t.png>
unite() [inverse of separate() function](###unite() function)</p>
</li>
</ol>
<h4 id=dplyr-package>dplyr package</h4>
<ol>
<li>select() function:</li>
</ol>
<ul>
<li>-: Select everything but</li>
<li>:: Select range</li>
<li>contains(): Select columns whose name contains a character string</li>
<li>ends_with(): Select columns whose name ends with a string</li>
<li>everything(): Select every column</li>
<li>matches(): Select columns whose name matches a regular expression</li>
<li>num_range(): Select columns named x1, x2, x3, x4, x5</li>
<li>one_of(): Select columns whose names are in a group of names</li>
<li>starts_with(): Select columns whose name starts with a character string</li>
</ul>
<ol start=2>
<li>filter() function
uses operators such as &lt; > == != %in% is.na any all</li>
<li>arrange() function allows us to order data by variables in ascending or descending order.</li>
<li>mutate() function allows us to add new variables while preserving the existing variables.</li>
<li>summarise() (a.k.a. summarize() ) function allows us to perform the majority of summary statistics when performing exploratory data analysis.</li>
</ol>
<ul>
<li>min(), max()</li>
<li>mean()</li>
<li>median()</li>
<li>sum()</li>
<li>var(), sd()</li>
<li>first()</li>
<li>last()</li>
<li>nth()</li>
<li>n()</li>
<li>n_distinct()</li>
</ul>
<ol start=6>
<li>group_by() + summarise(): summary statistics grouped by a variable</li>
</ol>
<h5 id=example>Example</h5>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>flights</span> <span class=o>%&gt;%</span> <span class=nf>group_by</span><span class=p>(</span><span class=n>dest</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>summarise</span><span class=p>(</span><span class=n>mean_delay</span> <span class=o>=</span> <span class=nf>mean</span><span class=p>(</span><span class=n>dep_delay</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>How would you find the names of people who was born and deceased at the same place?</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>step1</span> <span class=o>&lt;-</span> <span class=n>death_registration</span> <span class=o>%&gt;%</span> <span class=nf>left_join</span><span class=p>(</span><span class=n>birth_registration</span><span class=p>,</span> <span class=n>by</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>)</span> <span class=c1># 5 points</span>
<span class=n>step1</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=n>place.death</span> <span class=o>==</span> <span class=n>place.born</span><span class=p>)</span> <span class=c1># 5 points</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Suppose you want to sort the flights that departed from New York City according to their seating (seats) capacity (i.e. from highest seating capacity to less seating capacity). How would you do that?</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>flights</span> <span class=o>%&gt;%</span> <span class=nf>left_join</span><span class=p>(</span><span class=n>planes</span><span class=p>,</span> <span class=n>by</span><span class=o>=</span><span class=s>&#34;tailnum&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>arrange</span><span class=p>(</span><span class=nf>desc</span><span class=p>(</span><span class=n>seats</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>How would you calculate the average distance covered by each plane manufacturer?</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>flights</span> <span class=o>%&gt;%</span> <span class=nf>left_join</span><span class=p>(</span><span class=n>planes</span><span class=p>,</span> <span class=n>by</span><span class=o>=</span><span class=s>&#34;tailnum&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> 
  <span class=nf>group_by</span><span class=p>(</span><span class=n>manufacturer</span><span class=p>)</span> <span class=o>%&gt;%</span>  
  <span class=nf>summarise</span><span class=p>(</span><span class=n>mean_distance</span> <span class=o>=</span> <span class=nf>mean</span><span class=p>(</span><span class=n>distance</span><span class=p>,</span> <span class=n>na.rm</span><span class=o>=</span><span class=kc>TRUE</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=mutating-joins-1>Mutating joins</h4>
<p><img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617043954/MATH2349/Model4/mutatingJoining_tpsksf.png></p>
<h5 id=example-1>Example</h5>
<ul>
<li>Create new table with required values, join new table to match another table with data.
Eg. right_join - about the flights that has weather visibility of 5</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>weather_v5</span> <span class=o>&lt;-</span> <span class=n>weather</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=n>visib</span> <span class=o>==</span> <span class=m>5</span><span class=p>)</span>
<span class=n>flights2</span> <span class=o>%&gt;%</span> <span class=nf>right_join</span><span class=p>(</span><span class=n>weather_v5</span><span class=p>)</span> <span class=o>%&gt;%</span> <span class=nf>select</span><span class=p>(</span><span class=n>visib</span><span class=p>,</span> <span class=nf>everything</span><span class=p>())</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>How would you find the ages of people (in years) when they deceased?</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>died</span> <span class=o>&lt;-</span> <span class=n>death_registration</span> <span class=o>%&gt;%</span> <span class=nf>left_join</span><span class=p>(</span><span class=n>birth_registration</span><span class=p>,</span> <span class=n>by</span> <span class=o>=</span> <span class=s>&#34;name&#34;</span><span class=p>)</span>  <span class=c1># 5 points</span>
<span class=n>died</span> <span class=o>%&gt;%</span> <span class=nf>mutate </span><span class=p>(</span><span class=n>age.at.death</span> <span class=o>=</span> <span class=n>year.death</span> <span class=o>-</span> <span class=n>year.born</span><span class=p>)</span> <span class=c1># 5 points</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=filtering-joins-1>Filtering Joins</h4>
<p>Anti-joins are useful for diagnosing join mismatches. For example, when connecting flights and planes, you might be interested to know that there are many flights that don’t have a match in planes
<img class=lazyload src=https://yanboyang.com/svg/loading.min.svg data-src=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png data-srcset="https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png 1.5x, https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png 2x" data-sizes=auto alt=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png title=https://res.cloudinary.com/dkvj6mo4c/image/upload/v1617044759/MATH2349/Model4/filteringJoins_cn9efc.png></p>
<h5 id=example-2>Example</h5>
<ul>
<li>How would you find the names of people who are still alive?</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>birth_registration</span> <span class=o>%&gt;%</span> <span class=nf>anti_join</span><span class=p>(</span><span class=n>death_registration</span><span class=p>,</span> <span class=n>by</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=module-5>Module 5</h3>
<h4 id=missing-data-1>Missing Data</h4>
<ul>
<li>a numeric missing value is represented by NA (NA stands for “not available”)</li>
<li>character missing values are represented by .</li>
<li>some other values may represent missing values (i.e. 99, ., .., just space, or NULL) depending on the software (i.e., Excel, SPSS etc.</li>
</ul>
<h4 id=identifying-missing-data-1>Identifying Missing Data</h4>
<ul>
<li>Result: is.na(df$col4) gives logical result TRUE or FALSE</li>
<li>Location: which(is.na(x)) gives location of NA</li>
<li>Total in whole: sum(is.na(df))</li>
<li>Total in each column: colSums(is.na(df))</li>
</ul>
<h4 id=recode-missing-data-1>Recode Missing Data</h4>
<ul>
<li>recode missing values with mean:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>x</span><span class=nf>[is.na</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=nf>mean</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=c1>##  Replace NAs in a data frame</span>
<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>tibble</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=kc>NA</span><span class=p>),</span> <span class=n>y</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=kc>NA</span><span class=p>,</span> <span class=s>&#34;b&#34;</span><span class=p>))</span>
<span class=n>df</span> <span class=o>%&gt;%</span> <span class=nf>replace_na</span><span class=p>(</span><span class=nf>list</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=m>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;unknown&#34;</span><span class=p>))</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Define what&rsquo;s NA:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>population_NA[population_NA</span> <span class=o>==</span> <span class=s>&#34;..     &#34;</span> <span class=n>]</span> <span class=o>&lt;-</span> <span class=kc>NA</span>
<span class=n>population_NA</span><span class=nf>[which</span><span class=p>(</span><span class=n>population_NA</span> <span class=o>==</span> <span class=s>&#34;..     &#34;</span> <span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=kc>NA</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Excluding Missing Data:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=c1>## excluding NA values</span>
<span class=nf>mean</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>na.rm</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>

<span class=nf>complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<span class=c1>### [1]  TRUE FALSE  TRUE FALSE</span>

<span class=c1>## subset data frame with complete.cases to get only complete cases</span>

<span class=n>df</span><span class=nf>[complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=n>]</span>
<span class=n>df[</span><span class=o>!</span><span class=nf>complete.cases</span><span class=p>(</span><span class=n>df</span><span class=p>),</span> <span class=n>]</span>
<span class=nf>na.omit</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=basic-missing-value-imputation-techniques-1>Basic Missing Value Imputation Techniques</h4>
<ul>
<li>Replace the missing value(s) with some constant, specified by the analyst</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=nf>library</span><span class=p>(</span><span class=n>deductive</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>validate</span><span class=p>)</span>
<span class=c1>## Define the rules as a validator expression</span>

<span class=n>Rules</span> <span class=o>&lt;-</span> <span class=nf>validator</span><span class=p>(</span> <span class=n>staff</span> <span class=o>+</span> <span class=n>cleaning</span> <span class=o>+</span> <span class=n>housing</span> <span class=o>==</span> <span class=n>total</span><span class=p>,</span>
                              <span class=n>staff</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>,</span>
                              <span class=n>housing</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>,</span>
                              <span class=n>cleaning</span> <span class=o>&gt;=</span> <span class=m>0</span><span class=p>)</span>

<span class=c1>## Use impute_lr function</span>

<span class=n>imputed_df</span> <span class=o>&lt;-</span> <span class=nf>impute_lr</span><span class=p>(</span><span class=n>df</span><span class=p>,</span><span class=n>Rules</span><span class=p>)</span>

<span class=nf>library</span><span class=p>(</span><span class=n>Hmisc</span><span class=p>)</span>

<span class=c1>## mean imputation (for numerical variables)</span>

<span class=n>x1</span> <span class=o>&lt;-</span> <span class=nf>impute</span><span class=p>(</span><span class=n>x</span><span class=o>$</span><span class=n>x1</span><span class=p>,</span> <span class=n>fun</span> <span class=o>=</span> <span class=n>mean</span><span class=p>)</span>

<span class=c1>## check which values are imputed</span>

<span class=nf>is.imputed</span><span class=p>(</span><span class=n>x1</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=id-special-values>ID Special Values</h4>
<ul>
<li>-Inf Inf: is.infinite( vector) true ; is.finite(vector) false <strong>vector only func</strong></li>
<li>NaN: is.nan( ) retuns true</li>
</ul>
<h4 id=apply-functions---df-list-and-matrices-also-vectors>apply() Functions - df list and matrices also vectors</h4>
<ul>
<li>apply() matrices & df</li>
<li>lapply() for lists (output as list)</li>
<li>sapply() for lists (output simplified)</li>
<li>tapply() for vectors</li>
<li>Write own function:</li>
</ul>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=n>is.special</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>x</span><span class=p>){</span>
<span class=nf>if </span><span class=p>(</span><span class=nf>is.numeric</span><span class=p>(</span><span class=n>x</span><span class=p>))</span> <span class=p>(</span><span class=nf>is.infinite</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>|</span> <span class=nf>is.nan</span><span class=p>(</span><span class=n>x</span><span class=p>))</span>
<span class=p>}</span>

<span class=c1>## apply this function to the data frame.</span>

<span class=nf>sapply</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>is.special</span><span class=p>)</span>
</code></pre></td></tr></table>
</div>
</div></div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2022-01-15</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md><span>
<a class=link-to-markdown href=https://yanboyang.com/datapreprocessing/index.md target=_blank rel="noopener noreferrer">Read Markdown</a>
</span></div>
<div class=post-info-share>
<span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)"><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://yanboyang.com/datapreprocessing/><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)"><i data-svg-src=https://yanboyang.com/lib/simple-icons/icons/line.min.svg></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)"><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="Share on Myspace" data-sharer=myspace data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)" data-description><i data-svg-src=https://yanboyang.com/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)" data-description><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://yanboyang.com/datapreprocessing/ data-title="Data Wrangling (Data Preprocessing)"><i class="fab fa-evernote fa-fw"></i></a></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=https://yanboyang.com/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=https://yanboyang.com/rlanguage/ class=prev rel=prev title="Getting Started with R language"><i class="fas fa-angle-left fa-fw"></i>Getting Started with R language</a>
<a href=https://yanboyang.com/writingmathematicfomular/ class=next rel=next title="Writing Mathematic Fomular">Writing Mathematic Fomular<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.92.0">Hugo</a> | Theme - <a href=https://github.com/sunt-programator/CodeIT target=_blank rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i> CodeIT</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://yanboyang.com/ target=_blank rel="noopener noreferrer">Boyang Yan</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><link rel=stylesheet href=https://yanboyang.com/lib/katex/katex.min.css><link rel=stylesheet href=https://yanboyang.com/lib/katex/copy-tex.min.css><link rel=stylesheet href=https://yanboyang.com/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=https://boyang-blog.disqus.com/embed.js defer></script><script type=text/javascript src=https://yanboyang.com/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/lunr/lunr.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/sharer/sharer.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/katex.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/auto-render.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/copy-tex.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/mhchem.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=https://yanboyang.com/js/theme.min.js></script></body>
</html>