<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Time Series Analysis Basic Plots, Examples, and Fundamental Concepts - Boyang Yan's Tech Blog</title><meta name=description content="This is Boyang Yan's Tech Blog"><meta property="og:title" content="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts"><meta property="og:description" content="Introduction You will study the basic context of time series and stochastic processes including basic visualisations for time series data.
Time series data is composed of observations collected sequentially over time. This type of data is frequently seen and analysed in data analytics applications.
In business, we observe
 weekly interest rates, daily closing stock prices, monthly price indices, yearly sales figures, and so forth.  In meteorology, we observe"><meta property="og:type" content="article"><meta property="og:url" content="https://yanboyang.com/timeseriesanalysisweek1/"><meta property="og:image" content="https://yanboyang.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-15T18:23:00+11:00"><meta property="article:modified_time" content="2022-04-04T11:55:33+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yanboyang.com/logo.png"><meta name=twitter:title content="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts"><meta name=twitter:description content="Introduction You will study the basic context of time series and stochastic processes including basic visualisations for time series data.
Time series data is composed of observations collected sequentially over time. This type of data is frequently seen and analysed in data analytics applications.
In business, we observe
 weekly interest rates, daily closing stock prices, monthly price indices, yearly sales figures, and so forth.  In meteorology, we observe"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://yanboyang.com/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://yanboyang.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://yanboyang.com/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://yanboyang.com/apple-touch-icon.png><link rel=mask-icon href=https://yanboyang.com/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://yanboyang.com/site.webmanifest><link rel=canonical href=https://yanboyang.com/timeseriesanalysisweek1/><link rel=prev href=https://yanboyang.com/revealslides/><link rel=next href=https://yanboyang.com/analysisoftrends/><link rel=stylesheet href=https://yanboyang.com/lib/normalize/normalize.min.css><link rel=stylesheet href=https://yanboyang.com/css/style.min.css><link rel=stylesheet href=https://yanboyang.com/lib/fontawesome-free/all.min.css><link rel=stylesheet href=https://yanboyang.com/lib/animate/animate.min.css><meta name=baidu-site-verification content="wsCeKMuJ31RLblHf"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Time Series Analysis Basic Plots, Examples, and Fundamental Concepts","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yanboyang.com\/timeseriesanalysisweek1\/"},"genre":"posts","keywords":"time, series, analysis","wordcount":3290,"url":"https:\/\/yanboyang.com\/timeseriesanalysisweek1\/","datePublished":"2022-03-15T18:23:00+11:00","dateModified":"2022-04-04T11:55:33+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Boyang Yan"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>("true"==="true"&&window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-101949995-1","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-101949995-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><div class=header-wrapper><div class=header-title><a href=https://yanboyang.com/ title="Boyang Yan's Tech Blog"></a></div><div class=menu><div class=menu-inner><a class=menu-item href=https://yanboyang.com/>Home </a><a class=menu-item href=https://yanboyang.com/posts/>Posts </a><a class=menu-item href=https://yanboyang.com/tags/>Tags </a><a class=menu-item href=https://yanboyang.com/categories/>Categories </a><a class=menu-item href=https://yanboyang.com/about/>About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-101949995-1","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-101949995-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><div class=header-container><div class=header-wrapper><div class=header-title><a href=https://yanboyang.com/ title="Boyang Yan's Tech Blog"></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=https://yanboyang.com/ title>Home</a><a class=menu-item href=https://yanboyang.com/posts/ title>Posts</a><a class=menu-item href=https://yanboyang.com/tags/ title>Tags</a><a class=menu-item href=https://yanboyang.com/categories/ title>Categories</a><a class=menu-item href=https://yanboyang.com/about/ title>About Me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Time Series Analysis Basic Plots, Examples, and Fundamental Concepts</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://yanboyang.com/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>
Boyang Yan</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-03-15>2022-03-15</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;3290 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;16 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#examples-of-time-series>Examples of time series</a></li><li><a href=#annual-rainfall-in-los-angeles>Annual Rainfall in Los Angeles</a></li><li><a href=#an-industrial-chemical-process>An Industrial Chemical Process</a></li><li><a href=#annual-abundance-of-canadian-hare>Annual Abundance of Canadian Hare</a></li><li><a href=#monthly-average-temperatures-in-dubuque-iowa>Monthly Average Temperatures in Dubuque, Iowa</a></li><li><a href=#monthly-oil-filter-sales>Monthly Oil Filter Sales</a></li><li><a href=#a-model-building-strategy>A Model-Building Strategy</a></li><li><a href=#time-series-and-stochastic-processes>Time Series and Stochastic Processes</a></li><li><a href=#means-variances-and-covariances>Means, Variances, and Covariances</a></li><li><a href=#the-random-walk>The Random Walk</a></li><li><a href=#a-moving-average>A Moving Average</a></li><li><a href=#stationarity>Stationarity</a></li><li><a href=#white-noise>White Noise</a></li><li><a href=#random-cosine-wave>Random Cosine Wave</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>You will study the basic context of time series and stochastic processes including basic visualisations for time series data.</p><p>Time series data is composed of observations collected sequentially over time. This type of data is frequently seen and analysed in data analytics applications.</p><p>In <strong>business</strong>, we observe</p><ul><li>weekly interest rates,</li><li>daily closing stock prices,</li><li>monthly price indices,</li><li>yearly sales figures, and so forth.</li></ul><p>In <strong>meteorology</strong>, we observe</p><ul><li>daily high and low temperatures,</li><li>annual precipitation and drought indices, and</li><li>hourly wind speeds.</li></ul><p>In <strong>agriculture</strong>, we record</p><ul><li>annual figures for crop and livestock production,</li><li>soil erosion, and export sales.</li></ul><p>In the <strong>biological</strong> sciences, we observe the electrical activity of the heart at millisecond intervals.</p><p>In <strong>ecology</strong>, we record the abundance of an animal species.</p><p>As a recent example from time series research, Miwa Fukino, Yoshito Hirata, and Kazuyuki Aihara from University of Tokyo proposed a new method based on nonlinear time series analysis analyse music’s emotional effect.</p><p>In this module,</p><p>we will start with examples of time series and visualise time series data with the most frequently used plots.
Introduce the model-building strategy that we will follow through the semester.
We will focus on the fundamental concepts in terms of
Time Series and Stochastic Processes,
Means, Variances, and Covariances, and Stationarity.</p><h2 id=examples-of-time-series>Examples of time series</h2><p>In this section, we will see some examples of time series and basic visualisations to make inferences about the basic characteristics of time series data. In all of the examples, we use the R package TSA. Therefore you need to install the TSA packages calling</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;TSA&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=annual-rainfall-in-los-angeles>Annual Rainfall in Los Angeles</h2><p>In this example, the data is composed of the annual rainfall amounts recorded in Los Angeles, California, over more than 100 years. The time series plot for this data is generated with the following code chunk. Here, the dataset larain contains the annual rainfall data. Please note that throughout the codes given in this module, you can also use win.graph() function to open a new graphics window with the settings determined by the arguments of this function.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>TSA</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># win.graph(width=4.875, height=2.5,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>larain</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>larain</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Inches&#39;</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Year&#39;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 1. Time series plot of LA rain series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>In Figure 1, we observe considerable variation in rainfall amount over the years from this time series plot. The year 1883 was an exceptionally wet year for Los Angeles, while 1983 was quite dry. For the analysis, we are interested in whether or not consecutive years are related in some way. If so, we might be able to use one year’s rainfall value to help forecast next year’s rainfall amount. The following code chunk generates a scatter plot to investigate the relationship between pairs of consecutive rainfall values:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>larain</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>zlag</span><span class=p>(</span><span class=n>larain</span><span class=p>),</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Inches&#39;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Previous Year Inches&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 2. Scatter plot of rainfall in consequtive years.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>The plots show no “trends” and no general tendencies. In Figure 2, the point plotted near the lower right-hand corner shows that the year of extremely high rainfall, 40 inches in 1883, was followed by an amount nearly 12 inches in 1884. The point near the top of the display shows that the 40-inch year was preceded by a much more typical year of about 15 inches. We observe from this plot that there is little information about this year’s rainfall amount from last year’s amount. The correlation between last year’s rainfall amount and this year’s amount which can be calculated by the following code chunk:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>larain</span>             <span class=c1># Read the annual rainfall data into y</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nf>zlag</span><span class=p>(</span><span class=n>larain</span><span class=p>)</span>       <span class=c1># Generate first lag of the annual rainfall series</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=m>2</span><span class=o>:</span><span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>    <span class=c1># Create an index to get rid of the first NA value in x</span>
</span></span><span class=line><span class=cl><span class=nf>cor</span><span class=p>(</span><span class=n>y[index]</span><span class=p>,</span><span class=n>x[index]</span><span class=p>)</span> <span class=c1># Calculate correlation between numerical values in x and y</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=an-industrial-chemical-process>An Industrial Chemical Process</h2><p>The second example is on a a time series from an industrial chemical process. A color property from consecutive batches in the process is measured here and named color in the package. We plot the time series with the following code chunk:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=4.875, height=2.5,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>color</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Color Property&#39;</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Batch&#39;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 3. Time series plot of the color property series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>From Figure 3, it seems that succeeding measurements are related to one another as the values that are neighbors in time tend to be similar in size. This is more clearly seen in the following scatter plot of neighboring pairs:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=3,height=3,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>color</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>zlag</span><span class=p>(</span><span class=n>color</span><span class=p>),</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Color Property&#39;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Previous Batch Color Property&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 4. Scatter plot of the color property in consequtive batches.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>In Figure 4, we see a slight upward trend, which is apparent but not terribly strong. The correlation in this scatter plot is about 0.6:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>color</span>              <span class=c1># Read the color data into y</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nf>zlag</span><span class=p>(</span><span class=n>color</span><span class=p>)</span>        <span class=c1># Generate first lag of the color series</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=m>2</span><span class=o>:</span><span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>    <span class=c1># Create an index to get rid of the first NA value in x</span>
</span></span><span class=line><span class=cl><span class=nf>cor</span><span class=p>(</span><span class=n>y[index]</span><span class=p>,</span><span class=n>x[index]</span><span class=p>)</span> <span class=c1># Calculate correlation between numerical values in x and y</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=annual-abundance-of-canadian-hare>Annual Abundance of Canadian Hare</h2><p>The third example concerns the annual abundance of Canadian hare. The data consists of their abundance over about 30 years. The following is the time series plot of annual abundance of Canadian hare for 30 years:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=4.875, height=2.5,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>hare</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>hare</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Abundance&#39;</span><span class=p>,</span><span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Year&#39;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 5. Time series plot of annual abundance of Canadian hare.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>In Figure 5, neighboring values here are very closely related. Large changes in abundance do not occur from one year to the next. The following plot shows the correlation between abundance versus the previous year’s abundance:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=3, height=3,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>hare</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>zlag</span><span class=p>(</span><span class=n>hare</span><span class=p>),</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Abundance&#39;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Previous Year Abundance&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 6. Scatter plot of abundance in consequtive years.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>In Figure 6, we see an upward trend in the plot-low values tend to be followed by low values in the next year, middle-sized values by middle-sized values, and high values by high values. The amount of correlation between neighboring abundance values is 0.70:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>hare</span>               <span class=c1># Read the abundance data into y</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nf>zlag</span><span class=p>(</span><span class=n>hare</span><span class=p>)</span>         <span class=c1># Generate first lag of the abundance series</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=m>2</span><span class=o>:</span><span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>    <span class=c1># Create an index to get rid of the first NA value in x</span>
</span></span><span class=line><span class=cl><span class=nf>cor</span><span class=p>(</span><span class=n>y[index]</span><span class=p>,</span><span class=n>x[index]</span><span class=p>)</span> <span class=c1># Calculate correlation between numerical values in x and y</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=monthly-average-temperatures-in-dubuque-iowa>Monthly Average Temperatures in Dubuque, Iowa</h2><p>The average monthly temperatures (in degrees Fahrenheit) over a number of years recorded in Dubuque, Iowa, are shown in the following plot:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=4.875, height=2.5,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>tempdub</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>tempdub</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Temperature&#39;</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 7. Time series plot of average monthly temperature series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Figure 7 displays seasonality. Seasonality for monthly values occurs when observations twelve months apart are related in some manner or another. All Januarys and Februarys are quite cold but they are similar in value and different from the temperatures of the warmer months of June, July, and August, for example. There is still variation among the January values and variation among the June values. Models for such series must accommodate this variation while preserving the similarities. Here the reason for the seasonality is well understood-the Northern Hemisphere’s changing inclination toward the sun.</p><p>The following shows the scatter plot of neighboring temperature measurements.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=3, height=3,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>tempdub</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>zlag</span><span class=p>(</span><span class=n>tempdub</span><span class=p>),</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Temperature&#39;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Previous Month Temperature&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 8. Scatter plot of average temperature in consequtive months.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>As expected, we observe a high correlation between temperatures of succeeding months from Figure 8. However, it is impossible to observe seasonality for this scatter plot.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>tempdub</span>               <span class=c1># Read the abundance data into y</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nf>zlag</span><span class=p>(</span><span class=n>tempdub</span><span class=p>)</span>         <span class=c1># Generate first lag of the abundance series</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=m>2</span><span class=o>:</span><span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>    <span class=c1># Create an index to get rid of the first NA value in x</span>
</span></span><span class=line><span class=cl><span class=nf>cor</span><span class=p>(</span><span class=n>y[index]</span><span class=p>,</span><span class=n>x[index]</span><span class=p>)</span> <span class=c1># Calculate correlation between numerical values in x and y</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=monthly-oil-filter-sales>Monthly Oil Filter Sales</h2><p>The last example is on the monthly sales to dealers of a specialty oil filter for construction equipment manufactured by John Deere. According to the authors of our textbook, when these data were first presented to one of the authors, the manager said, “There is no reason to believe that these sales are seasonal.” Seasonality would be present if January values tended to be related to other January values, February values tended to be related to other February values, and so forth. The time series plot in Figure 9 is not designed to display seasonality especially well.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=4.875, height=2.5,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Sales&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 9. Time series plot of monthly oil filter sales series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>To exhibit the seasonality, we can build a more informative plot labeling the months with the first letters of their names. In this version, all January values are plotted with the character J, all Februarys with F, all Marches with M, and so forth. With these plotting symbols, it is much easier to see that sales for the winter months of January and February all tend to be high, while sales in September, October, November, and December are generally quite low. The seasonality in the data is much easier to see from the modified time series plot in Figure 10.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;l&#39;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Sales&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 10. Time series plot of monthly oil filter sales series with labels.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>points</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>oilfilters</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>time</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>),</span> <span class=n>pch</span><span class=o>=</span><span class=nf>as.vector</span><span class=p>(</span><span class=nf>season</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><p>Here, the command <strong>time(oilfilters)</strong> puts continuous time points on each measurement such that</p><p>The command <strong>as.vector(season(oilfilters))</strong> creates a vector puts months on each measurement such that</p><p>Then, the <strong>points()</strong> function writes the first letter of each month over the time series plot generated by <strong>plot()</strong> function.</p><p>Figure 11 shows the scatter plot of neighboring monthly sales of oil filters.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=c1># win.graph(width=3, height=3,pointsize=8)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>oilfilters</span><span class=p>,</span><span class=n>x</span><span class=o>=</span><span class=nf>zlag</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>),</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Sales&#39;</span><span class=p>,</span> <span class=n>xlab</span><span class=o>=</span><span class=s>&#39;Previous Month Sales&#39;</span><span class=p>,</span><span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 11. Scatter plot of oil filter sales in consequtive months.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>And the amount of correlation between sales of succeeding months is</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>oilfilters</span>               <span class=c1># Read the abundance data into y</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=nf>zlag</span><span class=p>(</span><span class=n>oilfilters</span><span class=p>)</span>         <span class=c1># Generate first lag of the abundance series</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=m>2</span><span class=o>:</span><span class=nf>length</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>    <span class=c1># Create an index to get rid of the first NA value in x</span>
</span></span><span class=line><span class=cl><span class=nf>cor</span><span class=p>(</span><span class=n>y[index]</span><span class=p>,</span><span class=n>x[index]</span><span class=p>)</span> <span class=c1># Calculate correlation between numerical values in x and y</span>
</span></span></code></pre></td></tr></table></div></div><p>Although we observe a seasonal effect, autocorrelation between monthly sales is slightly correlated. So, we should note that having seasonality in time series data does not imply a significant correlation.</p><h2 id=a-model-building-strategy>A Model-Building Strategy</h2><p>It is not a straightforward task to find appropriate models for time series data. There are several components that a data scientist should deal with. Throughout the course we will follow a multistage model-building strategy with the following three steps:</p><ul><li>model specification, (or identification)</li><li>model fitting, and</li><li>model diagnostics.</li></ul><p>In model specification (or identification), the classes of time series models are selected that may be appropriate for a given observed series. In choosing a model, we shall attempt to adhere to the principle of parsimony; that is, the model used should require the smallest number of parameters that will adequately represent the time series.</p><p>Albert Einstein is quoted in Parzen (1982, p. 68) as remarking that “everything should be made as simple as possible but not simpler.”</p><p>The model fitting consists of finding the best possible estimates of a number of parameters involved in the model using a statistical estimation method such as least squares, maximum likelihood estimation, or Bayesian estimation.</p><p>Model diagnostics is concerned with assessing the quality of the model that we have specified and estimated. We try to answer the questions:</p><p>How well does the model fit the data?
Are the assumptions of the model reasonably well satisfied?
If no inadequacies are found, the modeling may be assumed to be complete, and the model may be used, for example, to forecast future values. Otherwise, we choose another model in the light of the inadequacies found; that is, we return to the model specification step. In this way, we cycle through the three steps until an acceptable model is found.</p><h2 id=time-series-and-stochastic-processes>Time Series and Stochastic Processes</h2><p>The sequence of random variables \({Yt:t=0,±1,±2,±3,…}\) is called a stochastic process and serves as a model for an observed time series. It is known that the complete probabilistic structure of such a process is determined by the set of distributions of all finite collections of the Y’s. Much of the information in these joint distributions can be described in terms of means, variances, and covariances. So, we will focus on the measures mostly based on the first and second moments.</p><h2 id=means-variances-and-covariances>Means, Variances, and Covariances</h2><p>For a stochastic process {&lt;t=0,±1,±2,±3>,…}, the mean function is defined by</p><p>μt=E(Yt), for t=0,±1,±2,±3,…</p><p>Actually, μt is just the expected value of the process at time t.</p><p>The autocovariance function, γt,s is defined as</p><p>γt,s=Cov(Yt,Ys), for t,s=0,±1,±2,±3,…</p><p>where Cov(Yt,Ys)=E[(Yt−μt)(Ys−μs)]=E(YtYs)−μtμs.</p><p>The autocorrelation function, ρt,s, is given by</p><p>ρt,s=Corr(Yt,Ys), for t,s=0,±1,±2,±3,…</p><p>where</p><p>Corr(Yt,Ys)=Cov(Yt,Ys)Var(Yt)Var(Ys)−−−−−−−−−−−−−√=γt,sγt,tγs,s−−−−−√.</p><p>Please note that</p><p>γt,t=Cov(Yt,Yt)=E[(Yt−μt)(Yt−μt)]=E[(Yt−μt)2]=E(Y2t)−μ2t=Var(Yt)</p><p>and</p><p>γs,s=Cov(Ys,Ys)=E[(Ys−μs)(Ys−μs)]=E[(Ys−μs)2]=E(Y2s)−μ2s=Var(Ys).</p><p>Consequently, ρt,t=ρs,s=1.</p><p>Because γt,s=γs,t, we have ρt,s=ρs,t. And because |γt,s|≤γt,tγs,s−−−−−√, we have |ρt,s|≤1.</p><p>Values of ρt,s near ±1 indicate strong (linear) dependence, whereas values near zero indicate weak (linear) dependence. If ρt,s=0, we say that Yt and Ys are uncorrelated.</p><p>Because most of the context is based on the covariance and correlations, we will go a little bit further. To investigate the covariance properties of various time series models, the following result will be used repeatedly: If c1,c2,…,cm and d1,d2,…,dn are constants and t1,t2,…,tm and s1,s2,…,sn are time points, then the contrivance of two linear combinations of time series observations is calculated by</p><p>Cov[∑i=1mciYti,∑j=1ndjYsj]=∑i=1m∑j=1ncidjCov(Yti,Ysj).</p><p>As a special case, we obtain the variance of a linear combination of time series observations as</p><p>Var[∑i=1mciYti]=∑i=1nc2iVar(Yti)+2∑i&lt;jcicjCov(Yti,Ytj).</p><h2 id=the-random-walk>The Random Walk</h2><p>Let e1,e2,… be a sequence of independent, identically distributed random variables each with zero mean and variance σ2e. The observed time series, {&lt;t=1,2>,…}, is constructed as follows:</p><p>Y1Y2Yt==⋮=e1e1+e2e1+e2+⋯+et</p><p>Apparently, this system of equations can be written as</p><p>Yt=Yt−1+et</p><p>with initial condition Y1=e1.</p><p>If the e’s are interpreted as the sizes of the “steps” taken (forward or backward) along a number line, then Yt is the position of the random walker at time t.</p><p>We obtain the mean and variance of the random walk process as follows:</p><p>μt=E(Yt)=E(e1+e2+⋯+et)=E(e1)+E(e2)+⋯+E(et)=0+0+⋯+0.</p><p>So, μt=0 for all t. As for the variance,</p><p>Var(Yt)=Var(e1+e2+⋯+et)=Var(e1)+Var(e2)+⋯+Var(et)=σ2e+σ2e+⋯+σ2e.</p><p>So we have a linearly increasing variance Var(Yt)=tσ2e with time.</p><p>For 1≤t≤s, we have the following autocorrelation function,</p><p>γt,s=tσ2e.</p><p>Autocorrelation function is straightforwardly obtained as follows:</p><p>ρt,s=ts−−√</p><p>for 1≤t≤s. For example, we have the following autocorrelation values ρ1,2=0.707, ρ8,9=0.943, ρ24,25=0.980, and ρ1,25=0.200. The neighboring time points are more correlated than those distant from each other.</p><p>Figure 12 shows a simulated random walk:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>data</span><span class=p>(</span><span class=n>rwalk</span><span class=p>)</span> <span class=c1># rwalk contains a simulated random walk</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=n>rwalk</span><span class=p>,</span><span class=n>type</span><span class=o>=</span><span class=s>&#39;o&#39;</span><span class=p>,</span><span class=n>ylab</span><span class=o>=</span><span class=s>&#39;Random Walk&#39;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 12. Time series plot of a simulated random walk.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=a-moving-average>A Moving Average</h2><p>Suppose that {Yt} is constructed as</p><p>Yt=et+et−12</p><p>where e’s are i.i.d. with zero mean and variance σ2e. Consequently, we have the following:</p><p>μt=0Var(Yt)=0.5σ2eCov(Yt,Yt−1)=0.25σ2e and Cov(Yt,Yt−k)=0 for k>1, and ρt,s=0.5 and ρt,t−k=0 for k>1.</p><p>Values of Y precisely one-time unit apart have exactly the same correlation no matter where they occur in time and, more generally, ρt,t−k is the same for all values of t. This leads us to the important concept of stationarity.</p><p>The following code chunk generates a random realisation of a moving average series in Figure 13.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>50</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>)</span> <span class=c1># Generate standard normal distributed e_t series</span>
</span></span><span class=line><span class=cl><span class=n>Y</span> <span class=o>=</span> <span class=nf>array</span><span class=p>(</span><span class=kc>NA</span><span class=p>,</span> <span class=m>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>for </span><span class=p>(</span> <span class=n>t</span> <span class=n>in</span> <span class=m>2</span><span class=o>:</span><span class=m>50</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=n>Y[t]</span> <span class=o>=</span> <span class=p>(</span><span class=n>e[t]</span> <span class=o>+</span> <span class=n>e[t</span><span class=m>-1</span><span class=n>]</span><span class=p>)</span><span class=o>/</span><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=nf>ts</span><span class=p>(</span><span class=n>Y</span><span class=p>),</span> <span class=n>type</span> <span class=o>=</span><span class=s>&#34;o&#34;</span><span class=p>,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;Y_t&#34;</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span><span class=s>&#34;t&#34;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 13. Time series plot of a moving average series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=stationarity>Stationarity</h2><p>The basic idea of stationarity is that the probability laws that govern the behavior of the process do not change over time. the assumption of stationarity allows us to make statistical inferences about the structure of a stochastic process on the basis of an observed record of that process. Specifically, a process {Yt} is said to be strictly stationary if the joint distribution of Yt1,Yt2,…,Ytn is the same as the joint distribution of Yt1−k,Yt2−k,…,Ytn−k for all choices of time points t1,t2,…,tn and all choices of time lag k.</p><p>It then follows that both the mean and variance functions are constant for all time: E(Yt)=E(Yt−k) and Var(Yt)=Var(Yt−k) for all t and k.</p><p>The covariance between Yt and Ys depends on time only through the time difference |t−s| and not otherwise on the actual times t and s.</p><p>Thus, for a stationary process, to simplify our notation, we can write</p><p>γk=Cov(Yt,Yt−k) and ρk=Corr(Yt,Yt−k)=γkγ0.</p><p>General properties of a stationary process are</p><p>γ0=Var(Yt)γk=γ−k|γk|≤γ0</p><p>and correspondingly,</p><p>ρ0=1ρk=ρ−k|ρk|≤1.</p><p>If a process is strictly stationary and has a finite variance, then the covariance function must depend only on the time lag. A definition that is similar to that of strict stationarity but is mathematically weaker is the following: A stochastic process {Yt} is said to be weakly (or second-order) stationary if</p><p>The mean function is constant over time, and
γt,t−k=γ0,k for all time t and lag k.
In this course, the term stationary when used alone will always refer to this weaker form of stationarity.</p><p>Figure 14 and 15 show a stationary and a nonstationary randomly generated series. Which one is for the non-stationary series?</p><h2 id=white-noise>White Noise</h2><p>One of the important and mostly used stationary processes is called white noise process. A white noise process is actually a sequence of i.i.d. random variables {et}. many useful processes can be constructed from white noise.</p><p>For a white noise process, μt=E(et) is constant and γk=Var(et) for k=0 and γk=0 for k≠0. Thus, we can write ρk=1 for k=0 and ρk=0 for k≠0. We usually assume that the white noise process has mean zero and denote Var(et) by σ2e.</p><p>The moving average also defines a stationary process. For a moving average process, Yt=(et+et−1)/2, we have ρk=1 for k=0, ρk=0.5 for |k|=1, and ρk=0 for |k|≥2.</p><p>Figure 16 shows an example of a white noise series:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>50</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=nf>ts</span><span class=p>(</span><span class=n>e</span><span class=p>),</span> <span class=n>type</span> <span class=o>=</span><span class=s>&#34;o&#34;</span><span class=p>,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;e_t&#34;</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span><span class=s>&#34;t&#34;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 16. Time series plot of a white noise series.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=random-cosine-wave>Random Cosine Wave</h2><p>Let us define the following process:</p><p>Yt=cos[2π(t12+Φ)] for t=0,±1,±2,…</p><p>where Φ∼Uniform(0,1). Figure 17 displays the time series plot of this process:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=n>phi</span> <span class=o>=</span> <span class=nf>runif</span><span class=p>(</span><span class=m>51</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span><span class=m>50</span><span class=p>,</span><span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Y</span> <span class=o>=</span> <span class=nf>cos</span><span class=p>(</span><span class=m>2</span><span class=o>*</span><span class=kc>pi</span><span class=o>*</span><span class=p>((</span><span class=n>t</span><span class=o>/</span><span class=m>12</span><span class=p>)</span><span class=o>+</span><span class=n>phi</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>plot</span><span class=p>(</span><span class=nf>ts</span><span class=p>(</span><span class=n>Y</span><span class=p>),</span> <span class=n>type</span> <span class=o>=</span><span class=s>&#34;o&#34;</span><span class=p>,</span> <span class=n>ylab</span><span class=o>=</span><span class=s>&#34;Y_t&#34;</span><span class=p>,</span> <span class=n>xlab</span> <span class=o>=</span><span class=s>&#34;t&#34;</span><span class=p>,</span> <span class=n>main</span> <span class=o>=</span> <span class=s>&#34;Figure 17. Time series plot of a random cosine wave.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Statistical properties of this process are</p><p>E(Yt)=∫10cos[2π(t12+ϕ)]f(ϕ)dϕ=∫10cos[2π(t12+ϕ)]⋅1dϕ=12πsin(2πt12+ϕ)∣∣∣10=12π[sin(2πt12+2π)−sin(2πt12)]=0</p><p>for all t. Also,</p><p>γt,s=12cos[2π(|t−s|12)].</p><p>So the process is stationary with the autocorrelation function</p><p>ρk=cos(2πk12) for t=0,±1,±2,…</p><p>With this example, we observe that it will be difficult to assess whether or not stationarity is a reasonable assumption for a given time series on the basis of the time sequence plot of the observed data.</p><p>As another example, the random walk constructed with Yt=e1+e2+⋯+et is not stationary due to non-constant variance function Var(Yt=tσ2e also its covariance function γt,s=tσ2e does not depend only on time lag for 0≤t&lt;s.</p><p>Instead of going on with Yt directly, we can consider the differences of successive Y-values, denoted ΔYt. Then $Y<sub>t</sub> = Y<sub>t</sub>-Y<sub>t−1</sub>=e<sub>t</sub>, so the differenced series, {ΔYt}, is stationary.</p><p>Many real time series cannot be reasonably modeled by stationary processes since they are not in statistical- equilibrium but are evolving over time. However, we can frequently transform non- stationary series into stationary series by simple techniques such as differencing.</p><h2 id=summary>Summary</h2><p>In this module, we introduced a special data type called time series data. We use simple visualisations to plot time series data for descriptive purposes. Then we focused on the fundamentals of time series analysis such as mean function, autocovariance function, and autocorrelation function. We illustrated these concepts with the basic processes: the random walk, white noise, a simple moving average, and a random cosine wave. Finally, the fundamental concept of stationarity is introduced and the idea of differentiating time series to ensure stationarity is highlighted.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-04-04</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=https://yanboyang.com/timeseriesanalysisweek1/index.md target=_blank rel="noopener noreferrer">Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts" data-hashtags=time,series,analysis><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-hashtag=time><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts"><i data-svg-src=https://yanboyang.com/lib/simple-icons/icons/line.min.svg></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts"><i class="fab fa-weibo fa-fw"></i></a><a href=javascript:void(0); title="Share on Myspace" data-sharer=myspace data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts" data-description><i data-svg-src=https://yanboyang.com/lib/simple-icons/icons/myspace.min.svg></i></a><a href=javascript:void(0); title="Share on Blogger" data-sharer=blogger data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts" data-description><i class="fab fa-blogger fa-fw"></i></a><a href=javascript:void(0); title="Share on Evernote" data-sharer=evernote data-url=https://yanboyang.com/timeseriesanalysisweek1/ data-title="Time Series Analysis Basic Plots, Examples, and Fundamental Concepts"><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=https://yanboyang.com/tags/time/>time</a>,&nbsp;<a href=https://yanboyang.com/tags/series/>series</a>,&nbsp;<a href=https://yanboyang.com/tags/analysis/>analysis</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=https://yanboyang.com/>Home</a></span></section></div><div class=post-nav><a href=https://yanboyang.com/revealslides/ class=prev rel=prev title="Making Slideshows From Emacs Org Mode with org-reveal"><i class="fas fa-angle-left fa-fw"></i>Making Slideshows From Emacs Org Mode with org-reveal</a>
<a href=https://yanboyang.com/analysisoftrends/ class=next rel=next title="Analysis of Trends">Analysis of Trends<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.96.0">Hugo</a> | Theme - <a href=https://github.com/sunt-programator/CodeIT target=_blank rel="noopener noreferrer" title="CodeIT 0.2.10"><i class="fas fa-laptop-code fa-fw"></i> CodeIT</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://yanboyang.com/ target=_blank rel="noopener noreferrer">Boyang Yan</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://yanboyang.com/lib/katex/katex.min.css><link rel=stylesheet href=https://yanboyang.com/lib/katex/copy-tex.min.css><link rel=stylesheet href=https://yanboyang.com/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=https://boyang-blog.disqus.com/embed.js defer></script><script type=text/javascript src=https://yanboyang.com/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/lunr/lunr.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/sharer/sharer.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/katex.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/auto-render.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/copy-tex.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/katex/mhchem.min.js></script><script type=text/javascript src=https://yanboyang.com/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:1e3},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=https://yanboyang.com/js/theme.min.js></script></body></html>